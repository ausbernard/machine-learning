Sentry&&Sentry.init({dsn:"https://b4bbe1a8fbce473cb9eb089652848a1e@sentry.io/202347",release:"179",ignoreErrors:["top.GLOBALS","originalCreateNotification","canvas.contentDocument","MyApp_RemoveAllHighlights","http://tt.epicplay.com","Can't find variable: ZiteReader","jigsaw is not defined","ComboSearch is not defined","http://loading.retry.widdit.com/","atomicFindClose","fb_xd_fragment","bmi_SafeAddOnload","EBCallBackMessageReceived","conduitPage","Cannot redefine property: googletag"],denyUrls:[/graph\.facebook\.com/i,/connect\.facebook\.net\/en_US\/all\.js/i,/eatdifferent\.com\.woopra-ns\.com/i,/static\.woopra\.com\/js\/woopra\.js/i,/extensions\//i,/^chrome:\/\//i,/^chrome-extension:\/\//i,/127\.0\.0\.1:4001\/isrunning/i,/webappstoolbarba\.texthelp\.com\//i,/metrics\.itunes\.apple\.com\.edgesuite\.net\//i]});var AUTH0_CLIENT_ID="UCFQIBMNFoUk5e19SDujYKTYC463r7rI",AUTH0_DOMAIN="ml-for-kids.auth0.com",AUTH0_CUSTOM_DOMAIN="login.machinelearningforkids.co.uk",AUTH0_CDN_BASE="https://cdn.auth0.com",AUTH0_CALLBACK_URL=window.location.href,AUTH0_AUDIENCE="https://machinelearningforkids.co.uk/users",REQUESTED_SCOPES="openid email write:training",AUTH0_WHITELISTED_DOMAINS=["https://mlforkids-newnumbers.j8ahcaxwtd1.au-syd.codeengine.appdomain.cloud","https://mlforkids-newnumbers.j8clybxvjr0.us-south.codeengine.appdomain.cloud","https://mlforkids-newnumbers.j8ayd8ayn23.eu-de.codeengine.appdomain.cloud"],Sentry=null;!function(){function e(e,t,n,r,a){e.authService=t,e.loggerService=a,t.setupAuth(),n.checkAuthOnRefresh(),n.redirectWhenUnauthenticated(),t.checkForAuthMessagesInUrl(),r.init()}angular.module("app").run(e),e.$inject=["$rootScope","authService","authManager","sitealertsService","loggerService"]}(),function(){function e(e,t,n,r){var a=this;(a.authService=e).getProfileDeferred().then(function(e){a.profile=e,n.expiry=1,n.url="https://cloud.ibm.com/status?query=EVENTID&selected=status"}).catch(r.error),a.confirm=function(e){e.expiry=36e5*parseFloat(e.expiry),t.createAlert(e).then(function(){alert("done")}).catch(r.error)},a.refresh=function(){t.refreshServer().catch(r.error)}}angular.module("app").controller("AdminController",e),e.$inject=["authService","sitealertsService","$scope","loggerService"]}(),function(){function e(e,t,n,r,a,o){var i=this;i.authService=e,o.projectId=a.projectId,o.userId=a.userId,o.projecturls={appinventor:"http://ai2.appinventor.mit.edu/",train:"/#!/mlproject/"+a.userId+"/"+a.projectId+"/training",learnandtest:"/#!/mlproject/"+a.userId+"/"+a.projectId+"/models"},r.debug("[ml4kappinv] Generated App Inventor urls",o.projecturls),e.getProfileDeferred().then(function(e){return i.profile=e,r.debug("[ml4kappinv] Getting project info"),t.getProject(o.projectId,o.userId,e.tenant)}).then(function(e){if(r.debug("[ml4kappinv] project",e),o.project=e,"local"===o.project.storage)o.appInventorError="App Inventor cannot be used with projects stored in your web browser";else{if("numbers"!==o.project.type&&"sounds"!==o.project.type)return o.validProjectType=!0,o.projecturls.train="/#!/mlproject/"+o.project.userid+"/"+o.project.id+"/training",o.projecturls.learnandtest="/#!/mlproject/"+o.project.userid+"/"+o.project.id+"/models",r.debug("[ml4kappinv] Getting Scratch API keys"),n.getScratchKeys(e,a.userId,i.profile.tenant);o.appInventorError="App Inventor cannot be used with "+o.project.type+" projects"}}).then(function(e){r.debug("[ml4kappinv] scratchkey",e),e&&(o.scratchkey=e[0],o.appinventorurl=window.location.origin+"/api/appinventor/"+o.scratchkey.id+"/extension")}).catch(function(e){o.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("AppInventorController",e),e.$inject=["authService","projectsService","scratchkeysService","loggerService","$stateParams","$scope"]}(),function(){angular.module("app").service("authService",t);var e=["authManager","loggerService","storageService","browserStorageService","$q","$http","$mdDialog","$rootScope","$window","$state","$timeout"];function t(r,i,a,t,e,n,o,s,c,l,u,d){var S="session-users",E=6e5,g=this,T=null,p=(s.isTeacher=!1,s.isAuthenticated=!1,i.debug("[ml4kauth] init"),a.confirmLocalStorage(),a.getItem("profile")),m=null,f=(p&&(m=JSON.parse(p)),e.defer());function O(e){i.debug("[ml4kauth] Scheduling token renewal"),T=setTimeout(R,e)}function R(){i.debug("[ml4kauth] Renewing login"),d?d.checkSession({},function(e,t){e?i.error("[ml4kauth] Failed to renew login",e):t&&(i.debug("[ml4kauth] Renewed login",t),I(t),0<(e=1e3*t.expiresIn-E))&&O(e)}):i.error("[ml4kauth] Unexpected call to renewLogin")}function h(){i.debug("[ml4kauth] Clearing auth data"),T&&(i.debug("[ml4kauth] Clearing token renewal timer"),clearTimeout(T),T=null),f=e.defer(),i.debug("[ml4kauth] Clearing stored token"),a.removeItem("access_token"),a.removeItem("id_token"),a.removeItem("expires_at"),a.removeItem("scopes"),a.removeItem("profile"),r.unauthenticate(),m=null,s.isTeacher=!1,s.isAuthenticated=!1,s.$broadcast("authStateChange","cleared auth data")}function A(){var e;i.debug("[ml4kauth] logout"),m&&m.tenant===S&&r.isAuthenticated()?(i.debug("[ml4kauth] Logging out session user"),e=m.user_id,i.debug("[ml4kauth] Deleting session user"),n.delete("/api/classes/"+S+"/sessionusers/"+e).catch(function(e){i.error("[ml4kauth] Failed to delete session user",e)}).then(function(){i.debug("[ml4kauth] Deleted session user"),h(),a.clear(),t.deleteSessionUserProjects()}).catch(function(e){i.error("[ml4kauth] Failed to delete session user",e)})):h()}function I(e){i.debug("[ml4kauth] Storing token");var t=JSON.stringify(1e3*e.expiresIn+(new Date).getTime()),n=e.scope||REQUESTED_SCOPES||"";a.setItem("access_token",e.accessToken),a.setItem("id_token",e.idToken),a.setItem("expires_at",t),a.setItem("scopes",JSON.stringify(n)),r.authenticate()}function H(e){i.debug("[ml4kauth] Storing profile"),a.setItem("profile",JSON.stringify(e)),f.resolve(e),s.isTeacher="supervisor"===e.role,s.isAuthenticated=!0}function N(){i.debug("[ml4kauth] Session has expired"),h();var e=o.alert().title("Session expired").textContent("Please log in again.").ok("OK");o.show(e).finally(function(){l.go("login")})}function y(){var e,t=!1;return m&&(e=JSON.parse(a.getItem("expires_at")),t=(new Date).getTime()>e),i.debug("[ml4kauth] hasSessionExpired : "+t),t}return m&&(i.debug("[ml4kauth] Existing user profile restored"),y()?(i.debug("[ml4kauth] Session expired"),A()):(i.debug("[ml4kauth] Setting restored profile to use"),f.resolve(m),s.isTeacher="supervisor"===m.role,s.isAuthenticated=!0,Sentry&&Sentry.configureScope(function(e){e.setUser({email:m.email,username:m.user_id}),e.setExtra("role",m.role),e.setExtra("tenant",m.tenant)}),m.tenant!==S&&(0<(p=JSON.parse(a.getItem("expires_at"))-E-(new Date).getTime())?(i.debug("[ml4kauth] Token valid for longer than 10 minutes"),O(p)):(i.debug("[ml4kauth] Token due to renew within 10 minutes"),R())))),{login:function(){i.debug("[ml4kauth] login"),d?d.show({languageDictionary:{title:"Log in to ML for Kids"}}):i.error("[ml4kauth] Unexpected call to login")},reset:function(){i.debug("[ml4kauth] reset"),d?d.show({languageDictionary:{title:"Forgot your password?"},allowForgotPassword:!0,allowLogin:!1,initialScreen:"forgotPassword"}):i.error("Unexpected call to reset")},logout:A,setupAuth:function(){i.debug("[ml4kauth] Setting up auth"),d&&(i.debug("[ml4kauth] Registering url interceptor"),d.interceptHash(),d.on("authenticated",function(o){i.debug("[ml4kauth] Authenticated"),o&&o.accessToken&&o.idToken?(i.debug("[ml4kauth] Received expected auth tokens"),I(o),i.debug("[ml4kauth] Retrieving user info"),d.getUserInfo(o.accessToken,function(e,t){if(e)return i.error("[ml4kauth] lock auth failure",e),A();var n,r,a;i.debug("[ml4kauth] Processing retrieved profile"),g.profile=(e=t,i.debug("[ml4kauth] Extracting app metadata from profile data"),t=e["https://machinelearningforkids.co.uk/api/tenant"],n=e["https://machinelearningforkids.co.uk/api/role"],r=e["https://machinelearningforkids.co.uk/api/groups"],a=e.sub,e.tenant=t,e.role=n,e.groups=r,e.user_id=a,delete e["https://machinelearningforkids.co.uk/api/tenant"],delete e["https://machinelearningforkids.co.uk/api/role"],delete e["https://machinelearningforkids.co.uk/api/groups"],delete e.sub,delete e.picture,e),H(g.profile),O(1e3*o.expiresIn-E),i.debug("[ml4kauth] Redirecting to home page"),u(function(){l.go("welcome"),s.$broadcast("authStateChange","authentication complete")})})):(i.error("[ml4kauth] Authenticated without expected tokens"),i.error(o))}),d.on("authorization_error",function(e){i.warn("[ml4kauth] Authorization error",e),e&&e.errorDescription&&"Please verify your email to activate your class account"===e.errorDescription&&alert("Please verify your email to activate your class account\n\nWhen you created your account, you should have been sent an email to verify your address. \nClicking on the link in that email will activate your class account.\n\nPlease click on the Help tab for more info"),s.$broadcast("authStateChange","authorization error")}),d.on("unrecoverable_error",function(e){return i.error("[ml4kauth] Unrecoverable auth error",e),A(),c.location.reload(!0)})),s.$on("tokenHasExpired",N)},getProfileDeferred:function(){return f.promise},isAuthenticated:function(){var e;return i.debug("[ml4kauth] isAuthenticated"),!!m&&((e=y())&&A(),!e)},handleUnauthenticated:function(){i.debug("[ml4kauth] Unauthenticated event"),y()?(i.debug("[ml4kauth] Unauthenticated because session has expired"),N()):(i.debug("[ml4kauth] Unexpected unauth event"),h(),l.go("login"))},createSessionUser:function(){return i.debug("[ml4kauth] Creating session user"),n.post("/api/sessionusers").then(function(e){i.debug("[ml4kauth] Session user created");var t,n,e=e.data;return t=e,i.debug("[ml4kauth] Switching to session user"),A(),i.debug("[ml4kauth] Storing profile data"),a.setItem("access_token",t.token),a.setItem("id_token",t.jwt),n=JSON.stringify(new Date(t.sessionExpiry).getTime()),a.setItem("expires_at",n),a.setItem("scopes","openid email"),m={tenant:S,role:"student",user_id:t.id},a.setItem("profile",JSON.stringify(m)),f.resolve(m),s.isAuthenticated=!0,s.isTeacher=!1,s.$broadcast("authStateChange","switched to session user"),e})},checkForAuthMessagesInUrl:function(){var t,e=c.location.search;e&&"?"===e[0]&&(e=e.substr(1),t={},e.split("&").forEach(function(e){e=e.split("=");t[e[0]]=e[1]}),"Your%20email%20was%20verified.%20You%20can%20continue%20using%20the%20application."===t.message)&&(e=o.alert().title("Welcome to Machine Learning for Kids").textContent("Your email address has been verified.").ok("OK"),o.show(e).finally(function(){c.location="/"}))},storeProfile:H}}AUTH0_CLIENT_ID&&e.push("lock"),t.$inject=e}(),function(){function e(i,a,t,n){let r=0,o;const s="mlforkidsLocalProjects",c="projects",u={},l="mlforkidsProject",d="training";let S;const E="mlforkidsAssets",g="assets",T=(i.debug("[ml4kstorage] verifying browser storage"),"mlforkids-check-"+Date.now());try{window.indexedDB.open(T,1).onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("mlforkids",{autoIncrement:!0}).put(new Blob),r=1,i.debug("[ml4kstorage] browser storage verified")}catch(e){i.error("[ml4kstorage] IndexedDB not supported",e),r=-1}finally{try{e&&e.close(),window.indexedDB.deleteDatabase(T)}catch(e){i.error("[ml4kstorage] failed to clean up storage verification assets",e)}}}}catch(e){i.error("[ml4kstorage] unable to verify browser storage",e),r=-1}function e(){return 0===r?new Promise(e=>{t(()=>{e(r)},500)}):Promise.resolve(r)}function p(n){return new Promise(function(e,t){n.onsuccess=e,n.onerror=t})}function m(n){return new Promise(function(e,t){n.oncomplete=e,n.onerror=t})}function f(e){i.debug("[ml4kstorage] initProjectsDatabase"),e.target.result.createObjectStore(c,{keyPath:"id",autoIncrement:!0}).createIndex("classid","classid",{unique:!1})}function O(e){i.debug("[ml4kstorage] initTrainingDatabase"),e.target.result.createObjectStore(d,{keyPath:"id",autoIncrement:!0}).createIndex("label","label",{unique:!1})}function R(e){i.debug("[ml4kstorage] initAssetsDatabase"),e.target.result.createObjectStore(g)}async function h(){var e;o||((o=(i.debug("[ml4kstorage] getProjectsDatabase"),(e=window.indexedDB.open(s)).onupgradeneeded=f,await p(e).then(function(e){return e.target.result}))).onclose=()=>{i.debug("[ml4kstorage] projects database closed"),o=null})}async function A(e){var t;u[e]||(u[e]=(t=e,i.debug("[ml4kstorage] getTrainingDatabase"),(t=window.indexedDB.open(l+t)).onupgradeneeded=O,await p(t).then(function(e){return e.target.result})),u[e].onclose=()=>{i.debug("[ml4kstorage] training database closed",e),delete u[e]})}async function I(){var e;S||((S=(i.debug("[ml4kstorage] getAssetsDatabase"),(e=window.indexedDB.open(E)).onupgradeneeded=R,await p(e).then(function(e){return e.target.result}))).onclose=()=>{i.debug("[ml4kstorage] assets database closed"),S=null})}function H(e){if(e&&e.target&&e.target.result)return e.target.result;e=new Error("not found");throw e.status=404,e.data={error:"not found"},e}function N(e){return parseInt(e,10)}async function y(e){return i.debug("[ml4kstorage] getProject",e),await h(),p(o.transaction([c],"readonly").objectStore(c).get(N(e))).then(H)}async function v(e,t,n){i.debug("[ml4kstorage] addMetadataToProject",arguments),await h();var r=o.transaction([c],"readwrite").objectStore(c),a=H(await p(r.get(N(e)))),r=(a[t]=n,r.put(a));return await p(r),a}const b=/[^\w.]/g;function L(e){return e.replace(b,"_").substring(0,30)}async function U(e,t){i.debug("[ml4kstorage] addLabel"),await h();let n=t;try{n=L(t)}catch(e){i.error("[ml4kstorage] Failed to sanitize label, leaving as-is")}t=o.transaction([c],"readwrite").objectStore(c),e=H(await p(t.get(N(e))));return e.labels.includes(n)||(e.labels.push(n),await p(t.put(e))),e.labels}async function D(e){return i.debug("[ml4kstorage] getTrainingData",e),await A(e),p(u[e].transaction([d],"readonly").objectStore(d).getAll()).then(function(e){return e.target.result})}return{isSupported:e,idIsLocal:function(e){return parseInt(e,10).toString()===e.toString()},sanitizeLabel:L,getProjects:async function(t){if(i.debug("[ml4kstorage] getProjects"),-1===e)return Promise.resolve([]);try{await h()}catch(e){return i.error("[ml4kstorage] unable to get projects database.",e),[]}return p(o.transaction([c],"readonly").objectStore(c).getAll()).then(function(e){return e.target.result.filter(function(e){return e.userid===t})}).catch(function(e){return i.error("[ml4kstorage] unable to get local projects info.",e),[]})},getProject:y,addProject:async function(t){return i.debug("[ml4kstorage] addProject",t),await h(),t.labels||(t.labels=[]),"sounds"===t.type&&t.labels.push("_background_noise_"),p(o.transaction([c],"readwrite").objectStore(c).add(t)).then(function(e){return t.id=e.target.result,t})},addCloudRefToProject:function(e,t){return v(e,"cloudid",t)},addMetadataToProject:v,deleteProject:async function(e){i.debug("[ml4kstorage] deleteProject"),await h();var t=o.transaction([c],"readwrite");return t.objectStore(c).delete(N(e)),window.indexedDB.deleteDatabase(l+e),delete u[e],m(t)},addLabel:U,deleteLabel:async function(e,t){i.debug("[ml4kstorage] deleteLabel"),await h(),await A(e);var n=o.transaction([c],"readwrite").objectStore(c),r=H(await p(n.get(N(e))));r.labels=r.labels.filter(function(e){return e!==t}),await p(n=n.put(r));const a=u[e].transaction([d],"readwrite").objectStore(d);return a.index("label").openCursor(IDBKeyRange.only(t)).onsuccess=function(e){e=e.target.result;e&&(a.delete(e.primaryKey),e.continue())},r.labels},getTrainingData:D,countTrainingData:async function(e){return i.debug("[ml4kstorage] countTrainingData",e),await A(e),p(u[e].transaction([d],"readonly").objectStore(d).count()).then(function(e){return e.target.result})},getTrainingDataItem:async function(e,t){return i.debug("[ml4kstorage] getTrainingDataItem"),await A(e),p(u[e].transaction([d],"readonly").objectStore(d).get(N(t))).then(H)},addTrainingData:async function(t,n){return i.debug("[ml4kstorage] addTrainingData"),await A(t),p(u[t].transaction([d],"readwrite").objectStore(d).add(n)).then(function(e){return n.id=e.target.result,n.label&&U(t,n.label),n})},bulkAddTrainingData:async function(e,c){i.debug("[ml4kstorage] bulkAddTrainingData"),await A(e);const l=u[e].transaction([d],"readwrite").objectStore(d);return new Promise(function(t,n){const r=c.length;var a,o=0;for(let e=0;e<r;e++){const s=c[e];var i=l.add(s);i.onsuccess=function(e){if(o+=1,s.id=e.target.result,o===r)return a?n(a):t(c)},i.onerror=function(e){if(a=e,(o+=1)===r)return n(a)}}})},deleteTrainingData:async function(e,t){return i.debug("[ml4kstorage] deleteTrainingData"),await A(e),(e=u[e].transaction([d],"readwrite")).objectStore(d).delete(N(t)),m(e)},clearTrainingData:async function(e){return i.debug("[ml4kstorage] clearTrainingData"),await A(e),(e=u[e].transaction([d],"readwrite")).objectStore(d).clear(),m(e)},getLabelCounts:async function(e){return i.debug("[ml4kstorage] getLabelCounts",e),Promise.all([y(e),D(e)]).then(function(e){var t={};for(const n of e[0].labels)t[n]=0;for(const r of e[1])r.label in t&&(t[r.label]+=1);return t})},getTrainingForWatsonAssistant:async function(e){i.debug("[ml4kstorage] getTrainingForWatsonAssistant");var t={},n={};for(const o of await D(e.id)){var r=o.label,a=o.textdata.substring(0,1024);r in t||(t[r]={intent:r.replace(/\s/g,"_"),examples:[]}),r in n||(n[r]=[]),n[r].includes(a)||(t[r].examples.push({text:a}),n[r].push(a))}return{name:e.name,language:e.language||"en",intents:Object.values(t),dialog_nodes:[],counterexamples:[],entities:[],metadata:{createdby:"machinelearningforkids"}}},deleteSessionUserProjects:async function(){i.debug("[ml4kstorage] deleteSessionUserProjects");try{await h()}catch(e){return void i.error("[ml4kstorage] unable to get projects database. exiting.",e)}return new Promise(function(t,n){try{const r=o.transaction([c],"readwrite").objectStore(c);var e=r.index("classid").openCursor(IDBKeyRange.only("session-users"));e.onsuccess=function(e){e=e.target.result;e?(a.deleteProject(e.value),delete u[e.value.id],window.indexedDB.deleteDatabase(l+e.value.id),r.delete(e.primaryKey),e.continue()):t()},e.onerror=function(e){i.error("[ml4kstorage] failed to get cursor.",e),n(e)}}catch(e){i.error("[ml4kstorage] failed to run session user cleanup.",e),n(e)}})},storeAsset:async function(e,t){return i.debug("[ml4kstorage] storeAsset",e),await I(),t=(await n.get(t,{responseType:"blob"})).data,p(S.transaction([g],"readwrite").objectStore(g).put(t,e))},retrieveAsset:async function(e){return i.debug("[ml4kstorage] retrieveAsset",e),await I(),p(S.transaction([g],"readonly").objectStore(g).get(e)).then(H)},deleteAsset:async function(e){i.debug("[ml4kstorage] deleteAsset",e),await I();var t=S.transaction([g],"readwrite");return t.objectStore(g).delete(e),m(t)}}}angular.module("app").service("browserStorageService",e),e.$inject=["loggerService","cleanupService","$timeout","$http"]}(),function(){function e(e,t,n,r,a,o,i,s){var c=this;c.authService=e,s.projectId=i.projectId,s.userId=i.userId,s.loading=!0,s.modelSource=!1,s.expiredModel=!1,s.testdata={fields:[],label:"label"},s.trainingdata={fields:[],label:"label"};let l;e.getProfileDeferred().then(e=>(c.profile=e,t.getProject(s.projectId,s.userId,e.tenant))).then(e=>{if(e&&"numbers"!==e.type)throw new Error("This page is intended for numbers projects only");return(s.project=e).labels&&0<e.labels.length&&(s.testdata.label=e.labels[0],s.trainingdata.label=e.labels[0]),t.getFields(s.project,s.userId,c.profile.tenant)}).then(function(e){return s.fields=e,e=s.project,(l=n.getItem("ml4k-models-numbers-"+e.id+"-status"))?o.get(l).then(function(e){e&&e.data&&(s.modelSource=e.data.urls.status)}).catch(function(e){a.error("[ml4kpy] failed to get model info",e),e&&404===e.status&&e.config.url===l&&(s.expiredModel=!0)}):Promise.resolve()}).then(()=>{return"local"!==(e=s.project).storage?r.getScratchKeys(e,s.userId,c.profile.tenant).then(function(e){s.scratchkey=e[0].id}).catch(function(e){a.error("[ml4kpy] failed to get scratch key",e)}):Promise.resolve();var e}).then(()=>{s.loading=!1}).catch(e=>{s.failure={message:e.message||e.error||"Unknown error",status:e.status},s.loading=!1})}angular.module("app").controller("ColabController",e),e.$inject=["authService","projectsService","storageService","scratchkeysService","loggerService","$http","$stateParams","$scope"]}(),function(){function e(e,r,a,o,i,n,s,t,c,l){var u=this,d=(u.authService=e,u.creating=!1,u.loading=!0,1);function S(e,t,n){u[e].push({alertid:d++,message:(n=n||{}).message||n.error||"Unknown error",status:t})}u.errors=[],u.warnings=[],u.dismissAlert=function(e,t){u[e].splice(t,1)},u.datasets=[],e.getProfileDeferred().then(function(e){u.profile=e,t(["DATASETS.DATA.TITANIC.TITLE","DATASETS.DATA.TITANIC.SUMMARY","DATASETS.DATA.TITANIC.DESCRIPTION","DATASETS.DATA.TITANIC.DETAILS","DATASETS.DATA.UKNEWSPAPERS.TITLE","DATASETS.DATA.UKNEWSPAPERS.SUMMARY","DATASETS.DATA.UKNEWSPAPERS.DESCRIPTION","DATASETS.DATA.UKNEWSPAPERS.DETAILS","DATASETS.DATA.CATSANDDOGS.TITLE","DATASETS.DATA.CATSANDDOGS.SUMMARY","DATASETS.DATA.CATSANDDOGS.DESCRIPTION","DATASETS.DATA.CATSANDDOGS.DETAILS","DATASETS.DATA.ORGANICWASTE.TITLE","DATASETS.DATA.ORGANICWASTE.SUMMARY","DATASETS.DATA.ORGANICWASTE.DESCRIPTION","DATASETS.DATA.ORGANICWASTE.DETAILS","DATASETS.DATA.PHISHING.TITLE","DATASETS.DATA.PHISHING.SUMMARY","DATASETS.DATA.PHISHING.DESCRIPTION","DATASETS.DATA.PHISHING.DETAILS","WORKSHEETS.NOUGHTSANDCROSSES.TITLE","DATASETS.DATA.NOUGHTSANDCROSSES.SUMMARY","DATASETS.DATA.NOUGHTSANDCROSSES.DESCRIPTION","DATASETS.DATA.NOUGHTSANDCROSSES.DETAILS","DATASETS.DATA.TOPTRUMPS.TITLE","DATASETS.DATA.TOPTRUMPS.SUMMARY","DATASETS.DATA.TOPTRUMPS.DESCRIPTION","DATASETS.DATA.TOPTRUMPS.DETAILS","DATASETS.DATA.SONGLYRICS.TITLE","DATASETS.DATA.SONGLYRICS.SUMMARY","DATASETS.DATA.SONGLYRICS.DESCRIPTION","DATASETS.DATA.SONGLYRICS.DETAILS","DATASETS.DATA.HANDGESTURES.TITLE","DATASETS.DATA.HANDGESTURES.SUMMARY","DATASETS.DATA.HANDGESTURES.DESCRIPTION","DATASETS.DATA.HANDGESTURES.DETAILS","DATASETS.DATA.POKEMONSTATS.TITLE","DATASETS.DATA.POKEMONSTATS.SUMMARY","DATASETS.DATA.POKEMONSTATS.DESCRIPTION","DATASETS.DATA.POKEMONSTATS.DETAILS","DATASETS.DATA.POKEMONIMAGES.TITLE","DATASETS.DATA.POKEMONIMAGES.SUMMARY","DATASETS.DATA.POKEMONIMAGES.DESCRIPTION","DATASETS.DATA.POKEMONIMAGES.DETAILS","DATASETS.DATA.ARGO.TITLE","DATASETS.DATA.ARGO.SUMMARY","DATASETS.DATA.ARGO.DESCRIPTION","DATASETS.DATA.ARGO.DETAILS","DATASETS.DATA.STARS.TITLE","DATASETS.DATA.STARS.SUMMARY","DATASETS.DATA.STARS.DESCRIPTION","DATASETS.DATA.STARS.DETAILS","DATASETS.DATA.FAKENEWS.ID","DATASETS.DATA.FAKENEWS.TITLE","DATASETS.DATA.FAKENEWS.SUMMARY","DATASETS.DATA.FAKENEWS.DESCRIPTION","DATASETS.DATA.FAKENEWS.DETAILS"]).then(function(e){u.datasets=[{id:"titanic",title:e["DATASETS.DATA.TITANIC.TITLE"],summary:e["DATASETS.DATA.TITANIC.SUMMARY"],description:e["DATASETS.DATA.TITANIC.DESCRIPTION"],details:e["DATASETS.DATA.TITANIC.DETAILS"],type:"numbers",image:"static/images/dataset-titanic.png"},{id:"uk-newspaper-headlines",title:e["DATASETS.DATA.UKNEWSPAPERS.TITLE"],summary:e["DATASETS.DATA.UKNEWSPAPERS.SUMMARY"],description:e["DATASETS.DATA.UKNEWSPAPERS.DESCRIPTION"],details:e["DATASETS.DATA.UKNEWSPAPERS.DETAILS"],type:"text",image:"static/images/dataset-ukheadlines.png"},{id:"cats-and-dogs",title:e["DATASETS.DATA.CATSANDDOGS.TITLE"],summary:e["DATASETS.DATA.CATSANDDOGS.SUMMARY"],description:e["DATASETS.DATA.CATSANDDOGS.DESCRIPTION"],details:e["DATASETS.DATA.CATSANDDOGS.DETAILS"],type:"imgtfjs",image:"static/images/dataset-catsanddogs.png"},{id:"organic-waste",title:e["DATASETS.DATA.ORGANICWASTE.TITLE"],summary:e["DATASETS.DATA.ORGANICWASTE.SUMMARY"],description:e["DATASETS.DATA.ORGANICWASTE.DESCRIPTION"],details:e["DATASETS.DATA.ORGANICWASTE.DETAILS"],type:"imgtfjs",image:"static/images/dataset-organicwaste.png"},{id:"phishing",title:e["DATASETS.DATA.PHISHING.TITLE"],summary:e["DATASETS.DATA.PHISHING.SUMMARY"],description:e["DATASETS.DATA.PHISHING.DESCRIPTION"],details:e["DATASETS.DATA.PHISHING.DETAILS"],type:"numbers",image:"static/images/dataset-phishing.png"},{id:"noughts-and-crosses",title:e["WORKSHEETS.NOUGHTSANDCROSSES.TITLE"],summary:e["DATASETS.DATA.NOUGHTSANDCROSSES.SUMMARY"],description:e["DATASETS.DATA.NOUGHTSANDCROSSES.DESCRIPTION"],details:e["DATASETS.DATA.NOUGHTSANDCROSSES.DETAILS"],type:"numbers",image:"static/images/dataset-noughtsandcrosses.png",template:!0},{id:"top-trumps",title:e["DATASETS.DATA.TOPTRUMPS.TITLE"],summary:e["DATASETS.DATA.TOPTRUMPS.SUMMARY"],description:e["DATASETS.DATA.TOPTRUMPS.DESCRIPTION"],details:e["DATASETS.DATA.TOPTRUMPS.DETAILS"],type:"numbers",image:"static/images/dataset-toptrumps.png",template:!0},{id:"song-lyrics",title:e["DATASETS.DATA.SONGLYRICS.TITLE"],summary:e["DATASETS.DATA.SONGLYRICS.SUMMARY"],description:e["DATASETS.DATA.SONGLYRICS.DESCRIPTION"],details:e["DATASETS.DATA.SONGLYRICS.DETAILS"],type:"text",image:"static/images/dataset-songlyrics.png"},{id:"pokemon-stats",title:e["DATASETS.DATA.POKEMONSTATS.TITLE"],summary:e["DATASETS.DATA.POKEMONSTATS.SUMMARY"],description:e["DATASETS.DATA.POKEMONSTATS.DESCRIPTION"],details:e["DATASETS.DATA.POKEMONSTATS.DETAILS"],type:"numbers",image:"static/images/dataset-pokemonstats.png"},{id:"pokemon",title:e["DATASETS.DATA.POKEMONIMAGES.TITLE"],summary:e["DATASETS.DATA.POKEMONIMAGES.SUMMARY"],description:e["DATASETS.DATA.POKEMONIMAGES.DESCRIPTION"],details:e["DATASETS.DATA.POKEMONIMAGES.DETAILS"],type:"imgtfjs",image:"static/images/dataset-pokemonimages.png"},{id:"hand-gestures",title:e["DATASETS.DATA.HANDGESTURES.TITLE"],summary:e["DATASETS.DATA.HANDGESTURES.SUMMARY"],description:e["DATASETS.DATA.HANDGESTURES.DESCRIPTION"],details:e["DATASETS.DATA.HANDGESTURES.DETAILS"],type:"numbers",image:"static/images/dataset-handgestures.png",template:!0},{id:"argo",title:e["DATASETS.DATA.ARGO.TITLE"],summary:e["DATASETS.DATA.ARGO.SUMMARY"],description:e["DATASETS.DATA.ARGO.DESCRIPTION"],details:e["DATASETS.DATA.ARGO.DETAILS"],type:"numbers",image:"static/images/dataset-argo.png"},{id:"stars",title:e["DATASETS.DATA.STARS.TITLE"],summary:e["DATASETS.DATA.STARS.SUMMARY"],description:e["DATASETS.DATA.STARS.DESCRIPTION"],details:e["DATASETS.DATA.STARS.DETAILS"],type:"numbers",image:"static/images/dataset-stars.png"},{id:e["DATASETS.DATA.FAKENEWS.ID"],title:e["DATASETS.DATA.FAKENEWS.TITLE"],summary:e["DATASETS.DATA.FAKENEWS.SUMMARY"],description:e["DATASETS.DATA.FAKENEWS.DESCRIPTION"],details:e["DATASETS.DATA.FAKENEWS.DETAILS"],type:"text",image:"static/images/dataset-fakenews-upd.png"}],u.loading=!1})}).catch(function(e){S("errors",e.status,e.data)}),u.displayDataset=function(e,t){o.debug("[ml4kds] Displaying dataset",t),u.creating||c.show({locals:{dataset:t,testratio:0},controller:["$scope","locals",function(t,e){t.dataset=e.dataset,t.testratio=e.testratio,t.hide=function(){c.hide()},t.confirm=function(e){t.dataset.storage=e,t.dataset.testratio=t.testratio,c.hide(t.dataset)},t.cancel=function(){c.cancel()}}],templateUrl:"static/components/datasets/dataset.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){u.importProject(e)},function(){o.debug("[ml4kds] Import cancelled")})},u.importProject=function(e){if(o.debug("[ml4kds] Importing dataset",e),!u.creating){u.creating=!0;var t={type:e.type,dataset:e.id,testratio:e.testratio,storage:e.storage,name:e.title};if("local"===e.storage){u.loading=!0;let n=[],e;a.getDataset(t.type,t.dataset).then(e=>(n=e.trainingdata,t.language=e.language,t.labels=e.labels,t.fields=e.fields,r.createProject(t,u.profile.user_id,u.profile.tenant))).then(t=>(e=t.id,"numbers"===t.type?l.all(n.map(e=>i.bulkAddTrainingData(t,e))):i.bulkAddTrainingData(t,n,u.profile.user_id,u.profile.tenant))).then(()=>{s.go("projects",{id:e})}).catch(function(e){o.error("[ml4kds] Import failed",e),S("errors",e.status,e.data),u.creating=!1,u.loading=!1})}else r.createProject(t,u.profile.user_id,u.profile.tenant).then(function(e){if(e.testdata){var t=e;try{n.setItem("testdata://"+t.id,t.testdata.map(e=>e.map(e=>"string"==typeof e?'"'+e.replaceAll('"','""')+'"':e).join(",")).join("\r\n"))}catch(e){o.error("[ml4kds] Failed to store test data in local storage",e)}}s.go("projects",{id:e.id})}).catch(function(e){o.error("[ml4kds] Import failed",e),S("errors",e.status,e.data),u.creating=!1})}}}angular.module("app").controller("DatasetsController",e),e.$inject=["authService","projectsService","datasetsService","loggerService","trainingService","storageService","$state","$translate","$mdDialog","$q"]}(),function(){function e(t,d){return{getDataset:function(u,e){return t.get("/static/datasets/"+u+"/"+e+".json").then(e=>e.data).then(e=>{const t=[];var n=Object.keys(e.data);if("imgtfjs"===u)for(const a of n){const o=d.sanitizeLabel(a);e.data[a].forEach(e=>{t.push({imageurl:e,label:o})})}else if("text"===u)for(const i of n){const s=d.sanitizeLabel(i);e.data[i].forEach(e=>{t.push({textdata:e,label:s})})}else if("numbers"===u){const c=e.metadata.fields.map(e=>e.name);for(const l of n){var r=d.sanitizeLabel(l);0<e.data[l].length&&t.push({label:r,numbers:e.data[l].map(n=>{const r={};return c.forEach((e,t)=>{r[e]=n[t]}),r})})}}return{language:e.metadata.language,fields:e.metadata.fields,trainingdata:t,labels:n.map(d.sanitizeLabel)}})}}}angular.module("app").service("datasetsService",e),e.$inject=["$http","browserStorageService"]}(),function(){function e(e,d,t,p,m,S,n,f,s,O,g){var R=this,T=(R.authService=e,f.loading=!0,f.projectId=n.projectId,f.userId=n.userId,f.modelId=n.modelId,f.modelinfo=void 0,f.currentExample=void 0,1);function r(e,t,n){var r=T++,n={code:(n=n||{}).code,alertid:r,message:n.message||n.error||"Unknown error",status:t};return R[e].push(n),r}function a(t){s(function(){var e=document.getElementById(t);g.duScrollToElementAnimated(angular.element(e))},0)}R.errors=[],R.warnings=[],R.dismissAlert=function(e,t){R[e].splice(t,1)},S.loadScript("/static/bower_components/d3/d3.min.js").then(function(){return e.getProfileDeferred()}).then(function(e){return R.profile=e,m.debug("[ml4kdesc] Getting project info"),d.getProject(f.projectId,f.userId,e.tenant)}).then(function(e){return m.debug("[ml4kdesc] project",e),f.project=e,m.debug("[ml4kdesc] getting ML models"),t.getModels(e,f.userId,R.profile.tenant)}).then(function(e){if(m.debug("[ml4kdesc] models",e),e&&0<e.length&&"Available"===e[0].status||"Training"===e[0].status)return t.getModel(f.project.id,f.userId,R.profile.tenant,f.modelId,e[0].updated);a("errors"+r("errors",400,{message:"Model not ready to be described"})),f.loading=!1}).then(function(e){m.debug("[ml4kdesc] model info",e),f.loading=!1,f.modelinfo=e,m.debug("[ml4kdesc] initializing visualization"),m.debug("[ml4kdesc] initializing weights and bias values");for(var t=1;t<8;t++)for(var n=t+1,r=0;r<10;r++){var a=t+"_"+r;A[a]=5-r%5,c[a]=0,E[a]={};for(var o=0;o<10;o++){var i=n+"_"+o;E[a][i]=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}(1,5)}}s(function(){p.init("mlforkidsmodelvizimg"),D(H.INITIAL)},0)}).catch(function(e){a("errors"+r("errors",e.status,e.data)),f.loading=!1});var h={architecture:[],spacing:[]},E={},A={},c={};function I(e){return e+(.5<Math.random()?1:-1)}var H={INITIAL:"initial",CUSTOM:"custom",FEATURE_SELECTION:"feature",BAG_OF_WORDS:"bag-of-words"};function N(){return h.architecture[1]}function y(){R.wizardBusy=!1}R.wizardPage=1,R.wizardBusy=!1,R.searchBoxLinks=["","https://duckduckgo.com/?q=neural+networks","https://duckduckgo.com/?q=deep+learning","https://duckduckgo.com/?q=input+layer+neural+network","https://duckduckgo.com/?q=encoding+text+classification","https://duckduckgo.com/?q=bag+of+words+machine+learning","https://duckduckgo.com/?q=feature+extraction+text+classification","https://duckduckgo.com/?q=word+embedding+neural+network","https://duckduckgo.com/?q=hidden+layer+neural+network","https://duckduckgo.com/?q=activation+function+neural+network","https://duckduckgo.com/?q=weight+bias+neural+network","https://duckduckgo.com/?q=weight+bias+neural+network","https://duckduckgo.com/?q=activation+function+neural+network","https://duckduckgo.com/?q=activation+function+neural+network","https://duckduckgo.com/?q=hidden+layer+neural+network","https://duckduckgo.com/?q=hidden+layer+neural+network","https://duckduckgo.com/?q=output+layer+neural+network","https://duckduckgo.com/?q=loss+function+neural+networks+artificial+intelligence","https://duckduckgo.com/?q=back+propagation+neural+network","https://duckduckgo.com/?q=neural+networks","https://duckduckgo.com/?q=encoding+text+classification","https://duckduckgo.com/?q=hidden+layer+neural+network","https://duckduckgo.com/?q=activation+function+neural+network","https://duckduckgo.com/?q=activation+function+neural+network","https://duckduckgo.com/?q=hidden+layer+neural+network","https://duckduckgo.com/?q=output+layer+neural+network","https://duckduckgo.com/?q=loss+function+neural+networks+artificial+intelligence","https://duckduckgo.com/?q=back+propagation+neural+network","https://duckduckgo.com/?q=epochs+neural+network","https://duckduckgo.com/?q=neural+networks"];var v=[];function o(){switch(m.debug("[ml4kdesc] displaying wizard page",R.wizardPage),Q(),R.wizardPage){case 1:y();break;case 2:m.debug("[ml4kdesc] animating network layers"),T=0,p.toggleLayerHighlight(T),v.push(O(function(){p.toggleLayerHighlight(T),T+=1,p.toggleLayerHighlight(T)},L,100)),y();break;case 3:f.currentExample=f.modelinfo.examples[0],K(y);break;case 4:W(f.currentExample.random,U,y);break;case 5:W(f.currentExample.bagofwords,L,y);break;case 6:W(f.currentExample.customfeatures,L,y);break;case 7:W(f.currentExample.random,U,y);break;case 8:c=2,S=y,m.debug("[ml4kdesc] populating hidden layer with placeholders",c),E=0,g=h.architecture[c],v.push(O(function(){k(c,E),E+=1,S&&E===g&&S()},U,g));break;case 9:M(2,0,{}),y();break;case 10:M(2,0,{weight:!0}),y();break;case 11:M(2,0,{weight:!0,bias:!0}),y();break;case 12:M(2,0,{weight:!0,bias:!0,finalvalue:!0}),y();break;case 13:M(2,1,{weight:!0,bias:!0,finalvalue:!0}),y();break;case 14:M(2,2,{weight:!0,bias:!0,finalvalue:!0}),y();break;case 15:B(b,y);break;case 16:G(y);break;case 17:Z(y);break;case 18:z(L,y);break;case 19:P(),f.currentExample=f.modelinfo.examples[1],K(y);break;case 20:W(f.currentExample.random,U,y);break;case 21:M(2,0,{weight:!0,bias:!0,finalvalue:!0}),y();break;case 22:M(2,1,{weight:!0,bias:!0,finalvalue:!0}),y();break;case 23:M(2,2,{weight:!0,bias:!0,finalvalue:!0}),y();break;case 24:B(U,y);break;case 25:G(y);break;case 26:Z(y);break;case 27:z(U,y);break;case 28:var e=y,t=(m.debug("[ml4kdesc] animating network layers with real examples"),N()),l=1,u=[];u.push({action:"next-example",node:[0,0]}),u.push({action:"highlight-example",node:[0,0]});for(var n=0;n<t;n++)u.push({action:"input-layer",node:[1,n]});u.push({action:"remove-focus",node:[0,0]});for(var r=2;r<h.architecture.length-1;r++)for(var a=0;a<h.architecture[r];a++)u.push({action:"hidden-nodes",node:[r,a]});u.push({action:"remove-focus",node:[0,0]});for(var o=0;o<f.project.labels.length;o++)u.push({action:"output-layer",node:[4,o]});u.push({action:"output-info",node:[4,0]}),u.push({action:"error-rate",node:[4,0]}),u.push({action:"hide-example",node:[0,0]});for(var i=4;2<=i;i--){if(i<4){for(var s=0;s<h.architecture[i];s++)u.push({action:"highlight-bias",node:[i,s]}),u.push({action:"adjust-bias",node:[i,s]});u.push({action:"remove-bias-highlights",node:[i,0]})}u.push({action:"display-weights",node:[i,0]}),u.push({action:"highlight-weights",node:[i,0]}),u.push({action:"adjust-weights",node:[i,0]}),u.push({action:"display-weights",node:[i,0]}),u.push({action:"hide-weights",node:[i,0]})}var d=0;v.push(O(function(){var e=u[d],t=e.action,e=e.node,n=e[0],r=e[1],a=n+"_"+r,o={};if(m.debug("[ml4kdesc] animation",t,e),"next-example"===t)p.remove_focus(),p.updateOutputHtml(),f.currentExample=f.modelinfo.examples[l],p.updateInputText(f.currentExample.text),l=(l+1)%f.modelinfo.examples.length;else if("highlight-example"===t)p.highlightInputText();else if("input-layer"===t){e=f.currentExample.random[r];o[a]={value:e.value},p.updateLabels(o)}else if("hidden-nodes"===t)o[a]={value:C(n,r)},p.updateLabels(o);else if("output-layer"===t)F();else if("output-info"===t)w({});else if("error-rate"===t)p.remove_focus(),w({training:!0});else if("hide-example"===t)p.removeValues(),w({training:!0,error:!0,errorhighlight:!0});else if("display-weights"===t)_(n,{});else if("hide-weights"===t)p.removeValues(),_(n,{hide:!0});else if("highlight-weights"===t)_(n,{highlight:!0});else if("adjust-weights"===t)_(n,{highlight:!0,adjustment:!0});else if("highlight-bias"===t)o[a]={bias:A[a]},p.updateLabels(o,!0);else if("adjust-bias"===t)A[a]=I(A[a]),o[a]={bias:A[a]},p.updateLabels(o,!0);else if("remove-bias-highlights"===t){for(var i=h.architecture[n],s=0;s<i;s++){var c=n+"_"+s;o[c]={bias:A[c]}}p.updateLabels(o)}else"remove-focus"===t&&p.remove_focus();d=(d+1)%u.length},x,1500)),e();break;case 29:D(H.INITIAL)}var c,S,E,g,T}R.previousPage=function(){m.debug("[ml4kdesc] previousPage"),R.wizardBusy=!0,1<R.wizardPage&&(R.wizardPage=R.wizardPage-1),2===R.wizardPage&&D(H.INITIAL),3===R.wizardPage&&p.clearInputLabels(),4===R.wizardPage&&(D(H.CUSTOM),K()),5===R.wizardPage&&(D(H.BAG_OF_WORDS),K()),8===R.wizardPage&&p.hideAnnotation("2_0"),10===R.wizardPage&&l(2,0),11===R.wizardPage&&k(2,0),12===R.wizardPage&&(l(2,1),k(2,1),p.hideAnnotation("2_1")),13===R.wizardPage&&(l(2,2),k(2,2),p.hideAnnotation("2_2")),14!==R.wizardPage&&15!==R.wizardPage||(k(2,3),k(2,4),Y(3)),15===R.wizardPage&&(P(),$()),19===R.wizardPage&&p.clearInputLabels(),20===R.wizardPage&&(k(2,0),p.hideAnnotation("2_0")),21===R.wizardPage&&(k(2,1),p.hideAnnotation("2_1")),22===R.wizardPage&&(k(2,2),p.hideAnnotation("2_2")),23!==R.wizardPage&&24!==R.wizardPage||(k(2,3),k(2,4),Y(3)),24===R.wizardPage&&(P(),$()),o()},R.nextPage=function(){m.debug("[ml4kdesc] nextPage"),R.wizardBusy=!0,R.wizardPage<29&&(R.wizardPage=R.wizardPage+1),3===R.wizardPage&&D(H.CUSTOM),5===R.wizardPage&&(D(H.BAG_OF_WORDS),K()),6===R.wizardPage&&(D(H.FEATURE_SELECTION),K()),7===R.wizardPage&&(D(H.CUSTOM),K()),13===R.wizardPage&&p.hideAnnotation("2_0"),14===R.wizardPage&&p.hideAnnotation("2_1"),15===R.wizardPage&&p.hideAnnotation("2_2"),22===R.wizardPage&&p.hideAnnotation("2_0"),23===R.wizardPage&&p.hideAnnotation("2_1"),24===R.wizardPage&&p.hideAnnotation("2_2"),o()};var i,j=800,b=600,L=400,U=200,x=150;function D(e){m.debug("[ml4kdesc] redrawing the model network diagram",e),(e=e)===H.INITIAL?(h.architecture=[9,7,9,5,7,1],h.spacing=[20,20,20,20,20,20]):e===H.CUSTOM?(h.architecture=[1,7,5,8,f.project.labels.length],h.spacing=[0,20,20,20,100]):e===H.BAG_OF_WORDS?(h.architecture=[1,10,5,8,f.project.labels.length],h.spacing=[0,20,20,20,100]):e===H.FEATURE_SELECTION&&(h.architecture=[1,9,6,7,f.project.labels.length],h.spacing=[0,20,20,20,100]),p.create(h.architecture,h.spacing)}function Q(){m.debug("[ml4kdesc] stopping previous animations");for(var e=0;e<v.length;e++)O.cancel(v[e]);v=[],p.remove_focus()}function K(e){m.debug("[ml4kdesc] displaying training example in diagram"),p.updateInputText(f.currentExample.text),p.highlightInputText(),e&&e()}function W(n,e,r){m.debug("[ml4kdesc] populating input layer"),p.clearInputLabels();var a=0,o={},i=N();v.push(O(function(){var e=n[a],t="1_"+a;o[t]={value:e.value},p.updateLabels(o),e.annotation&&p.showAnnotation(t,e.annotation),a+=1,r&&a===i&&r()},e,i))}function C(e,t){m.debug("[ml4kdesc] calculating hidden layer value",e,t);for(var n=0,r=e+"_"+t,a=N(),o=e-1,i=0;i<a;i++)n+=f.currentExample.random[i].value*E[o+"_"+i][r];return n+=A[r],c[r]=n}function l(e,t){var n={};n[e+"_"+t]={bias:void 0},p.updateLabels(n)}function k(e,t){var n={};n[e+"_"+t]={value:"?"},p.updateLabels(n)}function Y(e){for(var t=0;t<h.architecture[e];t++)k(e,t)}function M(e,t,n){m.debug("[ml4kdesc] displaying hidden layer values",e,t,n),p.highlightHiddenLayerNode(e,t);var r=e-1,a=h.architecture[r],o=a-1,i=e+"_"+t;if(n.weight){for(var s=[],c=0;c<a;c++)s.push("w = "+E[r+"_"+c][i]);p.displayWeights(e,t,s,{})}var l={},u=((n.bias||n.value)&&(l[i]={},n.bias&&(l[i].bias=A[i]),n.finalvalue&&(l[i].value=C(e,t)),p.updateLabels(l)),"<table>");n.bias&&(u=u+("<tr><td>"+A[i])+"</td><td></td><td></td><td></td><td>+</td></tr><tr><td colspan=5 style='font-size: 0.2em;'> &nbsp; </td></tr>");for(var d=0;d<a;d++){var S="<tr>";S+="<td>"+f.currentExample.random[d].value+"</td>",n.weight&&(S+="<td>x</td><td>"+E[r+"_"+d][i]+"</td>"),u+=S=S+("<td></td><td>"+(d===o?"":"+")+"</td>")+"</tr>"}n.finalvalue&&(u=u+"<tr><td colspan=5 style='font-size: 0.25em;'> &nbsp; </td></tr><tr><td colspan=5> = "+l[i].value+"</td></tr>"),p.showAnnotation(i,u+="</table>")}function B(e,n){m.debug("[ml4kdesc] display hidden layer values",e);for(var r={},a=[[2,3],[2,4],[3,0],[3,1],[3,2],[3,3],[3,4],[3,5],[3,6],[3,7]],t=0;t<a.length;t++){var o=a[t],o=o[0]+"_"+o[1];r[o]={bias:A[o]}}p.updateLabels(r);var i=-1,s=a.length;v.push(O(function(){var e,t;0<=i&&(t=(e=a[i])[0]+"_"+e[1],r[t].value=C(e[0],e[1]),p.updateLabels(r)),i+=1,n&&i===s&&n()},e,s+1))}function P(){p.updateOutputHtml()}function G(e){m.debug("[ml4kdesc] display output values"),F(),s(function(){w({}),e()},b)}function $(){for(var e=h.architecture.length-1,t={},n=0;n<f.project.labels.length;n++)t[e+"_"+n]={value:""};p.updateLabels(t)}function F(){m.debug("[ml4kdesc] adding output layer node values");for(var e=h.architecture.length-1,t={},n=0;n<f.project.labels.length;n++){var r=f.project.labels[n];t[e+"_"+n]={value:f.currentExample.output[r]}}p.updateLabels(t)}function Z(e){m.debug("[ml4kdesc] displaying output error rate"),w({training:!0}),s(function(){w({training:!0,error:!0}),e()},j)}function w(e){m.debug("[ml4kdesc] generating output info table",e);var t="<table>";t+="<tr><th>label</th><th>output</th>",e.training&&(t+="<th>training</th>",e.error)&&(t+="<th>error</th>"),t+="</tr>";for(var n=0;n<f.project.labels.length;n++){var r,a=f.project.labels[n],t=(t+="<tr>")+("<td>"+a+"</td><td>"+f.currentExample.output[a]+"</td>");e.training&&(t+="<td>"+(r=a===f.currentExample.label?100:0)+"</td>",e.error)&&(0<(a=f.currentExample.output[a]-r)&&(a="+"+a),t+="<td>"+(e.errorhighlight?"<strong>":"")+a+(e.errorhighlight?"</strong>":"")+"</td>"),t+="</tr>"}p.updateOutputHtml(t+="</table>")}function _(e,t){m.debug("[ml4kdesc] displaying link weights",e,t);for(var n=e-1,r=h.architecture[n],a=h.architecture[e],o=0;o<a;o++){for(var i=e+"_"+o,s=[],c=0;c<r;c++)t.hide?s.push(""):(t.adjustment&&(E[n+"_"+c][i]=I(E[n+"_"+c][i])),s.push(E[n+"_"+c][i]));p.displayWeights(e,o,s,{label:t.highlight})}}function z(e,s){m.debug("[ml4kdesc] running backprop animation"),p.removeValues(),w({training:!0,error:!0,errorhighlight:!0});for(var c=[],t=h.architecture.length-1;1<t;t--){for(var n=0;n<h.architecture[t];n++)t!=h.architecture.length-1&&(c.push({layer:t,type:"bias",node:n,action:"adjust"}),c.push({layer:t,type:"bias",node:n,action:"current"}));for(n=0;n<h.architecture[t];n++)c.push({layer:t,type:"weights",node:n,action:"current"}),c.push({layer:t,type:"weights",node:n,action:"adjust"}),c.push({layer:t,type:"weights",node:n,action:"hide"})}var l=0;v.push(O(function(){var e=c[l],t=e.layer+"_"+e.node;if("weights"===e.type){var n=e.layer-1,r=h.architecture[n],a={label:"adjust"===e.action,path:"hide"!==e.action},o=[];if("adjust"===e.action)for(var i=0;i<r;i++)E[n+"_"+i][t]=I(E[n+"_"+i][t]);if("current"===e.action||"adjust"===e.action)for(i=0;i<r;i++)o.push("w = "+E[n+"_"+i][t]);if("hide"===e.action)for(i=0;i<r;i++)o.push("");p.displayWeights(e.layer,e.node,o,a)}"bias"===e.type&&("adjust"===e.action&&(A[t]=I(A[t])),(a={})[t]={bias:A[t]},p.updateLabels(a,"adjust"===e.action)),l+=1,s&&l===c.length&&s()},e,c.length))}f.$on("$destroy",function(){m.debug("[ml4kdesc] handling page change"),Q()}),R.stop=function(){i&&(O.cancel(i),clearInterval(i),i=void 0)};var u=100;R.grow=function(){R.stop();var e=document.getElementById("mlforkidsmodelvizimg");i=O(function(){u+=10,e.style.width=u+"%"},50)},R.shrink=function(){R.stop();var e=document.getElementById("mlforkidsmodelvizimg");i=O(function(){100<u&&(u-=10,e.style.width=u+"%")},50)},R.goleft=function(){R.stop();var e=document.getElementById("mlforkidsmodelvizimghost");i=O(function(){e.scrollLeft+=20,console.log("left : "+e.scrollLeft)},50)},R.goright=function(){R.stop();var e=document.getElementById("mlforkidsmodelvizimghost");i=O(function(){e.scrollLeft-=20,console.log("left : "+e.scrollLeft)},50)},R.goup=function(){R.stop();var e=document.getElementById("mlforkidsmodelvizimghost");i=O(function(){e.scrollTop-=20,console.log("top : "+e.scrollTop)},50)},R.godown=function(){R.stop();var e=document.getElementById("mlforkidsmodelvizimghost");i=O(function(){e.scrollTop+=20,console.log("top : "+e.scrollTop)},50)}}angular.module("app").controller("ModelTextDescribeController",e),e.$inject=["authService","projectsService","trainingService","fcnnVisualisationService","loggerService","utilService","$stateParams","$scope","$timeout","$interval","$document"]}(),function(){function e(g){var T,p,m,t,n,o,s,c,S,f="ml4kids_nn_",O="http://www.w3.org/2000/svg",R="http://www.w3.org/1999/xhtml";function r(e){return t=2,n=e,(r=Array(t).fill().map(function(){return n[Symbol.iterator]()})).forEach(function(e,t){Array(t).fill().forEach(function(){return e.next()})}),Array(n.length-t+1).fill().map(function(){return r.map(function(e){return e.next().value})});var t,n,r}function a(e){return e.reduce(function(e,t){return e.concat(Array.isArray(t)?a(t):t)},[])}var h=[],i=[],l=0,u=.5,d=1,E="#505050",A=50,I="#ffffff",H="#333333",N=160;function y(e){return e.id}function v(){n.nodes=h.map(function(e,t){return Array(e).fill(0).map(function(e,t){return t}).map(function(e){return{id:f+(t+"_")+e,layer:t,node_index:e}})}),n.links=r(n.nodes).map(function(e){return e[0].map(function(t){return e[1].map(function(e){return e.node_index<0?null:{id:f+t.id+"-"+e.id,source:t.id,target:e.id}})})}),n.nodes=a(n.nodes),n.links=a(n.links),(s=s.data(n.links,y)).exit().remove(),s=s.enter().insert("path",".node").attr("class","link").attr("id",y).merge(s),(c=c.data(n.nodes,y)).exit().remove(),c=c.enter().append("circle").attr("r",A/2).attr("class",function(e){return"node nnlayer"+e.layer}).attr("id",y).merge(c),s.style("stroke-width",u),s.style("stroke-opacity",d),s.style("stroke",E),c.attr("r",A/2),c.style("fill",I),c.style("stroke",H);for(var e=S.querySelectorAll(".nodedata, .nodevalue, .nodeseparator, .nodeweight, .additionalnndiagramelement"),t=0;t<e.length;t++)e[t].remove()}function b(){function n(e){return e.substr(f.length).split("_").map(function(e){return parseInt(e)})}function r(e){return e*(N+A)+T/2-N*o.length/3}function a(e,t){return o[e]+t*(A+i[e])+p/2-l/2}var e=h.map(function(e,t){return e*A+(e-1)*i[t]});l=Math.max.apply(null,e),o=e.map(function(e){return(l-e)/2});c.attr("cx",function(e){return r(e.layer)}).attr("cy",function(e){return a(e.layer,e.node_index)}),s.attr("d",function(e){var t=n(e.source),e=n(e.target);return"M"+r(t[0])+","+a(t[0],t[1])+", "+r(e[0])+","+a(e[0],e[1])})}var L={INPUT_TEXT_CONTAINER:"input_text_container",INPUT_TEXT:"input_text",OUTPUT_LAYER_CONTAINER:"output_layer_container",OUTPUT_LAYER:"output_layer",BIAS:"bias",WEIGHT:"weight",NODE_VALUE:"value",PATH_TEXT:"text",SEPARATOR:"separator",ANNOTATION:"annotation"},U={INPUT_TEXT:0,INPUT_LAYER:1};function D(e,t){return document.getElementById(f+(e+"_")+t)}function K(){g.debug("[fcnn] Adding labels");var e={idx:0,size:0};S=D(U.INPUT_TEXT,0),l=parseFloat(S.getAttribute("cx")),d=parseFloat(S.getAttribute("cy")),l=C(O,"foreignObject",{id:f+L.INPUT_TEXT_CONTAINER,x:l-60,y:d,width:120,height:70,"dominant-anchor":"middle","text-anchor":"middle",style:"overflow:visible",class:"additionalnndiagramelement"},S.parentNode),(S=C(R,"div",{id:f+L.INPUT_TEXT,class:"inputdata hiddendiagramelement additionalnndiagramelement"},l)).textContent="input text",l.setAttributeNS(null,"y",d-S.clientHeight/2),d=D(l=h.length-1,0),l=D(l,h[l]-1),S=parseFloat(d.getAttribute("cx")),u=parseFloat(d.getAttribute("cy")),l=parseFloat(l.getAttribute("cy")),S=C(O,"foreignObject",{id:f+L.OUTPUT_LAYER_CONTAINER,x:S+40,y:u+(l-u)/2-60,width:460,height:120,"dominant-anchor":"middle","text-anchor":"middle",style:"overflow:visible",class:"additionalnndiagramelement"},d.parentNode),C(R,"div",{id:f+L.OUTPUT_LAYER,class:"outputlayerdetail hiddendiagramelement additionalnndiagramelement"},S);for(var t,n,r,a,o=U.INPUT_LAYER;o<h.length;o++)if(h[o]>e.size&&(e={idx:o,size:h[o]}),o===U.INPUT_LAYER)for(var i=0;i<h[o];i++)W(o,i,o+"_"+i,!0);else if(o===h.length-1)for(var s=0;s<h[o];s++)W(o,s,o+"_"+s,!1);else for(var c=0;c<h[o];c++)r=(t=o)+"_"+(n=c),a=void 0,t=D(t,n),n=parseFloat(t.getAttribute("cx")),a=parseFloat(t.getAttribute("cy")),C(O,"text",{id:f+L.BIAS+r,x:n,y:a-8,"dominant-anchor":"middle","text-anchor":"middle",class:"nodedata"},t.parentNode),C(O,"line",{id:f+L.SEPARATOR+r,x1:n-20,x2:n+20,y1:a-4,y2:a-4,class:"nodeseparator hiddendiagramelement"},t.parentNode),C(O,"text",{id:f+L.NODE_VALUE+r,x:n,y:a+14,"dominant-anchor":"middle","text-anchor":"middle",class:"nodevalue"},t.parentNode),n=C(O,"foreignObject",{x:n+25,y:a-30,width:150,height:70,"dominant-anchor":"text-top","text-anchor":"start",style:"overflow: visible",class:"additionalnndiagramelement"},t.parentNode),C(R,"div",{id:f+L.ANNOTATION+r,class:"hiddenlayerfunction hiddendiagramelement additionalnndiagramelement"},n);var l=e,u=(g.debug("[fcnn] Setting the view box based on the location of nodes in layer",l),D(U.INPUT_TEXT,0)),d=document.getElementById(f+L.OUTPUT_LAYER_CONTAINER),S=D(l.idx,0),l=D(l.idx,h[l.idx-1]),u=parseFloat(u.getAttribute("cx")),E=parseFloat(d.getAttribute("x")),S=parseFloat(S.getAttribute("cy")),l=parseFloat(l.getAttribute("cy"));d?(T=E-u+550,(p=l-S+400)<500&&(p=900)):(T=window.innerWidth,p=window.innerHeight),m.attr("viewBox",u-80+" "+(S-30)+" "+T+" "+p)}function W(e,t,n,r){var e=D(e,t),t=parseFloat(e.getAttribute("cx")),a=parseFloat(e.getAttribute("cy"));C(O,"text",{id:f+L.NODE_VALUE+n,x:t,y:a+5,"dominant-anchor":"middle","text-anchor":"middle",class:"nodevalue"},e.parentNode),r&&(r=C(O,"foreignObject",{x:t+20,y:a-25,width:150,height:70,"dominant-anchor":"text-top","text-anchor":"start",class:"additionalnndiagramelement"},e.parentNode),C(R,"div",{id:f+L.ANNOTATION+n,class:"inputannotation hiddendiagramelement additionalnndiagramelement"},r))}function C(e,t,n,r){var a,o=document.createElementNS(e,t);for(a in n)o.setAttributeNS(null,a,n[a]);return r.appendChild(o),o}function k(){g.debug("[fcnn] Clear input labels");for(var e=0;e<h[U.INPUT_LAYER];e++)D(U.INPUT_LAYER,e).classList.remove("highlightedlayer"),document.getElementById(f+L.NODE_VALUE+"1_"+e).textContent=""}function e(e){for(var t=f+L.SEPARATOR+e.id,n=f+L.BIAS+e.id,r=f+L.NODE_VALUE+e.id,a=S.querySelectorAll(".nodeseparator"),o=0;o<a.length;o++){var i=a[o];(l=i.id===t)&&i.classList.remove("hiddendiagramelement"),i.style.opacity=l?1:.1}for(var a=S.querySelectorAll(".nodedata"),s=0;s<a.length;s++){var c=a[s],l=c.id===n;c.style.opacity=l?1:.1}a=S.querySelectorAll(".nodevalue");for(var u=0;u<a.length;u++){var d=a[u],l=d.id===r||d.id.startsWith(f+L.NODE_VALUE+(e.layer-1)+"_");d.style.opacity=l?1:.1}}function M(){K(),g.debug("[fcnn] Adding weights");for(var e=D(U.INPUT_TEXT,0).parentNode,t=U.INPUT_LAYER;t<h.length-1;t++)for(var n=t+1,r=h[n],a=h[t],o=0;o<a;o++)for(var i=f+(t+"_")+o,s=0;s<r;s++){var c=f+i+"-"+f+n+"_"+s,l=C(O,"text",{"text-anchor":"middle",class:"additionalnndiagramelement"},e);C(O,"textPath",{id:c+L.PATH_TEXT,href:"#"+c,startOffset:"65%",class:"nodeweight"},l)}1<h[0]&&D(U.INPUT_TEXT,0).classList.remove("hiddendiagramelement")}return{init:function(e){S=document.getElementById(e),T=window.innerWidth,p=window.innerHeight,m=d3.select("#"+e).append("svg").attr("xmlns",O),t=m.append("g"),n={},o=[],s=t.selectAll(".link"),c=t.selectAll(".node"),T=window.innerWidth,p=window.innerHeight,m.attr("viewBox","0 0 "+T+" "+p)},create:function(e,t){h=e,i=t,v(),b(),M()},updateLabels:function(e,t){for(var n in e){var r,a=e[n];"bias"in a&&(t?document.getElementById(f+n).classList.add("highlightedlayer"):document.getElementById(f+n).classList.remove("highlightedlayer"),r=void 0===a.bias?"":"b="+a.bias,document.getElementById(f+L.BIAS+n).textContent=r,document.getElementById(f+L.SEPARATOR+n).classList.remove("hiddendiagramelement")),"value"in a&&(document.getElementById(f+n).classList.add("highlightedlayer"),document.getElementById(f+L.NODE_VALUE+n).textContent=a.value)}},updateInputText:function(e){g.debug("[fcnn] Updating input text",e);var t=document.getElementById(f+L.INPUT_TEXT);t.textContent=e,t.classList.remove("hiddendiagramelement");(e=D(U.INPUT_TEXT,0)).classList.add("hiddendiagramelement");var e=parseFloat(e.getAttribute("cy")),n=document.getElementById(f+L.INPUT_TEXT_CONTAINER);n.setAttributeNS(null,"y",e-t.clientHeight/2),n.classList.remove("hiddendiagramelement")},updateOutputHtml:function(e){g.debug("[fcnn] Updating output detail");var t=document.getElementById(f+L.OUTPUT_LAYER);e?(t.innerHTML=e,t.classList.remove("hiddendiagramelement")):t.classList.add("hiddendiagramelement")},displayWeights:function(e,t,n,r){for(var a=e-1,o=h[a],i=0;i<o;i++){var s=f+(f+(a+"_")+i)+"-"+f+e+"_"+t,c=s+L.PATH_TEXT,s=document.getElementById(s),s=(r.path?s.classList.add("highlighted"):s.classList.remove("highlighted"),document.getElementById(c));s.textContent=n[i],r.label?s.classList.add("highlighted"):s.classList.remove("highlighted")}},clearInputLabels:k,showAnnotation:function(e,t){e=f+L.ANNOTATION+e,(e=document.getElementById(e)).innerHTML=t,e.classList.remove("hiddendiagramelement")},hideAnnotation:function(e){e=f+L.ANNOTATION+e,document.getElementById(e).classList.add("hiddendiagramelement")},highlightHiddenLayerNode:function(t,n){c.style("opacity",function(e){return 0===e.layer?0:e.layer===t&&e.node_index===n||e.layer==t-1?1:.1}),s.style("opacity",function(e){return e.target==f+t+"_"+n?1:.02}),document.getElementById(f+L.INPUT_TEXT).style.opacity=.1,e({id:t+"_"+n,layer:t})},highlightInputText:function(){document.getElementById(f+L.INPUT_TEXT).classList.add("highlightedlayer")},toggleLayerHighlight:function(e){for(var t=document.getElementsByClassName("nnlayer"+e%h.length),n=0;n<t.length;n++)t[n].classList.toggle("highlightedlayer")},removeValues:function(){s.style("opacity",function(e){return e.source===f+"0_0"?.02:1}),c.style("opacity",function(e){return 0===e.layer?.02:1}),k(),document.getElementById(f+L.INPUT_TEXT).classList.add("hiddendiagramelement"),document.getElementById(f+L.INPUT_TEXT_CONTAINER).classList.add("hiddendiagramelement");for(var e=1;e<h.length;e++)for(var t=0;t<h[e];t++)document.getElementById(f+L.NODE_VALUE+e+"_"+t).textContent=""},set_focus:function(t){c.style("opacity",function(e){return t==e||e.layer==t.layer-1?1:.1}),s.style("opacity",function(e){return e.target==t.id?1:.02}),e(t)},remove_focus:function(){c.style("opacity",1),s.style("opacity",function(){return d});for(var e=S.querySelectorAll(".nodeseparator, .nodedata, .nodevalue"),t=0;t<e.length;t++)e[t].style.opacity=1;for(var n=S.querySelectorAll(".nodeweight"),r=0;r<n.length;r++)n[r].textContent="";for(var a,o=S.querySelectorAll(".inputannotation"),i=0;i<o.length;i++)o[i].classList.add("hiddendiagramelement");c.classed("highlightedlayer",!1),(a=document.getElementById(f+L.INPUT_TEXT)).classList.remove("highlightedlayer"),a.style.opacity=1}}}angular.module("app").service("fcnnVisualisationService",e),e.$inject=["loggerService"]}(),function(){function e(e,d,t,n,r,S,o,a,i){var s=this,c=(s.authService=e,S.loading=!0,S.projectId=r.projectId,S.userId=r.userId,S.modelId=r.modelId,S.modelinfo=void 0,S.treenodes={},1);function l(e){return t.retrieveAsset(e).then(e=>e.text())}s.errors=[],s.warnings=[],s.dismissAlert=function(e,t){s[e].splice(t,1)},e.getProfileDeferred().then(e=>(s.profile=e,n.getProject(S.projectId,S.userId,s.profile.tenant))).then(e=>(S.project=e,l(S.projectId+"-tree"))).then(e=>{var n;return S.loading=!1,S.modelinfo=!0,n=e,d.debug("[ml4kdesc] initializing visualization"),o(function(){var e=document.createElement("div");e.id="mlforkidsmodelvizimg",e.innerHTML=n;document.getElementById("mlforkidsmodelvizimghost").appendChild(e);var e=e.getElementsByTagName("svg")[0],t=(e.removeAttribute("width"),e.removeAttribute("height"),document.createElement("style"));t.textContent=".nothighlighted { opacity: 0.25; } .highlighted { opacity: 1; } .highlighted.node path { stroke-width: 3; }",e.insertBefore(t,e.firstChild)},0),l(S.projectId+"-dot")}).then(e=>{d.debug("[ml4kdesc] preparing decision tree graph");for(var t=1,n=e.split("\n"),r=0;r<n.length;r++){var a,o,i=n[r],s=g.exec(i);s?(o=s[1],a=s[2].split("\\n"),s=s[3],S.treenodes[o]={id:o,children:[],edges:[]},4===a.length&&(S.treenodes[o].test=function(e){var t=u.exec(e);{if(t)return{field:t[1],op:t[2],threshold:t[3]};d.error("[ml4kdescribe] Unexpected test syntax"),d.error(e)}}(s))):(a=T.exec(i))&&(o=a[1],s=a[2],S.treenodes[o].children.push(s),i=t++,S.treenodes[o].edges.push(i))}return l(S.projectId+"-vocab").then(e=>JSON.parse(e))}).then(e=>(S.vocabulary=e,d.debug("[ml4kdesc] getting project fields"),n.getFields(S.project,S.userId,s.profile.tenant))).then(function(e){d.debug("[ml4kdesc] fields",e),S.project.fields=e}).catch(function(e){var t,n,r,a;t="errors",n=e.status,e=e.data,d.error(e),r=c++,e={code:(e=e||{}).code,alertid:r,message:e.message||e.error||"Unknown error",status:n},s[t].push(e),a="errors"+r,o(function(){var e=document.getElementById(a);i.duScrollToElementAnimated(angular.element(e))},0),S.loading=!1});var u=/^(.*) ([<=]{1,2}) (-?[0-9.]+)$/;var E,g=/^([0-9]+) \[fillcolor="#[a-z0-9]{6}", label="((.*?)\\n.*)"];$/,T=/^([0-9]+) -> ([0-9]+).*;$/;S.testformData={},s.resetTree=function(){d.debug("[ml4kdesc] resetting decision tree");for(var e=document.getElementById("mlforkidsmodelvizimg").querySelectorAll(".node,.edge"),t=0;t<e.length;t++){var n=e[t];n.classList.remove("highlighted"),n.classList.remove("nothighlighted")}},s.highlight=function(e){d.debug("[ml4kdesc] adding highlight"),s.resetTree();for(var t=function(e){d.debug("[ml4kdesc] identifying tree route");for(var t={},n=0;n<S.vocabulary.length;n++){var r,a=S.vocabulary[n],o=a.indexOf("=");-1===o?t[a]=e[a]:(r=a.substr(0,o),o=a.substr(o+1),t[a]=o===e[r]?1:0)}for(var i,s,c,l=[],u=S.treenodes[0];u;)l.push("node"+(parseInt(u.id)+1)),u=u.test?(c=t[(i=u.test).field],s=!1,"<="===i.op?s=c<=i.threshold:"="===i.op&&(s=c===i.threshold),c=s?u.children[0]:u.children[1],l.push("edge"+(s?u.edges[0]:u.edges[1])),S.treenodes[c]):void 0;return l}(function(e){for(var t=0;t<S.project.fields.length;t++){var n=S.project.fields[t];"number"===n.type&&(e[n.name]=Number(e[n.name]))}return e}(e)),n=document.getElementById("mlforkidsmodelvizimg").querySelectorAll(".node,.edge"),r=0;r<n.length;r++){var a=n[r];0<=t.indexOf(a.id)?a.classList.add("highlighted"):a.classList.add("nothighlighted")}},s.stop=function(){E&&(a.cancel(E),clearInterval(E),E=void 0)};var p=100;s.grow=function(){s.stop();var e=document.getElementById("mlforkidsmodelvizimg");E=a(function(){p+=10,e.style.width=p+"%"},50)},s.shrink=function(){s.stop();var e=document.getElementById("mlforkidsmodelvizimg");E=a(function(){100<p&&(p-=10,e.style.width=p+"%")},50)},s.goleft=function(){s.stop();var e=document.getElementById("mlforkidsmodelvizimghost");E=a(function(){e.scrollLeft+=20},50)},s.goright=function(){s.stop();var e=document.getElementById("mlforkidsmodelvizimghost");E=a(function(){e.scrollLeft-=20},50)},s.goup=function(){s.stop();var e=document.getElementById("mlforkidsmodelvizimghost");E=a(function(){e.scrollTop-=20},50)},s.godown=function(){s.stop();var e=document.getElementById("mlforkidsmodelvizimghost");E=a(function(){e.scrollTop+=20},50)}}angular.module("app").controller("ModelDescribeController",e),e.$inject=["authService","loggerService","browserStorageService","projectsService","$stateParams","$scope","$timeout","$interval","$document"]}(),function(){function e(e,t,n,r,a,o,i,s,c){var l=this,u=(l.authService=e,s.testdata={text:"The text that you want to test",storetext:"The text that you want to store",imagefile:"my-test-image.jpg",imageurl:"https://www.site-on-the-internet.com/image.jpg",fields:[],label:"label"},"EduBlocks"),d="Click on Clone to start editing your own copy of the code",S="Go";s.projectId=i.projectId,s.userId=i.userId,e.getProfileDeferred().then(function(e){return l.profile=e,r.debug("[ml4kedublocks] getting project"),t.getProject(s.projectId,s.userId,e.tenant)}).then(function(e){if((s.project=e).labels&&0<e.labels.length&&(s.testdata.label=e.labels[0]),"numbers"===e.type)return r.debug("[ml4kedublocks] getting project fields"),t.getFields(s.project,s.userId,l.profile.tenant)}).then(function(e){return s.fields=e,r.debug("[ml4kedublocks] getting Scratch key"),n.getScratchKeys(s.project,s.userId,l.profile.tenant)}).then(function(e){e&&(s.scratchkey=e[0])}).catch(function(e){s.failure={message:e.data.error,status:e.status}}),a(["EDUBLOCKS.TITLE","EDUBLOCKS.TIP","EDUBLOCKS.GO"]).then(function(e){u=e["EDUBLOCKS.TITLE"],d=e["EDUBLOCKS.TIP"],S=e["EDUBLOCKS.GO"]}),s.openEdublocksLink=function(e,t){o.show(o.alert().title(u).htmlContent(d).targetEvent(t).ok(S)).then(function(){c.open(e,"_blank")},function(){})}}angular.module("app").controller("EdublocksController",e),e.$inject=["authService","projectsService","scratchkeysService","loggerService","$translate","$mdDialog","$stateParams","$scope","$window"]}(),function(){function e(a,t,o,d,i,r,S){var E,g,T,p,m,f=!1,s=224,c=224;function l(e,t){S.debug("[ml4kimages] creating transfer learning model");e=tf.sequential({layers:[tf.layers.flatten({inputShape:e.outputs[0].shape.slice(1)}),tf.layers.dense({units:100,activation:"relu",kernelInitializer:"varianceScaling",useBias:!0}),tf.layers.dense({units:t,activation:"softmax",kernelInitializer:"varianceScaling",useBias:!1})]});return S.debug("[ml4kimages] compiling model"),e.compile({optimizer:tf.train.adam(1e-4),loss:"categoricalCrossentropy"}),e}function O(e,o){return a(function(n,t){var r=URL.createObjectURL(new Blob([e])),a=document.createElement("img");a.width=s,a.height=c,a.onerror=function(e){return S.error("[ml4kimages] Failed to load image",o),t(e)},a.onload=function(){var e=tf.tidy(function(){return tf.browser.fromPixels(a).expandDims(0).toFloat().div(127).sub(1)}),t=o?o.id:"test";S.debug("[ml4kimages] tensor image data "+t+" "+e.size+" ("+e.dtype+")"),n({metadata:o,data:e}),URL.revokeObjectURL(r)},a.src=r})}function n(e){e=g.predict(e);return E.predict(e).data().then(function(n){if(n.length!==p)throw S.error("[ml4kimages] unexpected output from model",n),new Error("Unexpected output from model");return m.map(function(e,t){return{class_name:e,confidence:100*n[t]}}).sort(d.sortByConfidence)}).catch(function(e){throw S.error("[ml4kimages] failed to run test",e),e})}var R="images";return{initImageSupport:function(n,e){return S.debug("[ml4kimages] initialising image model support",n),p=e.length,m=e,S.debug("[ml4kimages] loading tensorflow"),r.loadTensorFlow().then(function(){S.debug("[ml4kimages] enabling tf prod mode"),tf&&tf.enableProdMode&&(tf.enableProdMode(),S.debug("[ml4kimages] tfjs version",tf.version))}).catch(function(e){throw S.error("[ml4kimages] failed to load tensorflow",e),e}).then(function(){return S.debug("[ml4kimages] preparing mobilenet for transfer learning"),e=t.protocol()+"://"+t.host(),e=(e=t.port()?e+":"+t.port():e)+"/static/bower_components/tensorflow-models/image-recognition/model.json",tf.loadLayersModel(e).then(function(e){var t=e.getLayer("conv_pw_13_relu");return tf.model({inputs:e.inputs,outputs:t.output})}).catch(function(e){throw S.error("[ml4kimages] failed to prepare mobilenet",e),e});var e}).then(function(e){return g=e,t=n,d.loadModel(R,t).then(function(e){if(e)return T={classifierid:t,status:"Available",progress:100,updated:e.timestamp},f=!0,e.output}).catch(function(e){S.error("[ml4kimages] failed to load model",e)});var t}).then(function(e){if(e)return E=e,T;E=l(g,p)})},newModel:function(u,e,n){S.debug("[ml4kimages] creating new ML model"),S.debug("[ml4kimages] tf backend",tf.getBackend()),S.debug("[ml4kimages] tf precision",tf.ENV.getBool("WEBGL_RENDER_FLOAT32_ENABLED")),T={classifierid:u,status:"Training",progress:0,updated:new Date},f&&(E=l(g,p));let t;return t=i.idIsLocal(u)?e=>O(e.imagedata,e):t=>(S.debug("[ml4kimages] training image metadata",t),o.getTrainingItem(u,e,n,t.id).then(function(e){return S.debug("[ml4kimages] retrieved image data "+t.id+" "+e.byteLength+" bytes"),O(e,t)})),S.debug("[ml4kimages] getting training data"),r=t,o.getTraining(u,e,n).then(function(e){return a.all(e.map(r))}).then(function(e){S.debug("[ml4kimages] retrieved training data");for(var t=0;t<e.length;t++){var n,r,a,o,i=e[t],s=m.indexOf(i.metadata.label),i=g.predict(i.data),c=tf.tidy(function(){return tf.oneHot(tf.tensor1d([s]).toInt(),p)});0===t?(a=i,o=c):(r=o,a=(n=a).concat(i,0),o=r.concat(c,0),n.dispose(),r.dispose())}var l=10;return 55<e.length&&(l=15),E.fit(a,o,{batchSize:10,epochs:l,callbacks:{onEpochEnd:function(e,t){S.debug("[ml4kimages] epoch "+e+" loss "+t.loss),T&&(T.progress=15===l?7*(e+1):10*(e+1))},onTrainEnd:function(){return d.saveModel(R,u,E).then(function(){S.debug("[ml4kimages] training complete"),T&&(T.status="Available",T.progress=100),f=!1})}}}),T}).catch(function(e){return S.error("[ml4kimages] model training failure",e),T&&(T.status="Failed",T.updated=new Date,T.error=e),T});var r},deleteModel:function(e){return T=null,d.deleteModel(R,e)},getModels:function(){return S.debug("[ml4kimages] get models"),a(function(e){T?(T.lastPollTime=new Date,e([T])):e([])})},testCanvas:function(e){return n(tf.tidy(function(){return tf.browser.fromPixels(e).expandDims(0).toFloat().div(127).sub(1)}))},testBase64ImageData:function(e){return O(e).then(function(e){return n(e.data)})},reset:function(){try{E&&tf.dispose(E),g&&tf.dispose(g)}catch(e){S.debug("[ml4kimages] error when disposing of models",e)}}}}angular.module("app").service("imageTrainingService",e),e.$inject=["$q","$location","trainingService","modelService","browserStorageService","utilService","loggerService"]}(),function(){function e(e,t,n,r,a){var o=[];function i(){for(var e=0;e<arguments.length;e++){var t=arguments[e];t instanceof Error?t=JSON.stringify({name:t.name,message:t.message,stack:t.stack}):t&&t.reason&&t.reason.name&&t.reason.message?t=JSON.stringify({name:t.reason.name,message:t.reason.message,stack:t.reason.stack}):"string"!=typeof t&&(t=JSON.stringify(t)),o.push(Date.now()+" "+t+"\n")}}t.debug("[ml4klog] Initialising logger service"),window.addEventListener("error",i),window.addEventListener("unhandledrejection",i);var s=n.search();return t.debug("[ml4klog] site host",a.location.href),t.debug("[ml4klog] url parameters",s),s&&s.debug?(o=[],r.debugLogging=!0,{error:i,warn:i,debug:i,download:function(){o.push("[ml4klog] site host "),o.push(a.location.href),o.push("\n[ml4klog] url parameters "),o.push(JSON.stringify(s)),o.push("\n[ml4klog] version v=179"),e.downloadFile(o,"text/plain","mlforkids.log")}}):(o=[],r.debugLogging=!1,{error:t.error,warn:t.warn,debug:t.debug})}angular.module("app").service("loggerService",e),e.$inject=["downloadService","$log","$location","$rootScope","$window"]}(),function(){function e(t,n,r,e,a,o,i,s,c,l,u){var d=this,S=(d.authService=t,d.loginstate="login",e.search());if(S&&S.tab)switch(S.tab){case"login":case"reset":case"signup":case"teachersignup":case"newstudent":case"whyregister":d.loginstate=S.tab}d.sendEmail=function(e){"ar"===l.use()?u.show(u.alert().title("How to ask Dale to create a managed class account for you").htmlContent("<div>If you are a teacher or you run a not-for-profit coding group for children, please email me at dale.lane@uk.ibm.com with : <ul><li>your name and title</li><li>the name and web address of your school or coding group</li><li>the number of students in your group</li></ul></div>").ok("OK").targetEvent(e)):window.location="mailto:dale.lane@uk.ibm.com?subject=New%20MLforKids%20class%20account&body=___PLEASE%20FILL%20IN%20THIS%20TEMPLATE___%0A%0APlease%20can%20you%20setup%20a%20new%20class%20account%20for%20my%20group.%20%0A%0AI%20need%20it%20for%20my%20group%20of%20___THIS%20MANY___%20students.%20%0A%0AI%20run%20___NAME%20OF%20SCHOOL%20%2F%20DESCRIPTION%20OF%20CODING%20GROUP___.%20%0A%0AYou%20can%20find%20us%20at%20___WEB%20ADDRESS%20FOR%20SCHOOL%20OR%20CODING%20GROUP___.%0A%0AThanks%20very%20much!%0A%0A___WHO%20I%20AM___"},d.deployment=a.DEPLOYMENT,d.startTryItNowSession=function(e){n.debug("[ml4klogin] starting Try It Now"),i.failure=null,t.createSessionUser().then(function(){return r.deleteSessionUserProjects().catch(function(e){n.error("[ml4klogin] failed to cleanup session user resources",e)})}).then(function(){s(function(){c.go("projects")})}).catch(function(e){n.error("[ml4klogin] session creation failed",e);var t=e.data;i.failure={message:function(e){if(e&&e.error)return"Class full"===e.error?'There are too many students trying the site. Sorry, but there is a limit for how many students can use "Try it now" at once. Please do try later - or create yourself an account and log on now!':e.error;if(e&&e.message)return e.message;return"Unknown error"}(t),status:e.status},s(function(){var e=document.getElementById("sessionuserfailure");o.duScrollToElementAnimated(angular.element(e))},0)})}}angular.module("app").controller("LoginController",e),e.$inject=["authService","loggerService","browserStorageService","$location","$stateParams","$document","$scope","$timeout","$state","$translate","$mdDialog"]}(),function(){function e(e,t,n,r,a){var o=this;o.authService=e,r.projectId=n.projectId,r.userId=n.userId,r.loading=!0,e.getProfileDeferred().then(function(e){return o.profile=e,t.debug("[ml4kmakes] getting project info"),a.getProject(r.projectId,r.userId,e.tenant)}).then(function(e){r.project=e,r.makes=a.supportedMakes(e),r.loading=!1}).catch(function(e){r.loading=!1,r.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("MakesController",e),e.$inject=["authService","loggerService","$stateParams","$scope","projectsService"]}(),angular.module("app").directive("mlcanvas",function(){return{template:'<div class="mlcanvas"><canvas width="500" height="300"    ng-mousedown="handleMouseDown($event)"   ng-mousemove="handleMouseMove($event)"    ></canvas><div class="canvastools">    <div class="toolslabel">Tools</div>    <div class="btn-group" data-toggle="buttons">        <label class="btn btn-default" ng-class="{ \'active\' : canvastool === \'tooldraw\' }">            <input type="radio" value="tooldraw" name="drawtooloptions" ng-model="canvastool"> Draw        </label>        <label class="btn btn-default" ng-class="{ \'active\' : canvastool === \'toolerase\' }">            <input type="radio" value="toolerase" name="drawtooloptions" ng-model="canvastool"> Erase        </label>    </div>    <div class="btn btn-default" ng-click="reset()">Reset</div> </div></div>',restrict:"E",link:function(t,e,n,r,a){t.canvastool="tooldraw";var o=0,i=0,s=0,c=0,l=(t.canvas=e.find("canvas")[0],t.canvas.getContext("2d"));t.handleMouseDown=function(e){s=o=e.offsetX,c=i=e.offsetY},t.handleMouseMove=function(e){o=e.offsetX,i=e.offsetY,(void 0!==(e=e).buttons?1===e.buttons:1===e.which)&&(l.beginPath(),l.globalCompositeOperation="source-over","tooldraw"==t.canvastool?(l.strokeStyle="black",l.lineWidth=5):(l.strokeStyle="white",l.lineWidth=20),l.moveTo(s,c),l.lineTo(o,i),l.lineJoin=l.lineCap="round",l.stroke()),s=o,c=i},t.reset=function(){l.fillStyle="rgb(255,255,255)",l.fillRect(0,0,500,300)},t.reset()}}}),angular.module("app").directive("mldatatable",function(){return{restrict:"E",scope:{project:"=",training:"=",mode:"=",setMode:"=",onDeleteItem:"="},controller:["$scope",function(n){n.sortCol="id",n.sort=function(e,t){n.sortCol=("desc"===t?"-":"")+e},n.isOutputColumn=function(e){return e.output}}],templateUrl:"static/components/mldatatable/mldatatable.html"}}),function(){function e(e,t,n,r,a){var o=this;o.authService=e,a.projectId=r.projectId,a.userId=r.userId,a.makes={scratch:!0,python:!0,edublocks:!1},e.getProfileDeferred().then(function(e){return o.profile=e,n.debug("[ml4kproj] getting project info"),t.getProject(a.projectId,a.userId,e.tenant)}).then(function(e){a.project=e,a.makes=t.supportedMakes(e)}).catch(function(e){a.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("ProjectController",e),e.$inject=["authService","projectsService","loggerService","$stateParams","$scope"]}(),angular.module("app").directive("mlsoundvis",function(){return{template:'<canvas width="150" height="100"></canvas>',restrict:"E",scope:{spectogram:"<",modelinfo:"<",datatype:"<"},link:function(e,t,n,r,a){if("sounds"===e.datatype){for(var o=1/0,i=-1/0,s=0;s<e.spectogram.length;s++){var c=e.spectogram[s];-1/0<c&&(o=Math.min(c,o),i=Math.max(c,i))}if(i<=o)console.log("Invalid data range supplied");else for(var l=t[0].firstChild,u=l.getContext("2d"),d=(u.clearRect(0,0,l.width,l.height),e.modelinfo.fftSize),S=e.spectogram.length/d,E=l.width/S,g=l.height/d,s=0;s<S;++s){var T=E*s,p=e.spectogram.slice(s*d,(s+1)*d);if(p[0]>-1/0)for(var m=0;m<d;++m){var f=l.height-(m+1)*g,O=(p[m]-o)/(i-o),O=Math.pow(O,3);O=Math.round(255*O),u.fillStyle="rgb("+(255-O)+","+(255-O)+","+O+")",u.fillRect(T,f,E,g)}}}}}}),function(){function e(e,r,o,a,i,s,c,l,u,d,t,n,S,E,g,T,p,m,f,O,R,h){var A=this,I=(A.authService=e,18e4),H={code:"ERR",message:"Something went wrong",incidences:0,firstseen:(new Date).getTime()};function N(e){var t,n=(new Date).getTime()-I,r=!!e.code&&e.code===H.code,a=!e.code&&e.message===H.message,n=H.firstseen>n;(r||a)&&n?H.incidences+=1:H={code:e.code,message:e.message,incidences:1,firstseen:(new Date).getTime()},3<H.incidences&&(t=H.code,T.show({controller:["$scope",function(e){e.code=t,e.hide=function(){T.hide()}}],templateUrl:"static/components/models/errordetail.tmpl.html"}).then(function(){},function(){}),H={code:"ERR",message:"Something went wrong",incidences:0,firstseen:(new Date).getTime()})}var y=1;function v(e,t,n){h.error("[ml4kmodels] displaying alert",n),n?(h.error(n),500===t&&Sentry&&Sentry.captureException&&Sentry.captureException({error:n,errortype:typeof n,projectid:g.projectId})):n={};var r=y++,n={code:n.code,alertid:r,message:n.message||n.error||"Unknown error",status:t};return A[e].push(n),N(n),r}A.errors=[],A.warnings=[],A.dismissAlert=function(e,t){A[e].splice(t,1)},g.loading=!0,g.status="unknown",g.projectId=E.projectId,g.userId=E.userId,g.projecturls={train:"/#!/mlproject/"+E.userId+"/"+E.projectId+"/training"},g.owner=!0,g.minimumExamples="five",g.testformData={},e.getProfileDeferred().then(function(e){return A.profile=e,r.getProject(g.projectId,g.userId,A.profile.tenant)}).then(function(e){return g.project=e,f.all({labels:r.getLabels(g.project,g.userId,A.profile.tenant),models:o.getModels(e,g.userId,A.profile.tenant)})}).then(function(e){g.owner=A.profile.user_id===g.project.userid,g.projecturls.train="/#!/mlproject/"+g.project.userid+"/"+g.project.id+"/training","sounds"===g.project.type&&(g.minimumExamples="eight"),g.models=e.models,"regression"===g.project.type?(g.minimumExamples="ten",0===(t=(g.project.columns||[{label:"something",output:!0}]).filter(e=>e.output).map(e=>e.label)).length?g.projectSummary="something":g.projectSummary=u.generateProjectSummary(t," and ")):g.projectSummary=u.generateProjectSummary(g.project.labels," or ");var t=u.reviewTrainingData(e.labels,g.project.type);if(g.trainingcounts=t.counts,g.trainingdatastatus=t.status,g.status=u.getStatus(g.models),h.debug("[ml4kmodels] project status",g.status),"numbers"===g.project.type)return r.getFields(g.project,g.userId,A.profile.tenant).then(function(e){return g.project.fields=e,l.initNumberSupport(g.project)}).then(function(e){e&&D()});if("sounds"===g.project.type)return g.listening=!1,i.initSoundSupport(g.project.id,g.project.labels,!0).then(function(e){e&&(e.loaded&&D(),e.warning)&&v("warnings",500,e.warning)});if("imgtfjs"===g.project.type){if(0<g.project.labels.length)return s.initImageSupport(g.project.id,g.project.labels).then(function(e){return e&&D(),h.debug("[ml4kmodels] fetching image project dependencies"),d.loadImageProjectSupport()})}else if("regression"===g.project.type)return g.project.labels=["input","output"],c.initRegressionSupport(g.project).then(function(e){e&&D()})}).then(function(){t.getItem("testdata://"+g.project.id)&&(g.project.hasTestData=!0),g.loading=!1}).catch(function(e){e=v("errors",e.status,e.data||e);k("errors"+e)});var b=null;function L(){h.debug("[ml4kmodels] stop refreshing models"),b&&(m.cancel(b),b=null)}function U(){h.debug("[ml4kmodels] refresh models"),b=b||m(function(){D().then(function(){"training"!==g.status&&L()})},"sounds"===g.project.type||"imgtfjs"===g.project.type||"regression"===g.project.type?2e3:"text"===g.project.type?2e4:"numbers"===g.project.type?8e3:(h.error("[ml4kmodels] Unexpected project type"),6e4))}function D(){return h.debug("[ml4kmodels] fetching model info"),("imgtfjs"===g.project.type?s.getModels():"sounds"===g.project.type?i.getModels():"regression"===g.project.type?c.getModels():"numbers"===g.project.type?l.getModels():o.getModels(g.project,g.userId,A.profile.tenant)).then(function(e){h.debug("[ml4kmodels] models info",e),g.models=e,g.status=u.getStatus(g.models),h.debug("[ml4kmodels] model status",g.status)})}function K(){delete g.testoutput,delete g.testoutput_explanation}function W(e){h.debug("[ml4kmodels] prediction",e),p(function(){e&&0<e.length?"regression"===g.project.type?g.testoutput=e[0]:(g.testoutput=e[0].class_name,g.testoutput_explanation="with "+Math.round(e[0].confidence)+"% confidence"):(g.testoutput="Unknown",g.testoutput_explanation="Test value could not be recognised")},0)}function C(e){h.error("[ml4kmodels] model test failed",e),delete g.testoutput;e=v("errors",e.status,e.data);k("errors"+e)}function k(t){p(function(){var e=document.getElementById(t);O.duScrollToElementAnimated(angular.element(e))},0)}function k(n,r){g.$applyAsync(function(){var e,t=document.getElementById(n.toString());t?(e=t.parentElement,angular.element(e).duScrollToElementAnimated(angular.element(t))):r?h.error("[ml4kmodels] unable to scroll to new item",n):p(function(){k(n,!0)},0)})}A.checkQuizAnswers=function(e){p(function(){g.answered=!0,g.answerCorrect=!e.answers.some(function(e){return e.selected!==e.correct}),!1===g.answerCorrect&&e.answers.forEach(function(e){e.selected=e.correct})},0)},A.nextQuizQuestion=function(){g.answered=!1;var e=g.quizQuestion;g.quizQuestion=a.getQuestion(),!1===g.answerCorrect&&a.restoreQuestion(e)},A.createModel=function(e,t){var n;h.debug("[ml4kmodels] creating model"),g.quizQuestion=a.getQuestion(),g.submittingTrainingRequest=!0,K(),("imgtfjs"===g.project.type?s.newModel(t.id,g.userId,A.profile.tenant):"sounds"===g.project.type?i.newModel(t.id,g.userId,A.profile.tenant):"numbers"===g.project.type?l.newModel(t,g.userId,A.profile.tenant):"text"===g.project.type?"local"===(n=t).storage?n.cloudid?o.newLocalProjectTextModel(n):r.createLocalProject(n,g.userId,A.profile.tenant).then(function(e){return g.project=e,o.newLocalProjectTextModel(e)}):o.newModel(n.id,g.userId,A.profile.tenant):c.newModel(t)).then(function(e){if(h.debug("[ml4kmodels] model training",e),g.models=[e],g.status=u.getStatus(g.models),h.debug("[ml4kmodels] initial status",g.status),U(),g.submittingTrainingRequest=!1,e.error)throw e.error}).catch(function(e){var t,n;h.error("[ml4kmodels] model training failed",e),g.submittingTrainingRequest=!1,(n=e)&&409===n.status&&n.data&&n.data.code&&("MLMOD12"===n.data.code||"MLMOD13"===n.data.code||"MLMOD14"===n.data.code)&&n.data.location&&n.data.location.imageid&&n.data.location.url&&"download"===n.data.location.type?(t=e,T.show({controller:["$scope",function(e){e.location=t.data.location,d.isGoogleFilesUrl(t.data.location.url)?(e.errordetails="Google has removed access to this image at this URL.",e.recommendation="You should delete this image from your training."):(e.errordetails="This might be a temporary problem, so you could try again if you like.",e.recommendation="But if it keeps happening, and is stopping you from training a machine learning model, you could delete this image from your training data and carry on without it."),e.hide=function(){T.hide()},e.cancel=function(){T.cancel()},e.confirm=function(){T.hide(t.data.location)}}],templateUrl:"static/components/models/downloadfail.tmpl.html"}).then(function(e){e&&o.deleteTrainingData(g.project.id,g.userId,A.profile.tenant,e.imageid).then(function(){R.reload()}).catch(function(e){e=v("errors",e.status,e.data);k("errors"+e)})},function(){})):(n=v("errors",e.status,e.data),k("errors"+n))})},A.testModel=function(e,t,n){h.debug("[ml4kmodels] testing model");var r,a={type:n.type};if("text"===n.type)a.text=g.testformData.testquestion;else if("imgtfjs"===n.type){if(a.image=g.testformData.testimageurl,a.image&&("data:image"===a.image.substring(0,10)||"blob:"===a.image.substring(0,5)))return r=v("errors",400,{message:"Invalid URL. Please enter the web address for a picture that you want to test your machine learning model on"}),k("errors"+r);try{a.image=new URL(a.image).toString()}catch(e){h.debug("[ml4kmodels] unable to escape URL characters, using raw string",e)}}else if("numbers"===n.type)n.fields.map(function(e){var t;"number"===e.type&&("number"==typeof(t=g.testformData[e.name])?g.testformData[e.name]=t:t.includes(".")?g.testformData[e.name]=parseFloat(t):g.testformData[e.name]=parseInt(t))});else if("regression"===n.type)a.regression={},n.columns.filter(function(e){return!e.output}).forEach(function(e){"number"===e.type&&(a.regression[e.label]=parseFloat(g.testformData[e.label]))});else if("sounds"===n.type)return;g.testoutput="please wait...",g.testoutput_explanation="",h.debug("[ml4kmodels] submitting model test",a),("imgtfjs"===n.type?o.testModelPrep(n.id,g.userId,A.profile.tenant,g.models[0].classifierid,a).then(function(e){return s.testBase64ImageData(e)}):"regression"===n.type?c.testModel(n,a.regression):"numbers"===n.type?l.testModel(n,g.testformData):o.testModel(n,g.userId,A.profile.tenant,g.models[0].classifierid,g.models[0].credentialsid,a)).then(W).catch(C)},A.deleteModel=function(e,t,n){h.debug("[ml4kmodels] deleting model"),g.submittingDeleteRequest=!0,K(),("imgtfjs"===t.type?s.deleteModel(t.id):"sounds"===t.type?i.deleteModel(t.id):"regression"===t.type?c.deleteModel(t.id):"numbers"===t.type?l.deleteModel(t.id):(n=n.classifierid,o.deleteModel(t,g.userId,A.profile.tenant,n))).then(function(){g.models=[],g.status=u.getStatus(g.models),("training"===g.status||"numbers"===t.type||"imgtfjs"===t.type||"sounds"===t.type||"regression"===t.type?U:L)(),g.submittingDeleteRequest=!1}).catch(function(e){if(h.error("[ml4kmodels] failed to delete model",e),g.submittingDeleteRequest=!1,404===e.status&&e.data&&"Not found"===e.data.error)return R.reload();e=v("errors",e.status,e.data);k("errors"+e)})},A.testUsingCanvas=function(e){h.debug("[ml4kmodels] testUsingCanvas"),g.testformData.testimageurl="",g.testoutput="please wait...",g.testoutput_explanation="",T.show({controller:["$scope",function(e){e.hide=function(){T.hide()},e.cancel=function(){T.cancel()},e.confirm=function(){T.hide(S.resizeImageElement(e.canvas))}}],templateUrl:"static/components/models/canvas.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){g.testoutput="please wait...",g.testoutput_explanation="",s.testCanvas(e).then(W).catch(C)},function(){K()})},A.testUsingWebcam=function(e){h.debug("[ml4kmodels] testUsingWebcam"),g.testformData.testimageurl="",T.show({controller:["$scope",function(n){function r(e){h.error("[ml4kmodels] display webcam error",e),(n.webcamerror=e)&&e.message&&("NotAllowedError"===e.name?n.webcamerrordetail="Not allowed to use the web-cam":n.webcamerrordetail=e.message)}n.channel={},n.webcamerror=!1,n.webcamInitComplete=!1,n.webcamCanvas=null,n.hide=function(){T.hide()},n.cancel=function(){T.cancel()},n.confirm=function(){T.hide(S.resizeImageElement(n.channel.video))},n.onWebcamSuccess=function(){n.$apply(function(){n.webcamInitComplete=!0})},n.onWebcamError=function(t){h.error("[ml4kmodels] on webcam error",t),n.webcamInitComplete=!0;try{n.$apply(function(){r(t)})}catch(e){p(function(){r(t)},0,!1)}}}],templateUrl:"static/components/models/webcam.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){g.testoutput="please wait...",g.testoutput_explanation="",s.testCanvas(e).then(W).catch(C)},function(){K()})},A.startListening=function(){h.debug("[ml4kmodels] start listening"),g.listening||(g.listening=!0,i.startTest(function(e){h.debug("[ml4kmodels] sound test callback",e),g.$apply(function(){g.testoutput=e[0].class_name,g.testoutput_explanation="with "+Math.round(e[0].confidence)+"% confidence"})}))},A.stopListening=function(){h.debug("[ml4kmodels] stop listening"),g.listening&&(g.listening=!1,i.stopTest().then(function(){h.debug("[ml4kmodels] stop test callback"),g.$apply(K)}).catch(function(e){h.error("[ml4kmodels] Failed to stop listening",e)}))},A.addConfirmedTrainingData=function(e){g.testformData.testimageurl=e},A.addImageFile=function(e){S.getDataFromFile(e).then(s.testBase64ImageData).then(W).catch(C)},A.downloadTestData=function(e){e.stopPropagation(),e.preventDefault();e=t.getItem("testdata://"+g.project.id);n.downloadFile([function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}(e)],"text/csv","testdata-"+g.project.id+".csv")},g.$on("$destroy",function(){h.debug("[ml4kmodels] handling page change"),L(),g.project&&"sounds"===g.project.type?(g.listening&&i.stopTest().catch(function(e){h.debug("[ml4kmodels] Failed to stop listening when cleaning up the page",e)}),i.reset()):g.project&&"imgtfjs"===g.project.type&&s.reset()}),g.getController=function(){return A}}angular.module("app").controller("ModelsController",e),e.$inject=["authService","projectsService","trainingService","quizService","soundTrainingService","imageTrainingService","regressionTrainingService","numberTrainingService","modelService","utilService","storageService","downloadService","imageToolsService","$stateParams","$scope","$mdDialog","$timeout","$interval","$q","$document","$state","loggerService"]}(),function(){function e(o,a,i){function s(e,t){return"indexeddb://ml4k-models-"+e+"-"+t.toString().replace(/-/g,"")}function c(e,t,n){o.debug("[ml4kmodels] deleting supporting model data");try{a.removeItem(e)}catch(e){o.error("[ml4kmodels] Failed to clear model timestamp")}return"numbers"===t&&(a.removeItem("ml4k-models-numbers-"+n+"-features"),a.removeItem("ml4k-models-numbers-"+n+"-labels"),a.removeItem("ml4k-models-numbers-"+n+"-status")),Promise.resolve()}return{sortByConfidence:function(e,t){return e.confidence<t.confidence?1:e.confidence>t.confidence?-1:0},getStatus:function(e){var t;return(t=e)&&0<t.length&&!t.some(function(e){return"Training"!==e.status})?"training":(t=e)&&0<t.length&&!t.some(function(e){return"Available"!==e.status})?"ready":0===e.length?"idle":"error"},generateProjectSummary:function(e,t){if(0<e.length){var n="";switch(e.length){case 1:n=e[0];break;case 2:n=e[0]+t+e[1];break;case 3:n=e[0]+", "+e[1]+t+e[2];break;default:n=e[0]+", "+e[1]+t+(e.length-2)+" other classes"}return n}},reviewTrainingData:function(n,e){var r=!0,a=0,o="sounds"===e?8:5,t=(i=Object.keys(n)).map(function(e){var t=n[e];return 0<t&&(r=!1),t<o&&(a+=1),{label:e,count:t}}),i=r?"no_data":"regression"===e?n.data<10?"insufficient_data":0<n.outputcolumns?"data":"no_output_columns":1<a||a===i.length||i.length<2||"sounds"===e&&0<a?"insufficient_data":"data";return{counts:t,status:i}},saveModel:function(e,t,n){o.debug("[ml4kmodels] saving model to browser storage");var r=s(e,t);return n.save(r).then(function(e){o.debug("[ml4kmodels] saved model",r,e);e=r;try{a.setItem(e,Date.now())}catch(e){o.error("[ml4kmodels] Failed to store model timestamp")}}).catch(function(e){o.error("[ml4kmodels] failed to save model",e)})},loadModel:function(e,t,n){o.debug("[ml4kmodels] loading model from browser storage");var r=s(e,t);return(t=n?n.load(r):"numbers"===e?tf.loadGraphModel(r):tf.loadLayersModel(r)).then(function(e){return{output:e,timestamp:function(e){try{var t=a.getItem(e);if(t)return new Date(parseInt(t))}catch(e){o.error("[ml4kmodels] Failed to get metadata")}return new Date}(r)}}).catch(function(e){o.debug("[ml4kmodels] Failed to load model",e)})},deleteModel:function e(t,n,r){o.debug("[ml4kmodels] deleting stored model",n);var a=s(t,n);return"undefined"!=typeof tf?tf.io.removeModel(a).then(function(){return c(a,t,n)}).catch(function(e){o.debug("[ml4kmodels] model could not be deleted",e)}):r?(o.debug("[ml4kmodels] tensorflow not loaded - skipping model deletion"),c(a,t,n)):i.loadTensorFlow().then(function(){return e(t,n,!0)})},isModelSavedInBrowser:function(e,t){try{var n=s("imgtfjs"===e?"images":e,t);if(a.getItem(n))return!0}catch(e){o.error("[ml4kmodels] Failed to get metadata")}return!1}}}angular.module("app").service("modelService",e),e.$inject=["loggerService","storageService","utilService"]}(),function(){function e(e,t,n,r,a,o,i,s){var c=this,l=(c.authService=e,i.creating=!1,"You have reached the limit for the number of projects you can have. You need to delete one of your current projects before you can create another."),u='Sorry! You can only create one project at a time if you use "Try it now". You need to delete your current project before you can create another.';switch(s(["NEWPROJECT.ERRORS.EXCEEDLIMIT","NEWPROJECT.ERRORS.TRYITNOW"]).then(function(e){l=e["NEWPROJECT.ERRORS.EXCEEDLIMIT"],u=e["NEWPROJECT.ERRORS.TRYITNOW"]}).catch(function(e){r.error("[ml4kproj] Failed to get translated error messages",e)}),s.use()){case"en":case"ar":case"cs":case"zh-cn":case"zh-tw":case"de":case"fr":case"it":case"ja":case"ko":case"pt-br":case"es":i.language=s.use();break;case"nl-be":i.language="nl";break;default:i.language="xx"}c.fields=[],c.focused=o.isTeacher?"crowdsourced":"name";var d=1;function S(e,t,n){c[e].push({alertid:d++,message:(n=n||{}).message||n.error||"Unknown error",status:t})}c.errors=[],c.warnings=[],c.dismissAlert=function(e,t){c[e].splice(t,1)};var E=1,g=9,T=(e.getProfileDeferred().then(function(e){c.profile=e}).catch(function(e){S("errors",e.status,e.data)}),/^[^0-9\-.,][^,]*$/);i.isInvalid=function(e){if("numbers"===e){if(c.fields.length<1||10<c.fields.length)return!0;for(var t=0;t<c.fields.length;t++)if("multichoice"===c.fields[t].type){if(c.fields[t].choices.length<2||5<c.fields[t].choices.length)return!0;if(c.fields[t].choices.some(function(e){return!1===T.test(e)||e.length>g||e.length<E}))return!0}}return!1},c.addFieldChoice=function(e,t){if(e){e=e.trim();if(0<e.length&&e.length<=g&&-1===t.choices.indexOf(e))return t.choices.push(e),!0}return!1},c.confirm=function(e){i.creating=!0,"numbers"===e.type?e.fields=e.fields.map(e=>{var t={name:e.name,type:e.type};return"multichoice"===e.type&&(t.choices=e.choices),t}):delete e.fields,"regression"===e.type&&"cloud"===e.storage?(S("errors",400,{message:"Projects for predicting numbers cannot be stored in the cloud"}),i.creating=!1):(r.debug("[ml4kproj] Creating new project",e),t.createProject(e,c.profile.user_id,c.profile.tenant).then(function(e){r.debug("[ml4kproj] Created project",e),a.go("projects",{id:e.id})}).catch(function(e){r.error("[ml4kproj] Failed to create project",e),409===e.status&&"User already has maximum number of projects"===e.data.error&&("session-users"===c.profile.tenant?e.data.message=u:e.data.message=l),S("errors",e.status,e.data),i.creating=!1}))},n.isSupported().then(function(e){i.isLocalSupported=1===e,r.debug("[ml4kproj] Local projects support",i.isLocalSupported)})}angular.module("app").controller("NewProjectController",e),e.$inject=["authService","projectsService","browserStorageService","loggerService","$state","$rootScope","$scope","$translate"]}(),function(){function e(o,r,n,a,t,i,e,s){const c="numbers";let l,u,d;function S(n){return o.loadModel(c,n.id).then(e=>{if(e)return u={classifierid:n.id,status:"Loading",progress:0,updated:e.timestamp},tfdf.loadTFDFModel({loadModel:()=>e.output.artifacts,loadAssets:()=>a.retrieveAsset(n.id+"-assets")});throw new Error("Graph model not found")}).then(e=>{var t=n;return t=t.id,d={key:t,features:T("ml4k-models-numbers-"+t+"-features"),labels:T("ml4k-models-numbers-"+t+"-labels")},l=e,u.status="Available",u.progress=100,!0}).catch(function(e){i.debug("[ml4knums] failed to load model",e)})}function E(e){var t;(d=e).lastupdate=new Date(e.lastupdate),u.updated=d.lastupdate,u.lastPollTime=new Date,"Available"===e.status?(u.progress=66,t=e,i.debug("[ml4knums] loading tfdf model",t.urls.model),tfdf.loadTFDFModel(t.urls.model).then(e=>(l=e,i.debug("[ml4knums] downloading visualisation"),a.storeAsset(u.classifierid+"-tree",t.urls.tree).then(()=>a.storeAsset(u.classifierid+"-dot",t.urls.dot)).then(()=>a.storeAsset(u.classifierid+"-vocab",t.urls.vocab)).catch(e=>{i.error("[ml4knums] failed to download visualisation",e)}))).then(()=>(i.debug("[ml4knums] downloading model assets"),a.storeAsset(u.classifierid+"-assets",l.assets))).then(()=>(i.debug("[ml4knums] saving graph model"),o.saveModel(c,u.classifierid,l.graphModel))).then(()=>{var e;i.debug("[ml4knums] storing model metadata",t),u.status="Available",e=t,n.setItem("ml4k-models-numbers-"+u.classifierid+"-features",JSON.stringify(e.features)),n.setItem("ml4k-models-numbers-"+u.classifierid+"-labels",JSON.stringify(e.labels)),n.setItem("ml4k-models-numbers-"+u.classifierid+"-status",e.urls.status)}).catch(e=>{i.error("[ml4knums] failed to store model",e),u&&(e.message&&e.message.includes("BlobURLs are not yet supported")?(u.status="Available",u.warning="Not stored"):u.status="Failed")})):"Failed"===e.status&&(i.error("[ml4knums] model failed",e),u.status=e.status)}function g(e){return l=null,u=null,d=null,o.deleteModel(c,e).then(()=>a.deleteAsset(e+"-assets")).then(()=>a.deleteAsset(e+"-tree")).then(()=>a.deleteAsset(e+"-dot")).then(()=>a.deleteAsset(e+"-vocab")).catch(e=>{i.error("[ml4knums] failed to delete model data",e)})}function T(e){var t=n.getItem(e);if(t)return JSON.parse(t);throw new Error("Missing data "+e)}return{initNumberSupport:function(e){return i.debug("[ml4knums] initialising number model support",e.id),i.debug("[ml4knums] loading tensorflow"),t.loadTensorFlow().then(function(){return t.loadNumberProjectSupport()}).then(function(){i.debug("[ml4knums] enabling tf prod mode"),tf&&tf.enableProdMode&&(tf.enableProdMode(),i.debug("[ml4knums] tfjs version",tf.version))}).catch(function(e){throw i.error("[ml4knums] failed to load tensorflow",e),e}).then(function(){return S(e)})},getModels:function(){return i.debug("[ml4knums] get models"),d&&"Training"===d.status&&33===u.progress?s.get(d.urls.status).then(e=>{return E(e.data),[u]}):e(function(e){u?(u.lastPollTime=new Date,e([u])):e([])})},newModel:function(e,t,n){return i.debug("[ml4knums] creating new ML model",e.id),i.debug("[ml4knums] tf backend",tf.getBackend()),i.debug("[ml4knums] tf precision",tf.ENV.getBool("WEBGL_RENDER_FLOAT32_ENABLED")),g(e.id).then(()=>(u={classifierid:e.id,status:"Training",progress:0,updated:new Date},"local"===e.storage?r.newLocalProjectNumbersModel(e):r.newModel(e.id,t,n))).then(e=>(i.debug("[ml4knums] model info",e),d=e,u.status=e.status,u.progress=33,u.updated=new Date,u))},deleteModel:g,testModel:function(e,t){i.debug("[ml4knums] testing model",t);var n={};for(const a of Object.keys(t)){var r=d.features[a];r&&(r.type.includes("int")?n[r.name]=tf.tensor([t[a]]).toInt():n[r.name]=tf.tensor([t[a]]))}return l.executeAsync(n).then(e=>e.data()).then(n=>{if(2===d.labels.length)return[{class_name:d.labels[0],confidence:100*(1-n[0])},{class_name:d.labels[1],confidence:100*n[0]}].sort(o.sortByConfidence);var e;if(d.labels.length===n.length/2)return e=d.labels.map((e,t)=>({class_name:e,confidence:100*n[t+d.labels.length]})).sort(o.sortByConfidence),i.debug("[ml4knums] model response",e),e;throw i.error("[ml4knums] unexpected model response",n),new Error("Unexpected response")})}}}angular.module("app").service("numberTrainingService",e),e.$inject=["modelService","trainingService","storageService","browserStorageService","utilService","loggerService","$q","$http"]}(),function(){function e(t,r,a,e,o){var i=e.protocol()+"://"+e.host();e.port()&&(i=i+":"+e.port()),this.openTensorFlowDialog=function(e){a.show({controller:["$scope",function(n){n.siteurl=i,n.modeljson="",n.scratchkey=":scratchkey",n.modeltypeid=10,n.validating=!1,n.hide=function(){a.hide()},n.cancel=function(){a.cancel()},n.confirm=function(){n.validating=!0,t.newTfjsExtension({modelurl:n.modeljson,modeltype:10===n.modeltypeid?"teachablemachineimage":"graphdefimage"}).then(function(e){o.open("https://machinelearningforkids.co.uk/scratch/?url="+i+e.url,"_blank"),n.validating=!1,a.hide()}).catch(function(e){r.debug("[ml4kpretrn] Model not found",e),n.error=!0,n.validating=!1})},n.generateScratchKey=function(e,t){n.error=!1,n.scratchkey=encodeURIComponent(JSON.stringify({modelurl:e,modeltypeid:t}))}}],templateUrl:"static/components/pretrained/tfjs.tmpl.html",targetEvent:e,clickOutsideToClose:!0})}}angular.module("app").controller("PretrainedController",e),e.$inject=["scratchService","loggerService","$mdDialog","$location","$window"]}(),function(){function e(e,i,s,n,t,r,a,o,c,l){var u=this,d=(u.authService=e,u.highlightId=t.id,1);function S(e,t,n){u[e].push({alertid:d++,message:(n=n||{}).message||n.error||"Unknown error",status:t})}u.errors=[],u.warnings=[],u.dismissAlert=function(e,t){u[e].splice(t,1)};var E={};function g(e){l.debug("[ml4kprojects] display api key check",e),E["NEWPROJECT.WARNINGS."+e.code]&&S("warnings",409,{message:E["NEWPROJECT.WARNINGS."+e.code]})}function T(o){l.debug("[ml4kprojects] Refreshing projects list"),i.getProjects(o).then(function(e){l.debug("[ml4kprojects] Got projects list"),u.projects=e;for(var t=0;t<u.projects.length;t++){var n,r,a=u.projects[t];"regression"===a.type?(r=(n=a.columns||[]).filter(e=>e.output).map(e=>e.label),a.labelsSummary=s.generateProjectSummary(r," and ")||"something",0<(n=n.length-r.length)&&(a.columnsSummary=" from "+n+" input values")):(r="sounds"===a.type?a.labels.filter(function(e){return"_background_noise_"!==e}):a.labels,a.labelsSummary=s.generateProjectSummary(r," or ")),u.highlightId===a.id&&!function(e,t){"session-users"!==e.tenant&&"text"===t.type&&(t.isPlaceholder=!0,l.debug("[ml4kprojects] Checking class API keys"),i.checkProjectCredentials(e.tenant,t.type).then(function(e){l.debug("[ml4kprojects] API keys checked"),t.isPlaceholder=!1,g(e)}).catch(function(e){l.error("[ml4kprojects] Failed to check API keys",e),t.isPlaceholder=!1,g(e)}))}(o,a)}}).catch(function(e){l.error("[ml4kprojects] Failed to refresh projects list",e),S("errors",e.status,e.data)})}r(["NEWPROJECT.WARNINGS.MLCRED-TEXT-NOKEYS","NEWPROJECT.WARNINGS.MLCRED-TEXT-INVALID","PROJECTS.WHOLE_CLASS_TITLE","PROJECTS.WHOLE_CLASS_NOTES","PROJECTS.CLOUD_STORAGE_TITLE","PROJECTS.CLOUD_STORAGE_NOTES","PROJECTS.LOCAL_STORAGE_TITLE","PROJECTS.LOCAL_STORAGE_NOTES","HELP.PROJECTS.Q5"]).then(function(e){E=e}),e.getProfileDeferred().then(function(e){T(u.profile=e)}).catch(function(e){S("errors",e.status,e.data)}),u.deleteProject=function(e,t){l.debug("[ml4kprojects] Deleting project");e=a.confirm().title("Are you sure?").textContent("Do you want to delete "+t.name+"? (This cannot be undone)").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");a.show(e).then(function(){t.isPlaceholder=!0,l.debug("[ml4kprojects] Submitting project delete request"),i.deleteProject(t,u.profile.user_id,u.profile.tenant).then(function(){l.debug("[ml4kprojects] Project deleted");var e=function(e){for(var t=u.projects.length,n=0;n<t;n++)if(u.projects[n].id===e)return n;return-1}(t.id);-1!==e?u.projects.splice(e,1):T(u.profile),c.deleteProject(t),"numbers"===t.type&&(n.deleteAsset(t.id+"-assets"),n.deleteAsset(t.id+"-tree"),n.deleteAsset(t.id+"-dot"),n.deleteAsset(t.id+"-vocab")),"local"===t.storage&&o.$apply()}).catch(function(e){l.error("[ml4kprojects] Failed to delete project",e),S("errors",e.status,e.data)})},function(){})},u.shareProject=function(e,t,n){l.debug("[ml4kprojects] Setting project share flag"),t.isPlaceholder=!0,i.shareProject(t,u.profile.user_id,u.profile.tenant,n).then(function(e){l.debug("[ml4kprojects] Project share status updated"),t.isCrowdSourced=e,t.isPlaceholder=!1}).catch(function(e){l.error("[ml4kprojects] Failed to share project",e),t.isPlaceholder=!1,S("errors",e.status,e.data)})},u.displayCrowdSourcedInfo=function(e){e.stopPropagation(),e.preventDefault(),a.show(a.alert().clickOutsideToClose(!0).title(E["PROJECTS.WHOLE_CLASS_TITLE"]).textContent(E["PROJECTS.WHOLE_CLASS_NOTES"]).ariaLabel(E["PROJECTS.WHOLE_CLASS_TITLE"]).ok("OK").targetEvent(e))},u.displayProjectTypeInfo=function(e,t){e.stopPropagation(),e.preventDefault();let n,r='<p>(See "<a href="/help">'+E["HELP.PROJECTS.Q5"]+'</a>")</p>';r="local"===t?(n=E["PROJECTS.LOCAL_STORAGE_TITLE"],"<div><p>"+E["PROJECTS.LOCAL_STORAGE_NOTES"]+"</p>"+r+"</div>"):(n=E["PROJECTS.CLOUD_STORAGE_TITLE"],"<div><p>"+E["PROJECTS.CLOUD_STORAGE_NOTES"]+"</p>"+r+"</div>"),a.show(a.alert().clickOutsideToClose(!0).title(n).htmlContent(r).ariaLabel(n).ok("OK").targetEvent(e))}}angular.module("app").controller("ProjectsController",e),e.$inject=["authService","projectsService","modelService","browserStorageService","$stateParams","$translate","$mdDialog","$scope","cleanupService","loggerService"]}(),function(){function e(a,t,o){function i(e,t){return"text"===e.type&&e.cloudid?(n=e,r=t,a.put("/api/classes/"+n.classid+"/students/"+n.userid+"/localprojects/"+n.cloudid,{labels:r}).then(function(e){return e.data.labels}).catch(function(e){return 404===e.status&&(o.addCloudRefToProject(n.id,null),delete n.cloudid),r})):Promise.resolve(t);var n,r}return{getProject:function(e,t,n){return o.idIsLocal(e)?o.getProject(e):a.get("/api/classes/"+n+"/students/"+t+"/projects/"+e).then(function(e){return e.data})},getProjects:function(e){return t.all({cloud:a.get("/api/classes/"+e.tenant+"/students/"+e.user_id+"/projects"),local:o.getProjects(e.user_id)}).then(function(e){return e.cloud.data.concat(e.local)})},getClassProjects:function(e){return a.get("/api/classes/"+e.tenant+"/projects").then(function(e){return e.data})},deleteProject:function(e,t,n){return"local"===e.storage?("text"===e.type&&e.cloudid&&a.delete("/api/classes/"+n+"/students/"+t+"/localprojects/"+e.cloudid),o.deleteProject(e.id)):a.delete("/api/classes/"+n+"/students/"+t+"/projects/"+e.id)},createProject:function(e,t,n){return"local"===e.storage?(e.userid=t,e.classid=n,o.addProject(e)):a.post("/api/classes/"+n+"/students/"+t+"/projects",e).then(function(e){return e.data})},createLocalProject:function(t,e,n){return a.post("/api/classes/"+n+"/students/"+e+"/localprojects",t).then(function(e){e=e.data;return o.addCloudRefToProject(t.id,e.id)})},getFields:function(e,t,n){return"local"===e.storage?Promise.resolve(e.fields):a.get("/api/classes/"+n+"/students/"+t+"/projects/"+e.id+"/fields").then(function(e){return e.data})},getLabels:function(n,e,t){return"local"===n.storage?"regression"===n.type?o.countTrainingData(n.id).then(function(e){let t=0;return{data:e,outputcolumns:t=n.columns?n.columns.filter(e=>e.output).length:t}}):o.getLabelCounts(n.id):a.get("/api/classes/"+t+"/students/"+e+"/projects/"+n.id+"/labels").then(function(e){return e.data})},addLabelToProject:function(t,e,n,r){return"local"===t.storage?o.addLabel(t.id,r).then(function(e){return i(t,e)}):a.patch("/api/classes/"+n+"/students/"+e+"/projects/"+t.id,[{op:"add",path:"/labels",value:r}]).then(function(e){return e.data})},removeLabelFromProject:function(t,e,n,r){return"local"===t.storage?o.deleteLabel(t.id,r).then(function(e){return i(t,e)}):a.patch("/api/classes/"+n+"/students/"+e+"/projects/"+t.id,[{op:"remove",path:"/labels",value:r}]).then(function(e){return e.data})},addMetadataToProject:function(e,t,n){return"local"===e.storage?o.addMetadataToProject(e.id,t,n):Promise.reject(new Error("Unexpected project type"))},checkProjectCredentials:function(e,t){return a.get("/api/classes/"+e+"/modelsupport/"+t).then(function(e){return e.data}).catch(function(e){return e.data})},shareProject:function(e,t,n,r){return a.patch("/api/classes/"+n+"/students/"+t+"/projects/"+e.id+"/iscrowdsourced",[{op:"replace",path:"/isCrowdSourced",value:r}]).then(function(){return r}).catch(function(e){if(409===e.status)return r;throw e})},supportedMakes:function(e){return"text"===e.type?{scratch:!0,edublocks:!0,python:!0,appinventor:!0,replit:!0}:"numbers"===e.type?{scratch:!0,edublocks:!1,python:!0,colab:!0}:"sounds"===e.type?{scratch:!0,edublocks:!1,python:!1}:"imgtfjs"===e.type?"local"===e.storage?{scratch:!0,edublocks:!1,python:!1}:{scratch:!0,edublocks:!1,python:!0,appinventor:!0}:"regression"===e.type?{scratch:!0,edublocks:!1,python:!1}:{scratch:!1,edublocks:!1,python:!1}}}}angular.module("app").service("projectsService",e),e.$inject=["$http","$q","browserStorageService"]}(),function(){function e(e,t,n,r,a){var o=this;o.authService=e,a.projectId=r.projectId,a.userId=r.userId,a.testdata={imagefile:"my-test-image.jpg",label:"label"},e.getProfileDeferred().then(function(e){return o.profile=e,t.getProject(a.projectId,a.userId,e.tenant)}).then(function(e){if((a.project=e)&&"imgtfjs"!==e.type)throw new Error("This page is intended for image projects only");return e.labels&&0<e.labels.length&&(a.testdata.label=e.labels[0]),n.getScratchKeys(a.project,a.userId,o.profile.tenant)}).then(function(e){e&&!a.scratchkey&&(a.scratchkey=e[0])}).catch(function(e){a.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("PythonImagesController",e),e.$inject=["authService","projectsService","scratchkeysService","$stateParams","$scope"]}(),function(){function e(e,t,n,r,a,o,i,s){var c=this;c.authService=e,s.projectId=i.projectId,s.userId=i.userId,s.loading=!0,s.modelSource=!1,s.expiredModel=!1,s.testdata={fields:[],label:"label"},s.trainingdata={fields:[],label:"label"};let l;e.getProfileDeferred().then(e=>(c.profile=e,t.getProject(s.projectId,s.userId,e.tenant))).then(e=>{if(e&&"numbers"!==e.type)throw new Error("This page is intended for numbers projects only");return(s.project=e).labels&&0<e.labels.length&&(s.testdata.label=e.labels[0],s.trainingdata.label=e.labels[0]),t.getFields(s.project,s.userId,c.profile.tenant)}).then(function(e){return s.fields=e,e=s.project,(l=n.getItem("ml4k-models-numbers-"+e.id+"-status"))?o.get(l).then(function(e){e&&e.data&&(s.modelSource=e.data.urls.status)}).catch(function(e){a.error("[ml4kpy] failed to get model info",e),e&&404===e.status&&e.config.url===l&&(s.expiredModel=!0)}):Promise.resolve()}).then(()=>{return"local"!==(e=s.project).storage?r.getScratchKeys(e,s.userId,c.profile.tenant).then(function(e){s.scratchkey=e[0].id}).catch(function(e){a.error("[ml4kpy] failed to get scratch key",e)}):Promise.resolve();var e}).then(()=>{s.loading=!1}).catch(e=>{s.failure={message:e.message||e.error||"Unknown error",status:e.status},s.loading=!1})}angular.module("app").controller("PythonNumbersController",e),e.$inject=["authService","projectsService","storageService","scratchkeysService","loggerService","$http","$stateParams","$scope"]}(),function(){function e(e,t,n,r,a){var o=this;o.authService=e,a.projectId=r.projectId,a.userId=r.userId,a.functionType="classify",a.testdata={text:"The text that you want to test",storetext:"The text that you want to store",label:"label"},a.setFunctionType=function(e){a.functionType=e},e.getProfileDeferred().then(function(e){return o.profile=e,t.getProject(a.projectId,a.userId,e.tenant)}).then(function(e){if(e&&"text"!==e.type)throw new Error("This page is intended for text projects only");return(a.project=e).labels&&0<e.labels.length&&(a.testdata.label=e.labels[0]),n.getScratchKeys(a.project,a.userId,o.profile.tenant)}).then(function(e){e&&!a.scratchkey&&(a.scratchkey=e[0],a.scratchkey.model||(a.functionType="store"))}).catch(function(e){a.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("PythonTextController",e),e.$inject=["authService","projectsService","scratchkeysService","$stateParams","$scope"]}(),function(){function e(e){var t=[];return e(["MODELS.QUIZ.QUESTION_1.QUESTION","MODELS.QUIZ.QUESTION_1.ANSWER_1","MODELS.QUIZ.QUESTION_1.ANSWER_2","MODELS.QUIZ.QUESTION_1.NOTES_1","MODELS.QUIZ.QUESTION_2.QUESTION","MODELS.QUIZ.QUESTION_2.ANSWER_1","MODELS.QUIZ.QUESTION_2.ANSWER_2","MODELS.QUIZ.QUESTION_2.ANSWER_3","MODELS.QUIZ.QUESTION_2.ANSWER_4","MODELS.QUIZ.QUESTION_2.NOTES_1","MODELS.QUIZ.QUESTION_2.NOTES_2","MODELS.QUIZ.QUESTION_3.QUESTION","MODELS.QUIZ.QUESTION_3.ANSWER_1","MODELS.QUIZ.QUESTION_3.ANSWER_2","MODELS.QUIZ.QUESTION_3.ANSWER_3","MODELS.QUIZ.QUESTION_3.NOTES_1","MODELS.QUIZ.QUESTION_3.NOTES_2","MODELS.QUIZ.QUESTION_4.QUESTION","MODELS.QUIZ.QUESTION_4.ANSWER_1","MODELS.QUIZ.QUESTION_4.ANSWER_2","MODELS.QUIZ.QUESTION_4.ANSWER_3","MODELS.QUIZ.QUESTION_4.ANSWER_4","MODELS.QUIZ.QUESTION_4.ANSWER_5","MODELS.QUIZ.QUESTION_4.ANSWER_6","MODELS.QUIZ.QUESTION_4.NOTES_1","MODELS.QUIZ.QUESTION_4.NOTES_2","MODELS.QUIZ.QUESTION_5.QUESTION","MODELS.QUIZ.QUESTION_5.ANSWER_1","MODELS.QUIZ.QUESTION_5.ANSWER_2","MODELS.QUIZ.QUESTION_5.NOTES_1","MODELS.QUIZ.QUESTION_5.NOTES_2","MODELS.QUIZ.QUESTION_5.NOTES_3","MODELS.QUIZ.QUESTION_5.NOTES_4","MODELS.QUIZ.QUESTION_6.QUESTION","MODELS.QUIZ.QUESTION_6.ANSWER_1","MODELS.QUIZ.QUESTION_6.ANSWER_2","MODELS.QUIZ.QUESTION_6.ANSWER_3","MODELS.QUIZ.QUESTION_6.ANSWER_4","MODELS.QUIZ.QUESTION_6.ANSWER_5","MODELS.QUIZ.QUESTION_7.QUESTION","MODELS.QUIZ.QUESTION_7.ANSWER_1","MODELS.QUIZ.QUESTION_7.ANSWER_2","MODELS.QUIZ.QUESTION_7.ANSWER_3","MODELS.QUIZ.QUESTION_7.NOTES_1","MODELS.QUIZ.QUESTION_7.NOTES_2","MODELS.QUIZ.QUESTION_7.NOTES_3","MODELS.QUIZ.QUESTION_8.QUESTION","MODELS.QUIZ.QUESTION_8.ANSWER_1","MODELS.QUIZ.QUESTION_8.ANSWER_2","MODELS.QUIZ.QUESTION_8.NOTES_1","MODELS.QUIZ.QUESTION_8.NOTES_2","MODELS.QUIZ.QUESTION_8.NOTES_4","MODELS.QUIZ.QUESTION_8.NOTES_5","MODELS.QUIZ.QUESTION_9.QUESTION","MODELS.QUIZ.QUESTION_9.ANSWER_1","MODELS.QUIZ.QUESTION_9.ANSWER_2","MODELS.QUIZ.QUESTION_9.NOTES_1","MODELS.QUIZ.QUESTION_9.NOTES_3","MODELS.QUIZ.QUESTION_9.NOTES_4","MODELS.QUIZ.QUESTION_10.QUESTION","MODELS.QUIZ.QUESTION_10.ANSWER_1","MODELS.QUIZ.QUESTION_10.ANSWER_2","MODELS.QUIZ.QUESTION_10.ANSWER_3","MODELS.QUIZ.QUESTION_10.ANSWER_4","MODELS.QUIZ.QUESTION_10.NOTES_1","MODELS.QUIZ.QUESTION_10.NOTES_2","MODELS.QUIZ.QUESTION_11.QUESTION","MODELS.QUIZ.QUESTION_11.ANSWER_1","MODELS.QUIZ.QUESTION_11.ANSWER_2","MODELS.QUIZ.QUESTION_11.ANSWER_3","MODELS.QUIZ.QUESTION_11.NOTES_1","MODELS.QUIZ.QUESTION_11.NOTES_2","MODELS.QUIZ.QUESTION_12.QUESTION","MODELS.QUIZ.QUESTION_12.ANSWER_1","MODELS.QUIZ.QUESTION_12.ANSWER_2","MODELS.QUIZ.QUESTION_12.ANSWER_3","MODELS.QUIZ.QUESTION_12.NOTES_1","MODELS.QUIZ.QUESTION_12.NOTES_2","MODELS.QUIZ.QUESTION_12.NOTES_3","MODELS.QUIZ.QUESTION_13.QUESTION","MODELS.QUIZ.QUESTION_13.ANSWER_1","MODELS.QUIZ.QUESTION_13.ANSWER_2","MODELS.QUIZ.QUESTION_13.NOTES_1"]).then(function(e){t=[{question:e["MODELS.QUIZ.QUESTION_1.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_1.ANSWER_1"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_1.ANSWER_2"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_1.NOTES_1"]]},{question:e["MODELS.QUIZ.QUESTION_2.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_2.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_2.ANSWER_2"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_2.ANSWER_3"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_2.ANSWER_4"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_2.NOTES_1"],e["MODELS.QUIZ.QUESTION_2.NOTES_2"]]},{question:e["MODELS.QUIZ.QUESTION_3.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_3.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_3.ANSWER_2"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_3.ANSWER_3"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_3.NOTES_1"],e["MODELS.QUIZ.QUESTION_3.NOTES_2"]]},{question:e["MODELS.QUIZ.QUESTION_4.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_4.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_4.ANSWER_2"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_4.ANSWER_3"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_4.ANSWER_4"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_4.ANSWER_5"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_4.ANSWER_6"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_4.NOTES_1"],e["MODELS.QUIZ.QUESTION_4.NOTES_2"]]},{question:e["MODELS.QUIZ.QUESTION_5.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_5.ANSWER_1"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_5.ANSWER_2"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_5.NOTES_1"],e["MODELS.QUIZ.QUESTION_5.NOTES_2"],e["MODELS.QUIZ.QUESTION_5.NOTES_3"],e["MODELS.QUIZ.QUESTION_5.NOTES_4"]]},{question:e["MODELS.QUIZ.QUESTION_6.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_6.ANSWER_1"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_6.ANSWER_2"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_6.ANSWER_3"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_6.ANSWER_4"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_6.ANSWER_5"],correct:!1}]},{question:e["MODELS.QUIZ.QUESTION_7.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_7.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_7.ANSWER_2"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_7.ANSWER_3"],correct:!0}],notes:[e["MODELS.QUIZ.QUESTION_7.NOTES_1"],e["MODELS.QUIZ.QUESTION_7.NOTES_2"],e["MODELS.QUIZ.QUESTION_7.NOTES_3"]]},{question:e["MODELS.QUIZ.QUESTION_8.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_8.ANSWER_1"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_8.ANSWER_2"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_8.NOTES_1"],e["MODELS.QUIZ.QUESTION_8.NOTES_2"]," ",e["MODELS.QUIZ.QUESTION_8.NOTES_4"],e["MODELS.QUIZ.QUESTION_8.NOTES_5"]]},{question:e["MODELS.QUIZ.QUESTION_9.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_9.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_9.ANSWER_2"],correct:!0}],notes:[e["MODELS.QUIZ.QUESTION_9.NOTES_1"]," ",e["MODELS.QUIZ.QUESTION_9.NOTES_3"],e["MODELS.QUIZ.QUESTION_9.NOTES_4"]]},{question:e["MODELS.QUIZ.QUESTION_10.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_10.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_10.ANSWER_2"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_10.ANSWER_3"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_10.NOTES_1"],e["MODELS.QUIZ.QUESTION_10.NOTES_2"]]},{question:e["MODELS.QUIZ.QUESTION_11.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_11.ANSWER_1"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_11.ANSWER_2"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_11.ANSWER_3"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_11.NOTES_1"],e["MODELS.QUIZ.QUESTION_11.NOTES_2"]]},{question:e["MODELS.QUIZ.QUESTION_12.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_12.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_12.ANSWER_2"],correct:!0},{text:e["MODELS.QUIZ.QUESTION_12.ANSWER_3"],correct:!1}],notes:[e["MODELS.QUIZ.QUESTION_12.NOTES_1"],e["MODELS.QUIZ.QUESTION_12.NOTES_2"],e["MODELS.QUIZ.QUESTION_12.NOTES_3"]]},{question:e["MODELS.QUIZ.QUESTION_13.QUESTION"],attempted:!1,answers:[{text:e["MODELS.QUIZ.QUESTION_13.ANSWER_1"],correct:!1},{text:e["MODELS.QUIZ.QUESTION_13.ANSWER_2"],correct:!0}],notes:[e["MODELS.QUIZ.QUESTION_13.NOTES_1"]]}]}),{getQuestion:function(){var e;if(0<t.length)return e=t.length-1,e=Math.floor(Math.random()*(e+1)),(e=t.splice(e,1)[0]).answers.forEach(function(e){e.selected=!1}),e},restoreQuestion:function(e){e.attempted=!0,t.push(e)}}}angular.module("app").service("quizService",e),e.$inject=["$translate"]}(),function(){function e(E,g,e,T,t){var p,m,f;const O=50,R=.01;var h="regression";return{initRegressionSupport:function(t){return T.debug("[ml4kregress] loading tensorflow"),e.loadTensorFlow().then(function(){T.debug("[ml4kregress] enabling tf prod mode"),tf&&tf.enableProdMode&&(tf.enableProdMode(),T.debug("[ml4kregress] tfjs version",tf.version))}).catch(function(e){throw T.error("[ml4kregress] failed to load tensorflow",e),e}).then(function(){if(t.normalization)return g.loadModel(h,t.id)}).then(function(e){if(e)return f={mean:tf.tensor(t.normalization.mean),standardDeviation:tf.tensor(t.normalization.standardDeviation)},m=e.output,p={classifierid:t.id,status:"Available",progress:100,updated:e.timestamp}}).catch(function(e){throw T.error("[ml4kregress] failed to load model",e),f=p=m=null,e})},newModel:function(S){return T.debug("[ml4kregress] creating new ML model"),p={classifierid:S.id,status:"Training",progress:0,updated:new Date},E.getTrainingData(S.id).then(function(n){var r=S.columns.filter(function(e){return"number"===e.type&&!1===e.output}).map(function(e){return e.label}),a=S.columns.filter(function(e){return"number"===e.type&&!0===e.output}).map(function(e){return e.label}),o=[],i=[];for(let e=0;e<n.length;e++){const d=n[e];let t=!1;var s=r.map(function(e){e=d[e];return isNaN(e)&&(t=!0),e}),c=a.map(function(e){e=d[e];return isNaN(e)&&(t=!0),e});t?T.error("[ml4kregress] skipping non-numeric training data",d):(o.push(s),i.push(c))}var e,t=tf.tensor2d(o),l=t.mean(0),u=t.sub(l).square().mean(0).sqrt(),l=(f={mean:l,standardDeviation:u},t.sub(f.mean).div(f.standardDeviation));return E.addMetadataToProject(S.id,"normalization",{mean:f.mean.arraySync(),standardDeviation:f.standardDeviation.arraySync()}),u=r.length,t=a.length,(e=tf.sequential()).add(tf.layers.dense({inputShape:[u],units:O,activation:"sigmoid",kernelInitializer:"leCunNormal"})),e.add(tf.layers.dense({units:O,activation:"sigmoid",kernelInitializer:"leCunNormal"})),e.add(tf.layers.dense({units:t})),e.compile({optimizer:tf.train.sgd(R),loss:"meanSquaredError"}),(m=e).fit(l,tf.tensor2d(i),{batchSize:40,epochs:200,validationSplit:.2,callbacks:{onEpochEnd:(e,t)=>{T.debug("[ml4kregress] epoch "+e+" loss "+t.loss),p&&(p.progress=.5*(e+1))},onTrainEnd:function(){return e=S.id,g.saveModel(h,e,m).then(function(){T.debug("[ml4kregress] training complete"),p&&(p.status="Available",p.progress=100)});var e}}}),p}).catch(function(e){return T.error("[ml4kregress] model training failure",e),p&&(p.status="Failed",p.updated=new Date,p.error=e),p})},deleteModel:function(e){return p=null,g.deleteModel(h,e).then(function(){return E.addMetadataToProject(e,"normalization",null)})},getModels:function(){return T.debug("[ml4kregress] get models"),t(function(e){p?(p.lastPollTime=new Date,e([p])):e([])})},testModel:function(t,n){var e=tf.tidy(function(){var e=t.columns.filter(function(e){return"number"===e.type&&!1===e.output}).map(function(e){return n[e.label]});return tf.tensor2d([e]).sub(f.mean).div(f.standardDeviation)});return m.predict(e).data().then(function(n){var e=t.columns.filter(function(e){return"number"===e.type&&!0===e.output});if(n.length!==e.length)throw T.error("[ml4kregress] unexpected output from model",n),new Error("Unexpected output from model");var r={};return e.forEach(function(e,t){r[e.label]=n[t]}),[r]}).catch(function(e){throw T.error("[ml4kregress] failed to run test",e),e})},reset:function(){try{m&&(tf.dispose(m),m=null),f=p=null}catch(e){T.debug("[ml4kregress] error when disposing of models",e)}}}}angular.module("app").service("regressionTrainingService",e),e.$inject=["browserStorageService","modelService","utilService","loggerService","$q"]}(),function(){function e(e,t,n,r,a,o){var i=this;i.authService=e,o.testdata={text:"The text that you want to test",storetext:"The text that you want to store",label:"label"},o.projectId=a.projectId,o.userId=a.userId,e.getProfileDeferred().then(function(e){return i.profile=e,r.debug("[ml4kpython] getting project"),t.getProject(o.projectId,o.userId,e.tenant)}).then(function(e){if((o.project=e)&&"text"!==e.type)throw new Error("This page is intended for text projects only");return e.labels&&0<e.labels.length&&(o.testdata.label=e.labels[0]),r.debug("[ml4kpython] getting Scratch key"),n.getScratchKeys(o.project,o.userId,i.profile.tenant)}).then(function(e){e&&(o.scratchkey=e[0])}).catch(function(e){o.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("ReplitController",e),e.$inject=["authService","projectsService","scratchkeysService","loggerService","$stateParams","$scope"]}(),function(){function e(e,n,t,r,a,o,i){var s=this;s.authService=e,i.projectId=o.projectId,i.userId=o.userId,i.projecturls={train:"/#!/mlproject/"+o.userId+"/"+o.projectId+"/training",learnandtest:"/#!/mlproject/"+o.userId+"/"+o.projectId+"/models"},a.debug("[ml4kscratch3] preparing Scratch 3 page",i.projecturls);e.getProfileDeferred().then(function(e){return s.profile=e,a.debug("[ml4kscratch3] getting project info"),t.getProject(i.projectId,i.userId,e.tenant)}).then(function(e){if(a.debug("[ml4kscratch3] project",e),i.project=e,i.projecturls.train="/#!/mlproject/"+i.project.userid+"/"+i.project.id+"/training",i.projecturls.learnandtest="/#!/mlproject/"+i.project.userid+"/"+i.project.id+"/models","text"===e.type||"local"!==e.storage)return a.debug("[ml4kscratch3] getting scratch key"),r.getScratchKeys(e,i.userId,s.profile.tenant)}).then(function(e){var t;e?(a.debug("[ml4kscratch3] scratch key",e),(t=e[0]).extensionurl=window.location.origin+"/api/scratch/"+t.id+"/extension3.js","local"===i.project.storage&&(t.extensionurl+=encodeURIComponent("?projectid="+i.project.id))):(e="","regression"===i.project.type&&i.project.columns?(i.project.labels=["input","output"],e="columns="+JSON.stringify(i.project.columns.map(function(e){return{label:e.label,output:e.output}}))):"numbers"===i.project.type&&(e="userid="+i.userId+"&fields="+JSON.stringify(i.project.fields)),t={id:i.project.id,name:i.project.name,type:i.project.type,extensionurl:window.location.origin+"/api/scratch/localproject/local/"+i.project.type+"/extension3.js"+encodeURIComponent("?projectid="+i.project.id+"&projectname="+i.project.name.replaceAll(/[\(\)&<>]/g," ").replace(/[']/g,"\\'")+"&labelslist="+i.project.labels.join(",")+"&"+e)}),n.isModelSavedInBrowser(i.project.type,i.project.id)&&(t.model="placeholder"),i.scratchkey=t}).catch(function(e){a.error("[ml4kscratch3] error",e),i.failure={message:e.data.error,status:e.status}})}angular.module("app").controller("Scratch3Controller",e),e.$inject=["authService","modelService","projectsService","scratchkeysService","loggerService","$stateParams","$scope"]}(),function(){function e(t){return{newTfjsExtension:function(e){return t.post("/api/scratchtfjs/extensions",e).then(function(e){return e.data})}}}angular.module("app").service("scratchService",e),e.$inject=["$http"]}(),function(){function e(r,e,a){function o(t,e,n){n="local"===t.storage?"/api/classes/"+n+"/students/"+e+"/localprojects/"+t.cloudid+"/scratchkeys":"/api/classes/"+n+"/students/"+e+"/projects/"+t.id+"/scratchkeys";return r.get(n).then(function(e){return e.data}).catch(function(e){throw"local"===t.storage&&"text"===t.type&&(a.addCloudRefToProject(t.id,null),delete t.cloudid),e})}return{getScratchKeys:function(t,n,r){return"local"!==t.storage||t.cloudid?o(t,n,r):e.createLocalProject(t,n,r).then(function(e){return t.cloudid=e.cloudid,o(t,n,r)})}}}angular.module("app").service("scratchkeysService",e),e.$inject=["$http","projectsService","browserStorageService"]}(),function(){function e(e,t,n,r,a){var o=this,i=(o.authService=e,o.focused="",1);function s(t){r(function(){var e=document.getElementById(t);n.duScrollToElementAnimated(angular.element(e))},0)}o.errors=[],o.infos=[],o.dismissAlert=function(e,t){o[e].splice(t,1)},o.creating=!1,o.complete=!1,o.confirm=function(e){o.creating=!0,a.debug("[ml4ksignup] Creating new class",e),t.createTeacher(e.username,e.email,e.intendeduse).then(function(e){a.debug("[ml4ksignup] Created class",e);var t=i++;o.infos.push({alertid:t,password:e.password}),s("infos"+t),o.complete=!0}).catch(function(e){var t,n,r;o.creating=!1,a.error("[ml4ksignup] Failed to create class",e),t="errors",n=500,e=e.data,r=i++,o[t].push({alertid:r,message:(e=e||{}).message||e.error||"Unknown error",status:n}),s(t+r)})}}angular.module("app").controller("SignupController",e),e.$inject=["authService","usersService","$document","$timeout","loggerService"]}(),function(){function e(a,o,e,i,n){function s(e){i.error(e),delete o.siteAlert}function r(e,t,n){i.debug("[ml4kalert] getting alerts",e,t,n);var r="/api/sitealerts/public";return"student"===e?r="/api/sitealerts/alerts/"+t+"/students/"+n:"supervisor"===e&&(r="/api/sitealerts/alerts/"+t+"/supervisors/"+n),a.get(r).then(function(e){e=e.data;e&&0<e.length&&e[0].message&&e[0].severity?(o.siteAlert=e[0],o.inMaintenanceMode=o.siteAlert&&"Machine Learning for Kids is temporarily unavailable for scheduled maintenance"===o.siteAlert.message):delete o.siteAlert}).catch(s)}function t(e,t){return o.isAuthenticated?n.getProfileDeferred().then(function(e){return e&&e.role?r(e.role,e.tenant,e.user_id):s("Invalid profile")}).catch(s):r("public")}return{init:function(){o.clearSiteAlert=function(){delete o.siteAlert},t(),o.$on("authStateChange",t),e(t,18e5,0,!0,"timer")},createAlert:function(e){return a.post("/api/sitealerts",e)},refreshServer:function(){return a.put("/api/sitealerts/actions/refresh")}}}angular.module("app").service("sitealertsService",e),e.$inject=["$http","$rootScope","$interval","loggerService","authService"]}(),function(){function e(i,t,n,s,c,r,l){var u,d,S,E,g,T=!1;function p(){var e;if(l.debug("[ml4ksound] loading tensorflow"),e=t.navigator&&t.navigator.mediaDevices&&t.navigator.mediaDevices.getUserMedia,l.debug("[ml4ksound] isUserMediaSupported "+e),e)return l.debug("[ml4ksound] checking permissions"),t.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){l.debug("[ml4ksound] stopping each of the audio tracks"),e.getTracks().forEach(function(e){e.stop()}),l.debug("[ml4ksound] permissions okay")}).catch(function(e){throw l.error("[ml4ksound] permissions check failed",e),"NotAllowedError"===e.name||"SecurityError"===e.name?{status:400,data:{message:"Sorry! Machine Learning for Kids was not allowed to use your microphone"}}:"NotFoundError"===e.name||"TypeError"===e.name?{status:400,data:{message:"Sorry! Machine Learning for Kids could not find a microphone to use"}}:"NotReadableError"===e.name?{status:400,data:{message:"Sorry! There was a problem with your microphone"}}:(l.error("[ml4ksound] Unexpected permissions error"),e&&Sentry&&Sentry.captureException&&Sentry.captureException(e),{status:500,data:e})}).then(function(){return l.debug("[ml4ksound] loading tf"),r.loadTensorFlow()}).then(function(){return l.debug("[ml4ksound] loading speech-commands"),r.loadScript("/static/bower_components/tensorflow-models/speech-commands/speech-commands.min.js?v=179")}).then(function(){l.debug("[ml4ksound] loaded speech-commands",speechCommands.version),l.debug("[ml4ksound] enabling tf prod mode"),tf&&tf.enableProdMode&&(tf.enableProdMode(),l.debug("[ml4ksound] tfjs version",tf.version))}).catch(function(e){throw l.error("[ml4ksound] failed to load tensorflow",e),e});throw l.error("[ml4ksound] user media not supported"),r.isInternetExplorer()?(l.debug("[ml4ksound] running on Internet Explorer"),{status:400,data:{message:"Sorry! Internet Explorer cannot be used for sounds projects"}}):(l.debug("[ml4ksound] reporting failure to find microphone"),{status:400,data:{message:"Sorry! Machine Learning for Kids could not find a microphone to use"}})}function e(r,e,a){var o;return l.debug("[ml4ksound] initializing sound model support",{projectid:r,labels:e,load:a}),r&&!S&&(S=r,E=e),p().then(function(){l.debug("[ml4ksound] loaded tensorflow. loading base model");var e=n.protocol()+"://"+n.host();n.port()&&(e=e+":"+n.port());return(o=speechCommands.create("BROWSER_FFT",null,e+"/static/bower_components/tensorflow-models/speech-commands/model.json",e+"/static/bower_components/tensorflow-models/speech-commands/metadata.json")).ensureModelLoaded()}).then(function(){l.debug("[ml4ksound] creating transfer learning recognizer");var t,n,e=(u=o.createTransfer("project-"+r)).modelInputShape();if(l.debug("[ml4ksound] model info",e),d={numFrames:e[1],fftSize:e[2]},a)return t=S,n=E,l.debug("[ml4ksound] loading model from storage",t),c.loadModel(m,t,u).then(function(e){if(e)return u.words=Array.from(n).sort(),g={classifierid:t,status:"Available",progress:100,updated:e.timestamp},T=!0,g})}).then(function(e){var t={};return e&&(t.loaded=e),navigator.userAgent.toLowerCase().includes("firefox")&&(t.warning={message:"Firefox users have reported problems using sound models, so if you have problems please try a different browser"}),t})}var m="sounds";return{initSoundSupport:e,getModelInfo:function(){return d},collectExample:function(e){return u.collectExample(e)},newModel:function(r,a,o){return l.debug("[ml4ksound] creating new ML model"),l.debug("[ml4ksound] tf backend",tf.getBackend()),l.debug("[ml4ksound] tf precision",tf.ENV.getBool("WEBGL_RENDER_FLOAT32_ENABLED")),g={classifierid:r,status:"Training",progress:0,updated:new Date},l.debug("[ml4ksound] preparing sound service"),(T?(l.debug("[ml4ksound] Setting up new transfer learning model"),e()):i(function(e){e()})).then(function(){return l.debug("[ml4ksound] getting training data"),e=r,t=a,n=o,l.debug("[ml4ksound] getting training data",e),s.getTraining(e,t,n).then(function(e){return i.all(e.map(s.getSoundData))});var e,t,n}).then(function(e){l.debug("[ml4ksound] retrieved training data"),u.dataset.clear(),u.dataset.label2Ids={},u.words=null;for(var t=0;t<e.length;t++){var n=e[t];u.dataset.addExample({label:n.label,spectrogram:{frameSize:d.fftSize,data:new Float32Array(n.audiodata)}})}return u.collateTransferWords(),tf.nextFrame()}).then(function(){return l.debug("[ml4ksound] starting transfer learning"),u.train({epochs:100,callback:{onEpochEnd:function(e){g&&(g.progress=e+1)}}}).then(function(){if(g)return g.status="Available",g.progress=100,T=!1,c.saveModel(m,r,u)}).catch(function(e){l.error("[ml4ksound] model training failure",e),g&&(g.status="Failed",g.updated=new Date)}),l.debug("[ml4ksound] returning interim status"),g}).catch(function(e){return l.error("[ml4ksound] model training failure",e),g&&(g.status="Failed",g.updated=new Date),g})},deleteModel:function(e){return g=null,c.deleteModel(m,e)},getModels:function(){return l.debug("[ml4ksound] get sound models"),i(function(e){g?(g.lastPollTime=new Date,e([g])):e([])})},startTest:function(a){return l.debug("[ml4ksound] starting to listen"),u.listen(function(e){var t=[],n=u.wordLabels();if(!n)return l.debug("[ml4ksound] labels unavailable"),a(t);n.length!==e.scores.length&&l.error("[ml4ksound] Unexpected number of results",n.length,e.scores.length);for(var r=0;r<Math.min(n.length,e.scores.length);r++)t.push({class_name:n[r],confidence:100*e.scores[r]});t.sort(c.sortByConfidence),a(t)},{probabilityThreshold:.7})},stopTest:function(){l.debug("[ml4ksound] stopping listening");try{return u.stopListening()}catch(e){return i.reject(e)}},reset:function(){l.debug("[ml4ksound] reset");try{u&&tf.dispose(u)}catch(e){l.debug("[ml4ksound] failed to dispose transfer model",e)}}}}angular.module("app").service("soundTrainingService",e),e.$inject=["$q","$window","$location","trainingService","modelService","utilService","loggerService"]}(),function(){function e(e,t,n,r,a,o,i,s){n.worksheets={};var c=["ml-hasnt-replaced-coding","ml-workflow","correlation-of-quantity-with-accuracy","crowdsourcing-and-gamification","variety-of-training-data","separation-of-training-and-test-data","not-just-intents","adding-errors-to-training","confidence-scores","black-box-challenge","learning-the-wrong-thing","testing-with-data-not-represented-in-training","bias","assembling-ml-solutions","models-learn-to-do-specific-jobs","invisible-ai"];function l(t){a(function(){var e=document.getElementById(t);o.duScrollToElementAnimated(angular.element(e))},0)}n.pageId=e.storyId,n.pageNum=c.indexOf(e.storyId),n.pageNum<0&&(n.pageNum=-1,n.pageId="intro"),n.datestring=(new Date).toDateString(),n.isPrinting=!1,n.print=function(){n.isPrinting=!0,a(function(){r.print()})},addEventListener("afterprint",()=>{n.isPrinting=!1}),n.changePage=function(e){l("topofstory"),t.transitionTo("stories",{storyId:c[e]},{location:!0,inherit:!0,relative:t.$current,notify:!1})},n.displayStories=function(e){i.show({controller:["$scope",function(e){e.hide=function(){i.hide()},e.confirm=function(e){i.hide(e)},e.cancel=function(){i.cancel()}}],templateUrl:"static/components/stories/storieslist.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){n.changePage(e)},function(){})},n.downloadWorksheet=function(e,t){i.show({locals:{worksheet:n.worksheets[t]},controller:["$scope","locals",function(e,t){e.worksheet=t.worksheet,e.hide=function(){i.hide()},e.cancel=function(){i.cancel()}}],templateUrl:"static/components/worksheets/download.tmpl.html",targetEvent:e,clickOutsideToClose:!0})},n.scrollToVideo=function(){l("storyvideo")},s(["WORKSHEETS.FACEFINDER.TITLE","WORKSHEETS.FACEFINDER.SUMMARY","WORKSHEETS.FACEFINDER.DESCRIPTION","WORKSHEETS.FACEFINDER.WORKSHEET_1.URL","WORKSHEETS.FACEFINDER.TEACHERSNOTES_URL","WORKSHEETS.CHATBOTS.TITLE","WORKSHEETS.CHATBOTS.SUMMARY","WORKSHEETS.CHATBOTS.DESCRIPTION","WORKSHEETS.CHATBOTS.WORKSHEET_1.DESCRIPTION","WORKSHEETS.CHATBOTS.WORKSHEET_1.URL","WORKSHEETS.CHATBOTS.WORKSHEET_2.DESCRIPTION","WORKSHEETS.CHATBOTS.WORKSHEET_2.URL","WORKSHEETS.CHATBOTS.TEACHERSNOTES_URL","WORKSHEETS.PACMAN.TITLE","WORKSHEETS.PACMAN.SUMMARY","WORKSHEETS.PACMAN.DESCRIPTION","WORKSHEETS.PACMAN.WORKSHEET_1.URL","WORKSHEETS.PACMAN.TEACHERSNOTES_URL","WORKSHEETS.NOUGHTSANDCROSSES.TITLE","WORKSHEETS.NOUGHTSANDCROSSES.SUMMARY","WORKSHEETS.NOUGHTSANDCROSSES.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_1.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_1.URL","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_2.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_2.URL","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_3.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_3.URL","WORKSHEETS.NOUGHTSANDCROSSES.TEACHERSNOTES_URL","WORKSHEETS.NEWSPAPERSHELVES.TITLE","WORKSHEETS.NEWSPAPERSHELVES.SUMMARY","WORKSHEETS.NEWSPAPERSHELVES.DESCRIPTION","WORKSHEETS.NEWSPAPERSHELVES.WORKSHEET_1.URL","WORKSHEETS.NEWSPAPERSHELVES.TEACHERSNOTES_URL","WORKSHEETS.MAKEMEHAPPY.TITLE","WORKSHEETS.MAKEMEHAPPY.SUMMARY","WORKSHEETS.MAKEMEHAPPY.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.URL","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.URL","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.URL","WORKSHEETS.MAKEMEHAPPY.TEACHERSNOTES_URL","WORKSHEETS.SMARTCLASSROOM.TITLE","WORKSHEETS.SMARTCLASSROOM.SUMMARY","WORKSHEETS.SMARTCLASSROOM.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.URL","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.URL","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.URL","WORKSHEETS.SMARTCLASSROOM.TEACHERSNOTES_URL","WORKSHEETS.EXPLAINABILITY.TITLE","WORKSHEETS.EXPLAINABILITY.SUMMARY","WORKSHEETS.EXPLAINABILITY.DESCRIPTION","WORKSHEETS.EXPLAINABILITY.WORKSHEET_1.URL","WORKSHEETS.EXPLAINABILITY.TEACHERSNOTES_URL","WORKSHEETS.ROCKPAPERSCISSORS.TITLE","WORKSHEETS.ROCKPAPERSCISSORS.SUMMARY","WORKSHEETS.ROCKPAPERSCISSORS.DESCRIPTION","WORKSHEETS.ROCKPAPERSCISSORS.WORKSHEET_1.URL","WORKSHEETS.ROCKPAPERSCISSORS.TEACHERSNOTES_URL","WORKSHEETS.TOURISTINFO.TITLE","WORKSHEETS.TOURISTINFO.SUMMARY","WORKSHEETS.TOURISTINFO.DESCRIPTION","WORKSHEETS.TOURISTINFO.WORKSHEET_1.URL","WORKSHEETS.TOURISTINFO.TEACHERSNOTES_URL","WORKSHEETS.SECRETCODE.TITLE","WORKSHEETS.SECRETCODE.SUMMARY","WORKSHEETS.SECRETCODE.DESCRIPTION","WORKSHEETS.SECRETCODE.WORKSHEET_1.URL","WORKSHEETS.SECRETCODE.TEACHERSNOTES_URL","WORKSHEETS.LASEREYES.TITLE","WORKSHEETS.LASEREYES.SUMMARY","WORKSHEETS.LASEREYES.DESCRIPTION","WORKSHEETS.LASEREYES.WORKSHEET_1.URL","WORKSHEETS.LASEREYES.TEACHERSNOTES_URL","WORKSHEETS.INKBLOTS.TITLE","WORKSHEETS.INKBLOTS.SUMMARY","WORKSHEETS.INKBLOTS.DESCRIPTION","WORKSHEETS.INKBLOTS.WORKSHEET_1.URL","WORKSHEETS.INKBLOTS.TEACHERSNOTES_URL","WORKSHEETS.MAILMANMAX.TITLE","WORKSHEETS.MAILMANMAX.SUMMARY","WORKSHEETS.MAILMANMAX.DESCRIPTION","WORKSHEETS.MAILMANMAX.WORKSHEET_1.URL","WORKSHEETS.MAILMANMAX.TEACHERSNOTES_URL"]).then(function(e){n.worksheets={facefinder:{title:e["WORKSHEETS.FACEFINDER.TITLE"],summary:e["WORKSHEETS.FACEFINDER.SUMMARY"],description:e["WORKSHEETS.FACEFINDER.DESCRIPTION"],difficulty:"Beginner",type:"faces",maketypes:["scratch3"],image:"static/images/project-facefinder.png",tags:["face detection"],teachersnotes:e["WORKSHEETS.FACEFINDER.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.FACEFINDER.WORKSHEET_1.URL"]}]},chatbots:{title:e["WORKSHEETS.CHATBOTS.TITLE"],summary:e["WORKSHEETS.CHATBOTS.SUMMARY"],description:e["WORKSHEETS.CHATBOTS.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3","python"],image:"static/images/project-chatbots.png",tags:["sentiment analysis","supervised learning"],teachersnotes:e["WORKSHEETS.CHATBOTS.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.CHATBOTS.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.CHATBOTS.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.CHATBOTS.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.CHATBOTS.WORKSHEET_2.URL"]}]},pacman:{title:e["WORKSHEETS.PACMAN.TITLE"],summary:e["WORKSHEETS.PACMAN.SUMMARY"],description:e["WORKSHEETS.PACMAN.DESCRIPTION"],difficulty:"Intermediate",type:"numbers",maketypes:["scratch3"],image:"static/images/project-pacman.png",tags:["decision tree learning"],teachersnotes:e["WORKSHEETS.PACMAN.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.PACMAN.WORKSHEET_1.URL"]}]},noughtsandcrosses:{title:e["WORKSHEETS.NOUGHTSANDCROSSES.TITLE"],summary:e["WORKSHEETS.NOUGHTSANDCROSSES.SUMMARY"],description:e["WORKSHEETS.NOUGHTSANDCROSSES.DESCRIPTION"],difficulty:"Advanced",type:"numbers",maketypes:["python"],image:"static/images/project-noughtsandcrosses.png",tags:["decision tree learning","reinforcement learning","categorical data"],teachersnotes:e["WORKSHEETS.NOUGHTSANDCROSSES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_2.URL"]}]},newspapers:{title:e["WORKSHEETS.NEWSPAPERSHELVES.TITLE"],summary:e["WORKSHEETS.NEWSPAPERSHELVES.SUMMARY"],description:e["WORKSHEETS.NEWSPAPERSHELVES.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3"],image:"static/images/project-headlines-easy.png",tags:["text classification","supervised learning"],teachersnotes:e["WORKSHEETS.NEWSPAPERSHELVES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.NEWSPAPERSHELVES.WORKSHEET_1.URL"]}]},makemehappy:{title:e["WORKSHEETS.MAKEMEHAPPY.TITLE"],summary:e["WORKSHEETS.MAKEMEHAPPY.SUMMARY"],description:e["WORKSHEETS.MAKEMEHAPPY.DESCRIPTION"],difficulty:"Beginner",type:"text",maketypes:["scratch3","python"],image:"static/images/project-makemehappy.png",tags:["sentiment analysis","supervised learning"],teachersnotes:e["WORKSHEETS.MAKEMEHAPPY.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.URL"]},{description:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.DESCRIPTION"],worksheet:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.URL"]}]},smartclassroom:{title:e["WORKSHEETS.SMARTCLASSROOM.TITLE"],summary:e["WORKSHEETS.SMARTCLASSROOM.SUMMARY"],description:e["WORKSHEETS.SMARTCLASSROOM.DESCRIPTION"],difficulty:"Beginner",type:"text",maketypes:["scratch3"],image:"static/images/project-smartclassroom.png",tags:["digital assistants","supervised learning"],teachersnotes:e["WORKSHEETS.SMARTCLASSROOM.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.URL"]},{description:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.DESCRIPTION"],worksheet:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.URL"]}]},explainability:{title:e["WORKSHEETS.EXPLAINABILITY.TITLE"],summary:e["WORKSHEETS.EXPLAINABILITY.SUMMARY"],description:e["WORKSHEETS.EXPLAINABILITY.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-explainability.png",tags:["image recognition","explainable AI","xai"],teachersnotes:e["WORKSHEETS.EXPLAINABILITY.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.EXPLAINABILITY.WORKSHEET_1.URL"]}]},rockpaperscissors:{title:e["WORKSHEETS.ROCKPAPERSCISSORS.TITLE"],summary:e["WORKSHEETS.ROCKPAPERSCISSORS.SUMMARY"],description:e["WORKSHEETS.ROCKPAPERSCISSORS.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-rockpaperscissors.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.ROCKPAPERSCISSORS.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.ROCKPAPERSCISSORS.WORKSHEET_1.URL"]}]},touristinfo:{title:e["WORKSHEETS.TOURISTINFO.TITLE"],summary:e["WORKSHEETS.TOURISTINFO.SUMMARY"],description:e["WORKSHEETS.TOURISTINFO.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3"],image:"static/images/project-touristinfo.png",tags:["training bias","recommendations","supervised learning"],teachersnotes:e["WORKSHEETS.TOURISTINFO.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.TOURISTINFO.WORKSHEET_1.URL"]}]},secretcode:{title:e["WORKSHEETS.SECRETCODE.TITLE"],summary:e["WORKSHEETS.SECRETCODE.SUMMARY"],description:e["WORKSHEETS.SECRETCODE.DESCRIPTION"],difficulty:"Intermediate",type:"sounds",maketypes:["scratch3"],image:"static/images/project-secretcode.png",tags:["speech recognition","sound recognition","supervised learning"],teachersnotes:e["WORKSHEETS.SECRETCODE.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.SECRETCODE.WORKSHEET_1.URL"]}]},lasereyes:{title:e["WORKSHEETS.LASEREYES.TITLE"],summary:e["WORKSHEETS.LASEREYES.SUMMARY"],description:e["WORKSHEETS.LASEREYES.DESCRIPTION"],difficulty:"Intermediate",type:"sounds",maketypes:["scratch3"],image:"static/images/project-lasereyes.png",tags:["speech recognition","face detection"],teachersnotes:e["WORKSHEETS.LASEREYES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.LASEREYES.WORKSHEET_1.URL"]}]},inkblots:{title:e["WORKSHEETS.INKBLOTS.TITLE"],summary:e["WORKSHEETS.INKBLOTS.SUMMARY"],description:e["WORKSHEETS.INKBLOTS.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-inkblots.png",tags:["image classification","supervised learning","AI research"],teachersnotes:e["WORKSHEETS.INKBLOTS.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.INKBLOTS.WORKSHEET_1.URL"]}]},mailmanmax:{title:e["WORKSHEETS.MAILMANMAX.TITLE"],summary:e["WORKSHEETS.MAILMANMAX.SUMMARY"],description:e["WORKSHEETS.MAILMANMAX.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-mailmanmax.png",tags:["optical character recognition","handwriting recognition","image classification"],teachersnotes:e["WORKSHEETS.MAILMANMAX.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.MAILMANMAX.WORKSHEET_1.URL"]}]}}})}angular.module("app").controller("StoriesController",e),e.$inject=["$stateParams","$state","$scope","$window","$timeout","$document","$mdDialog","$translate"]}(),function(){function e(t,n,r){var a=this,o=(a.authService=t,a.busy=!1,1);function i(e,t,n){var r=o++;a[e].push({alertid:r,message:(n=n||{}).message||n.error||"Unknown error",status:t})}a.errors=[],a.warnings=[],a.dismissAlert=function(e,t){a[e].splice(t,1)},t.getProfileDeferred().then(function(e){"supervisor"===(a.profile=e).role&&n.getClassPolicy(e).then(function(e){a.policy=e,a.policy.missingCredentials=!1;for(var t=0;t<e.supportedProjectTypes.length;t++)"text"===e.supportedProjectTypes[t]&&0===e.maxTextModels&&(a.policy.missingCredentials=!0)}).catch(function(e){i("errors",e.status,e.data)})}).catch(function(e){i("errors",e.status,e.data)}),a.deleteClass=function(e){e=r.confirm().title("Are you sure?").htmlContent('<div class="confirmdialogsmall">This cannot be undone. It will delete your account, as well as the accounts of all of your students. I will not be able to retrieve any projects from your class if you do this.</div>').targetEvent(e).ok("Yes. Delete everything.").cancel("No");r.show(e).then(function(){a.busy=!0,n.deleteClass(a.profile).then(function(){t.logout()}).catch(function(e){a.busy=!1,i("errors",e.status,e)})},function(){})}}angular.module("app").controller("TeacherController",e),e.$inject=["authService","usersService","$mdDialog"]}(),function(){function e(e,r,a,n,o,i){var s=this,c=(s.authService=e,s.CONSTANTS={UNKNOWN:-1,UNLIMITED:-2},1);function l(e,t,n){var r=c++;return s[e].push({alertid:r,message:(n=n||{}).message||n.error||"Unknown error",status:t}),r}function u(e){i.debug("[ml4kapi] computing limit for "+e);for(var t=s.credentials[e],n=0,r=0;r<t.length;r++){var a=t[r];if("conv_lite"===a.credstype||"conv_plustrial"===a.credstype)n+=5;else if("conv_standard"===a.credstype)n+=20;else{if("conv_plus"!==a.credstype){n=s.CONSTANTS.UNKNOWN;break}n+=50}}s.credentials.totals[e]=n}function d(e){var t;s.credentials={loading:{conv:!0},failed:{conv:!1},totals:{conv:s.CONSTANTS.UNKNOWN}},e=e,t="conv",i.debug("[ml4kapi] retrieving IBM credentials ("+t+")"),r.getCredentials(e,t).then(function(e){i.debug("[ml4kapi] got IBM credentials ("+t+")"),s.credentials[t]=e,s.credentials.loading[t]=!1,u(t)}).catch(function(e){i.error("[ml4kapi] failed to get credentials ("+t+")",e),s.credentials.failed[t]=!0,s.credentials.loading[t]=!1,l("errors",e.status,e.data)})}function S(t){o(function(){var e=document.getElementById(t);n.duScrollToElementAnimated(angular.element(e))},0)}s.errors=[],s.warnings=[],s.dismissAlert=function(e,t){s[e].splice(t,1)},e.getProfileDeferred().then(function(t){"supervisor"===(s.profile=t).role&&r.getClassPolicy(t).then(function(e){s.policy=e,!1===s.policy.isManaged&&d(t)}).catch(function(e){l("errors",e.status,e.data)})}).catch(function(e){l("errors",e.status,e.data)}),s.verifyCredentials=function(e,n){i.debug("[ml4kapi] verifying IBM credentials"),n.verifying=!0,r.verifyCredentials(s.profile,n).then(function(){i.debug("[ml4kapi] verified"),n.verified=!0,n.verifying=!1}).catch(function(e){i.error("[ml4kapi] check failed",e),n.verified=!1,n.verifying=!1;var t="",e=(e&&e.data&&e.data.error&&(t=e.data.error),a.alert().title("IBM Watson rejected your API key").htmlContent('<div class="confirmdialogsmall">'+n.apikey+" was rejected by IBM. "+(t?"<div>The response was : "+t+"</div>":"")+"</div>").ok("OK"));a.show(e)})},s.deleteCredentials=function(e,t,n){i.debug("[ml4kapi] deleting IBM credentials");e=a.confirm().title("Are you sure?").textContent("Do you want to remove these credentials from machinelearningforkids.co.uk?").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");a.show(e).then(function(){r.deleteCredentials(s.profile,t).then(function(){i.debug("[ml4kapi] deleted"),s.credentials[n]=s.credentials[n].filter(function(e){return e.id!==t.id}),u(n)}).catch(function(e){i.error("[ml4kapi] failed to delete",e),l("errors",e.status,e.data)})},function(){})},s.addCredentials=function(e,n){i.debug("[ml4kapi] adding new IBM credentials"),a.show({controller:["$scope","$mdDialog",function(e,t){e.type="apikey",e.credstype="",e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/teacher_apikeys/newcreds"+n+".tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){e.servicetype=n,e.isPlaceholder=!0;var t=Date.now();e.uniq=t,s.credentials[n].push(e),i.debug("[ml4kapi] storing IBM credentials"),r.addCredentials(e,s.profile.tenant).then(function(e){i.debug("[ml4kapi] stored"),s.credentials[n]=s.credentials[n].filter(function(e){return e.uniq!==t}),s.credentials[n].push(e),u(n)}).catch(function(e){i.error("[ml4kapi] failed to store",e),S("errors"+l("errors",e.status,e.data)),s.credentials[n]=s.credentials[n].filter(function(e){return e.uniq!==t})})},function(){})},s.modifyCredentials=function(e,n,t){i.debug("[ml4kapi] modifying IBM credentials"),a.show({controller:["$scope","$mdDialog",function(e,t){e.credstype=n.credstype,e.currentcredstype=n.credstype,e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/teacher_apikeys/modifycreds"+t+".tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){i.debug("[ml4kapi] updating IBM credentials"),r.modifyCredentials(n,t,e.credstype,s.profile.tenant).then(function(){i.debug("[ml4kapi] updated"),n.credstype=e.credstype,u(t)}).catch(function(e){i.error("[ml4kapi] failed to update",e),S("errors"+l("errors",e.status,e.data))})},function(){})},s.explainLimit=function(){var e=a.alert().title("Limit on the number of machine learning models").textContent('When a student in your class clicks on the "Train machine learning model" button, the model that they create will count towards this limit. If this limit is exceeded, they will see an error saying that the class has already created their maximum allowed number of models. See the "Help" page for suggestions for how to avoid this').ok("OK");a.show(e)}}angular.module("app").controller("TeacherApiKeysController",e),e.$inject=["authService","usersService","$mdDialog","$document","$timeout","loggerService"]}(),function(){function e(e,t,r){var a=this,o=(a.authService=e,a.saving=!1,1);function i(e,t,n){var r=o++;a[e].push({alertid:r,message:(n=n||{}).message||n.error||"Unknown error",status:t})}a.errors=[],a.warnings=[],a.dismissAlert=function(e,t){a[e].splice(t,1)},e.getProfileDeferred().then(function(e){"supervisor"===(a.profile=e).role&&t.getClassPolicy(e).then(function(e){(a.policy=e).supportedProjectTypes&&(a.policy.supportedProjectTypes=e.supportedProjectTypes.map(function(e){return"imgtfjs"===e?"images":"images"===e?"images (cloud)":e}))}).catch(function(e){i("errors",e.status,e.data)})}).catch(function(e){i("errors",e.status,e.data)}),a.modifyExpiry=function(e){var n=a.policy.textClassifierExpiry;r.show({controller:["$scope","$mdDialog",function(e,t){e.initialtextexpiry=n,e.textexpiry=a.policy.textClassifierExpiry,e.hoursfilter=function(e){return 1===e?"1 hour":e<24?e+" hours":24===e?"1 day":e<168?Math.floor(e/24)+" days, "+e%24+" hours":168===e?"1 week":"1 week, "+Math.floor((e-168)/24)+" days, "+e%24+" hours"},e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/teacher_restrictions/modifyexpiry.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){a.saving=!0,a.policy.textClassifierExpiry="...",t.modifyClassPolicy(a.profile,e.textexpiry).then(function(e){a.saving=!1,a.policy.textClassifierExpiry=e.textClassifierExpiry}).catch(function(e){a.saving=!1,i("errors",e.status,e.data),a.policy.textClassifierExpiry=n})},function(){})}}angular.module("app").controller("TeacherRestrictionsController",e),e.$inject=["authService","usersService","$mdDialog"]}(),function(){function e(n,o,d,S,r,e,c){var E=this,i=(E.authService=n,E.allStudentPasswordsReset=!1,1),a=(d.MAX_PER_GROUP=40,E.groupedStudents={},1);function g(e,t,n){var r=a++;return E[e].push({alertid:r,message:(n=n||{}).message||n.error||"Unknown error",status:t}),r}function s(){}function l(){return!0}function t(e){O("errors"+g("errors",e.status,e.data))}function T(t,e,n,r,a,o){var i,s;c.debug("[ml4kuser] starting "+t),d.busy=!0,e()?(e=function(){n().then(r).then(function(){c.debug("[ml4kuser] completed "+t),d.busy=!1}).catch(function(e){c.error("[ml4kuser] failed to perform operation",t,e),a(e),O("errors"+g("errors",e.status,e.data)),d.busy=!1})},o?(o=o,i=e,s=function(){d.busy=!1},o=S.confirm().title("Are you sure?").textContent(o.message).ariaLabel("Confirm").targetEvent(o.event).ok("Yes").cancel("No"),S.show(o).then(i,s)):e()):d.busy=!1}E.errors=[],E.warnings=[],E.dismissAlert=function(e,t){E[e].splice(t,1)},d.busy=!0,n.getProfileDeferred().then(function(e){"supervisor"===(E.profile=e).role&&(e.groups||(e.groups=[]),o.getClassPolicy(e).then(function(e){E.policy=e,d.busy=!1}).catch(t))}).catch(t),d.fetchAndDisplayUngroupedStudents=function(){T("fetching ungrouped students",function(){return d.ungroupedStudentsExpanded=!d.ungroupedStudentsExpanded,!E.ungroupedStudents},function(){return o.getStudentList(E.profile,"")},function(e){E.ungroupedStudents=e},s)},d.moveStudentsIntoGroup=function(n,r){var e="moving students from "+n+" to "+r,a=m(n);T(e,function(){return p[n]||(p[n]=[]),!0},function(){return o.addStudentsToGroup(p[n],E.profile.tenant,r)},function(){if(E.groupedStudents[r])for(var e=0;e<a.length;e++){var t=a[e];t.isPlaceholder=!1,E.groupedStudents[r].push(t)}"ungrouped"===n?E.ungroupedStudents=E.ungroupedStudents.filter(function(e){return-1===p[n].indexOf(e.id)}):E.groupedStudents[n]=E.groupedStudents[n].filter(function(e){return-1===p[n].indexOf(e.id)}),p[n]=[]},function(){for(var e=0;e<a.length;e++)a[e].isPlaceholder=!1})},d.removeStudentsFromGroup=function(n){var e="removing students from group "+n,r=m(n);T(e,function(){return p[n]||(p[n]=[]),!0},function(){return o.removeStudentsFromGroup(p[n],E.profile.tenant)},function(){if(E.ungroupedStudents)for(var e=0;e<r.length;e++){var t=r[e];t.isPlaceholder=!1,E.ungroupedStudents.push(t)}E.groupedStudents[n]=E.groupedStudents[n].filter(function(e){return-1===p[n].indexOf(e.id)}),p[n]=[]},function(){for(var e=0;e<r.length;e++)r[e].isPlaceholder=!1})},E.deleteUsers=function(e,n){var t="deleting selected students from "+n,r=m(n);T(t,function(){return!(!E.groupedStudents[n]||!p[n])&&0<p[n].length&&p[n].length<=d.MAX_PER_GROUP},function(){return o.deleteStudents(r,E.profile.tenant)},function(e){var t=e.deleted.map(function(e){return e.id});E.groupedStudents[n]=E.groupedStudents[n].filter(function(e){return!(-1<t.indexOf(e.id)||(e.isPlaceholder=!1))}),p[n]=[],r.length!==t.length&&O("warnings"+g("warnings",400,{message:"Not all selected students could be deleted"}))},function(){r.forEach(function(e){e.isPlaceholder=!1})},{message:"Do you want to delete these students and all of their work? (This cannot be undone)",event:e})},E.deleteUser=function(e,t,n){T("deleting student "+n.username+" "+n.id,function(){return n.isPlaceholder=!0},function(){return o.deleteStudent(n,E.profile.tenant)},function(){"ungrouped"===t?E.ungroupedStudents=E.ungroupedStudents.filter(function(e){return e.username!==n.username}):E.groupedStudents[t]&&(E.groupedStudents[t]=E.groupedStudents[t].filter(function(e){return e.username!==n.username}))},function(){n.isPlaceholder=!1},{message:"Do you want to delete "+n.username+" and all of their work? (This cannot be undone)",event:e})},d.createStudentGroup=function(e){c.debug("[ml4kuser] requesting details for creating student group"),S.show({controller:["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/teacher_students/newgroup.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){T("creating student group "+e,function(){return e&&"ALL"!==e&&"ungrouped"!==e&&-1===E.profile.groups.indexOf(e)},function(){return o.createClassGroup(E.profile,e)},function(){E.profile.groups.push(e),n.storeProfile(E.profile)},s)},s)},d.deleteStudentGroup=function(e,t){T("deleting student group "+t,function(){return E.groupedStudents[t]&&0===E.groupedStudents[t].length},function(){return o.deleteClassGroup(E.profile,t)},function(){E.profile.groups=E.profile.groups.filter(function(e){return e!==t}),n.storeProfile(E.profile)},s)},E.resetUserPassword=function(t,n){T("resetting student password "+n.id+" "+n.username,function(){return n.isPlaceholder=!0},function(){return o.resetStudentPassword(n,E.profile.tenant)},function(e){n.isPlaceholder=!1,f(t,e)},function(){n.isPlaceholder=!1})},E.resetUsersPassword=function(t,e){var n="resetting passwords for selected students in "+e,r=(E.allStudentPasswordsReset=!0,m(e));T(n,function(){return E.groupedStudents[e]&&p[e]&&0<p[e].length},function(){return o.resetStudentsPassword(r,E.profile.tenant)},function(e){r.forEach(function(e){e.isPlaceholder=!1}),f(t,{username:"Selected students",password:e.password},30<r.length)},function(){r.forEach(function(e){e.isPlaceholder=!1}),E.allStudentPasswordsReset=!1},{message:"Do you want to reset the passwords for the selected students (so they all have the same password)?",event:t})},E.createUser=function(r,a){c.debug("[ml4kuser] requesting details for creating individual student in group "+a),!E.groupedStudents[a]||E.groupedStudents[a].length>=d.MAX_PER_GROUP||S.show({controller:["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/teacher_students/newstudent.tmpl.html",targetEvent:r,clickOutsideToClose:!0}).then(function(e){var t="creating student "+e,n={id:i++,username:e,group:a,isPlaceholder:!0};E.groupedStudents[a].push(n);T(t,l,function(){return o.createStudent(n,E.profile.tenant)},function(e){n.id=e.id,n.isPlaceholder=!1,f(r,e)},function(){E.groupedStudents[a]=E.groupedStudents[a].filter(function(e){return e.id!==n.id})})},s)},E.createMultipleUsers=function(l,u){c.debug("[ml4kuser] requesting details for creating multiple students");var e=Math.min(d.MAX_PER_GROUP,E.policy.maxUsers),n=e-E.groupedStudents[u].length;S.show({controller:["$scope","$mdDialog",function(t,r){t.remaining=n,t.userslimit=e,t.hide=function(){r.hide()},t.cancel=function(){r.cancel()},t.confirm=function(e,t,n){r.hide({prefix:e,number:t,password:n})},t.refreshPassword=function(){t.password="...",o.getGeneratedPassword(E.profile.tenant).then(function(e){t.password=e.password}).catch(function(e){c.error("[ml4kuser] failed to generate password",e)})},t.refreshPassword()}],templateUrl:"static/components/teacher_students/newstudents.tmpl.html",targetEvent:l,clickOutsideToClose:!0}).then(function(c){T("creating multiple students",function(){if(E.groupedStudents[u]&&c.number&&c.number<d.MAX_PER_GROUP){for(var e=1;e<=c.number;e++){var t={id:i++,username:c.prefix+e,isPlaceholder:!0,group:u};E.groupedStudents[u].push(t)}return!0}return!1},function(){return o.createStudents(E.profile.tenant,c.prefix,c.number,c.password,u)},function(e){if(E.groupedStudents[u]=E.groupedStudents[u].filter(function(e){return!e.isPlaceholder}),e&&e.successes)for(var t=0;t<e.successes.length;t++)E.groupedStudents[u].push(e.successes[t]);var n,r,a,o=l,i=e,s=c.password;i&&i.successes&&i.failures&&i.duplicates?0<i.failures.length||0<i.duplicates.length?(r=0<i.failures.length?"Something went wrong!":"Usernames already in use",a="",0<i.failures.length&&(a="<div>Sorry. An unexpected error happened when trying to create: <br/><code>"+i.failures.join(", ")+"</code></div>"),0<i.duplicates.length&&(a="<div>The following student accounts could not be created because there are already users with these usernames: <br/><code>"+i.duplicates.join(", ")+"</code></div>"),n=o,r=r,a='<div style="padding: 1em">'+a+"</div>",S.show(S.alert().clickOutsideToClose(!0).title(r).htmlContent(a).ok("OK").targetEvent(n))):0<i.successes.length&&f(o,{username:"New students created:",password:s},!1):O("errors"+g("errors",500,{error:"Unexpected response"}))},function(){E.groupedStudents[u]=E.groupedStudents[u].filter(function(e){return!e.isPlaceholder})})},s)};var u=[],p=(d.collapsePanel=function(e){var t,n,r=u.indexOf(e);-1<r?u.splice(r,1):(u.push(e),E.groupedStudents[e]||(t=E.profile,T("fetching students in group "+(n=e),l,function(){return o.getStudentList(t,n)},function(e){E.groupedStudents[n]=e},s)))},d.isPanelCollapsed=function(e){return-1<u.indexOf(e)},d.ungroupedStudentsExpanded=!1,{});function m(n){return"ungrouped"===n?E.ungroupedStudents.filter(function(e){var t=d.isStudentSelected(n,e.id);return t&&(e.isPlaceholder=!0),t}):E.groupedStudents[n].filter(function(e){var t=d.isStudentSelected(n,e.id);return t&&(e.isPlaceholder=!0),t})}function f(e,t,n){S.show(S.alert().clickOutsideToClose(!0).title(t.username).htmlContent('<div>Password: <span class="passworddisplaydialog">'+t.password+"</span></div>"+(n?"<div><strong>Note:</strong> This may take a few minutes to take effect. Please be patient.":"")).ariaLabel("Confirm student password").ok("OK").targetEvent(e))}function O(t){e(function(){var e=document.getElementById(t);r.duScrollToElementAnimated(angular.element(e))},0)}d.updateStudentSelection=function(e,t){p[e]||(p[e]=[]);var n=p[e].indexOf(t);-1<n?p[e].splice(n,1):p[e].length<d.MAX_PER_GROUP&&p[e].push(t)},d.selectAllStudents=function(e){d.areAllStudentsSelected(e)?p[e]=[]:p[e]="ungrouped"===e?E.ungroupedStudents.map(function(e){return e.id}):E.groupedStudents[e].map(function(e){return e.id})},d.isStudentSelected=function(e,t){return p[e]||(p[e]=[]),-1<p[e].indexOf(t)},d.areStudentsSelected=function(e){return p[e]&&0<p[e].length},d.areAllStudentsSelected=function(e){return"ungrouped"===e?p[e]&&E.ungroupedStudents&&p[e].length===E.ungroupedStudents.length:p[e]&&E.groupedStudents[e]&&p[e].length===E.groupedStudents[e].length}}angular.module("app").controller("TeacherStudentsController",e),e.$inject=["authService","usersService","$scope","$mdDialog","$document","$timeout","loggerService"]}(),function(){function e(e,n,r,a,o,i){var s=this,c=(s.authService=e,o.submittingDeleteRequest=!1,1);function l(e,t,n){var r=c++;s[e].push({alertid:r,message:(n=n||{}).message||n.error||"Unknown error",status:t})}s.errors=[],s.warnings=[],s.dismissAlert=function(e,t){s[e].splice(t,1)},s.orderBy="name",e.getProfileDeferred().then(function(e){var t;"supervisor"===(s.profile=e).role&&(t=e,i.debug("[ml4ksupervise] refreshing projects list"),n.getClassProjects(t).then(function(e){i.debug("[ml4ksupervise] got projects list"),s.projects=e;for(var t=0;t<s.projects.length;t++){var n=s.projects[t];if(0<n.labels.length){var r="";switch(n.labels.length){case 1:r=n.labels[0];break;case 2:r=n.labels[0]+" or "+n.labels[1];break;case 3:r=n.labels[0]+", "+n.labels[1]+" or "+n.labels[2];break;default:r=n.labels[0]+", "+n.labels[1]+" or "+(n.labels.length-2)+" other classes"}n.labelsSummary=r}}}).catch(function(e){i.error("[ml4ksupervise] failed to get projects list",e),l("errors",e.status,e.data)}),t=e,i.debug("[ml4ksupervise] refreshing classifiers list"),r.getUnmanagedClassifiers(t.tenant).then(function(e){i.debug("[ml4ksupervise] got classifiers list"),s.classifiers=e}).catch(function(e){i.debug("[ml4ksupervise] failed to get classifiers list"),e&&e.status&&403===e.status||i.error(e)}))}).catch(function(e){l("errors",e.status,e.data)}),s.deleteModel=function(e,t){i.debug("[ml4ksupervise] deleting model");e=a.confirm().title("Are you sure?").textContent("Do you want to delete "+(t.owner?t.owner.username+"'s ":"")+"machine learning model from project "+t.name+"?").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");a.show(e).then(function(){i.debug("[ml4ksupervise] submitting model deletion request"),t.hasModel=!1,r.deleteModel(t,t.userid,t.classid,t.classifierId).then(function(){i.debug("[ml4ksupervise] model deletion successful")}).catch(function(e){i.error("[ml4ksupervise] failed to delete model",e),l("errors",e.status,e.data)})},function(){})},s.deleteClassifier=function(e,t){i.debug("[ml4ksupervise] deleting classifier"),o.submittingDeleteRequest=!0;e=a.confirm().title("Are you sure?").textContent("Do you want to delete "+t.name+"?").ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");a.show(e).then(function(){i.debug("[ml4ksupervise] submitting classifier deletion request"),r.deleteBluemixClassifier(s.profile.tenant,t.id,t.credentials.id,t.type).then(function(){i.debug("[ml4ksupervise] classifier deletion successful"),o.submittingDeleteRequest=!1,s.classifiers[t.type]=s.classifiers[t.type].filter(function(e){return e.id!==t.id})}).catch(function(e){i.error("[ml4ksupervise] failed to delete classifier",e),o.submittingDeleteRequest=!1,l("errors",e.status,e.data)})},function(){})}}angular.module("app").controller("TeacherProjectsController",e),e.$inject=["authService","projectsService","trainingService","$mdDialog","$scope","loggerService"]}(),angular.module("app").directive("httpSrc",["$http",function(r){return{link:function(e,t,s){var n={method:"Get",url:s.httpSrc,responseType:"arraybuffer",cache:"true"};r(n).then(function(e){for(var t,n=e.headers("content-type"),r=new Uint8Array(e.data),a="",o=0,i=r.length;o<i;o+=5e3)t=r.subarray(o,o+5e3),a+=String.fromCharCode.apply(null,t);e=btoa(a);s.$set("src","data:"+n+";base64,"+e)})},restrict:"A"}}]),angular.module("app").directive("ignoreDrop",function(){function r(e){return e&&e.preventDefault&&e.preventDefault(),!1}return{link:function(e,t,n){(t=t[0]).addEventListener("drop",r),t.addEventListener("dragover",r)}}}),angular.module("app").directive("mlImageLoader",function(){function i(e){return e&&e.preventDefault&&e.preventDefault(),e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),!1}var S=/^https:\/\/www\.google\.co[a-z.]+\/imgres\?(imgurl=.*)/,E=/^https:\/\/timgsa.baidu.com\/timg\?.*/,g=/^https:\/\/images?.baidu.com\/search\/detail.*/,T=/^https?:\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)(\.jpg|\.png)\??.*$/;function p(e,t){return e&&e.indexOf&&-1!==e.indexOf(t)?t:"Text"}function m(e){return O(e,"Sorry, that type of image is not supported. You can only use jpg or png pictures"),!1}function f(e){return e&&"string"==typeof e&&("data:image"===e.substr(0,10)||"blob:"===e.substr(0,5)||"x-raw-image"===e.substr(0,11)||"file:"===e.substr(0,5))}function s(e,t,n){if(e&&e.dataTransfer){e.preventDefault&&e.preventDefault();var a,r="local"===n.$parent.project.storage;if(e.dataTransfer&&e.dataTransfer.types&&1===e.dataTransfer.types.length&&"Files"===e.dataTransfer.types[0])if(r)for(var o=0;o<e.dataTransfer.files.length;o++){var i=e.dataTransfer.files[o];["image/jpeg","image/png"].includes(i.type)?n.getController().addImageFile(i,t,o===e.dataTransfer.files.length-1):(console.log("dropped file type "+i.type),m(n))}else O(n,"You can't upload pictures from your computer. Use pictures that are already online, by dragging them from another web page");else{if(e.dataTransfer.types&&0<e.dataTransfer.types.length){r=p(e.dataTransfer.types,"text/uri-list"),r=e.dataTransfer.getData(r);if(f(r))return m(n);if(r){var s,c,l,u=r.match(S);u&&(u=u[1],a={},u.split("&").forEach(function(e){var t,n,r;e&&(r=-1<(t=(e=e.split("+").join(" ")).indexOf("="))?e.substr(0,t):e,e=-1<t?decodeURIComponent(e.substr(t+1)):"",-1===(t=r.indexOf("["))?a[decodeURIComponent(r)]=e:(n=r.indexOf("]",t),n=decodeURIComponent(r.substring(t+1,n)),r=decodeURIComponent(r.substring(0,t)),a[r]||(a[r]=[]),n?a[r][n]=e:a[r].push(e)))}),s=a.imgurl);try{s||r.match(E)&&(l=new URL(r))&&l.searchParams&&l.searchParams.has&&l.searchParams.has("src")&&(s=l.searchParams.get("src")),s||r.match(g)&&(c=new URL(r))&&c.searchParams&&c.searchParams.has&&c.searchParams.has("objurl")&&(s=c.searchParams.get("objurl"))}catch(e){console.log(e)}if((s=!s&&(u=p(e.dataTransfer.types,"text/html"),l=e.dataTransfer.getData(u),c=l,(u=document.implementation.createHTMLDocument("title")).body.innerHTML=c,l=u.querySelector("img"))?l.src:s)||r.match(T)&&(s=r),s){0===s.indexOf("https://gimg2.baidu.com/image_search/src=")&&(s=s.replace("https://gimg2.baidu.com/image_search/src=","https://gimg2.baidu.com/image_search?src="));try{var d=new URL(s);d&&d.searchParams&&d.searchParams.has&&d.searchParams.has("src")&&(s=d.searchParams.get("src"))}catch(e){console.log(e)}}}}if(s=s||e.dataTransfer.getData("Text")){if(f(s))return m(n);n.getController().addConfirmedTrainingData(s,t),n.$apply()}else O(n,"Drag a picture from another web page into one of the training buckets")}}return!1}function O(e,t){e.getController().displayAlert&&(e.getController().displayAlert("warnings",400,{message:t}),e.$apply())}return{link:function(t,n,e){var r=n[0],a=t.$parent.label,o=(r.addEventListener("dragover",i),0);r.addEventListener("dragleave",function(e){return 0===--o&&angular.element(e.target).removeClass("hover"),i(e)}),r.addEventListener("dragenter",function(e){return o+=1,angular.element(e.target).addClass("hover"),i(e)}),r.addEventListener("drop",function(e){if(e&&e.dataTransfer)return o=0,angular.element(e.target).removeClass("hover"),n.removeClass("hover"),angular.element(document.querySelector(".trainingbucketitems.hover")).removeClass("hover"),s(e,a,t)})}}}),angular.module("app").directive("mlImageOnError",function(){return{link:function(e,t,n){t.bind("error",function(){e.$apply(n.mlImageOnError)})}}}),function(){function e(e,r,l,a,o,c,u,i,s,d,t,S,E,g,T,n){var p=this,m=(p.authService=e,1),f=1;function O(e,t,n){n?(d.error(n),500===t&&Sentry&&Sentry.captureException&&Sentry.captureException({error:n,errortype:typeof n})):n={},p[e].push({alertid:f++,message:n.message||n.error||"Unknown error",status:t})}function R(){var e,t,n="";0<S.project.labels.length?(t="sounds"===S.project.type?S.project.labels.filter(function(e){return"_background_noise_"!==e}):S.project.labels,n=a.generateProjectSummary(t," or ")||""):"regression"===S.project.type&&(e=(t=S.project.columns||[]).filter(e=>e.output).map(e=>e.label),n=a.generateProjectSummary(e," and ")||"something",t=t.length-e.length)&&(S.columnsSummary=" from "+t+" input values"),S.project.labelsSummary=n}function h(){try{S.$apply()}catch(e){d.debug("[ml4ktraining] unable to refresh",e)}}function A(e){return e&&404===e.status&&e.data&&"Not found"===e.data.error}function I(n,r){S.$applyAsync(function(){var e,t=document.getElementById(n.toString());t?(e=t.parentElement,angular.element(e).duScrollToElementAnimated(angular.element(t))):r?d.error("[ml4ktraining] unable to scroll to new item",n):T(function(){I(n,!0)},0)})}function H(e,t){for(var n=S.training[e].length,r=0;r<n;r++)if(S.training[e][r].id===t)return r;return-1}p.errors=[],p.warnings=[],p.dismissAlert=function(e,t){p[e].splice(t,1)},p.displayAlert=O,S.loadingtraining=!0,S.crowdSourced=!1,S.reviewing=t.review,S.projectId=t.projectId,S.userId=t.userId,S.training={},e.getProfileDeferred().then(function(e){return p.profile=e,d.debug("[ml4ktraining] getting project info"),r.getProject(S.projectId,S.userId,e.tenant)}).then(function(e){return d.debug("[ml4ktraining] project",e),S.project=e,S.crowdSourced=e.isCrowdSourced&&p.profile.user_id!==e.userid,"numbers"===e.type?(d.debug("[ml4ktraining] getting project fields"),r.getFields(S.project,S.userId,p.profile.tenant).then(function(e){S.project.fields=e,S.projectfieldnames=e.map(function(e){return e.name}),d.debug("[ml4ktraining] field names",S.projectfieldnames)})):"sounds"===e.type?(d.debug("[ml4ktraining] setting up sound model support"),o.initSoundSupport(e.id,e.labels,!1).then(function(e){S.soundModelInfo=o.getModelInfo(),e&&e.warning&&O("warnings",500,e.warning)})):"imgtfjs"===e.type?(d.debug("[ml4ktraining] fetching image project dependencies"),c.loadImageProjectSupport()):void 0}).then(function(){for(var e in R(),S.project.labels){e=S.project.labels[e];S.training[e]=[]}return d.debug("[ml4ktraining] getting training data"),l.getTraining(S.projectId,S.userId,p.profile.tenant)}).then(function(e){if("regression"===S.project.type)S.training=e,S.regressionmode="init",S.$watch("project.columns",function(e,t){R(),e&&!angular.equals(e,t)&&(r.addMetadataToProject(S.project,"columns",e).catch(function(e){O("errors",500,e)}),a.deleteModel(S.project.type,S.project.id).catch(function(e){d.error("[ml4ktraining] failed to delete model",e)}))},!0);else for(var t in e){var t=e[t],n=t.label;n in S.training==!1&&(S.training[n]=[]),S.training[n].push(t),"sounds"===S.project.type&&l.getSoundData(t)}S.loadingtraining=!1}).catch(function(e){d.error("[ml4ktraining] error",e),O("errors",e.status,e.data||e)}),p.addTrainingData=function(e,t){d.debug("[ml4ktraining] addTrainingData"),E.show({locals:{label:t,project:S.project},controller:["$scope","locals",function(n,e){n.label=e.label,n.project=e.project,n.values={},n.hide=function(){E.hide()},n.cancel=function(){E.cancel()},n.confirm=function(e){E.hide(e)},n.submitOnEnter=function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),n.confirm(n.example))},n.$watch("example",function(e,t){n&&n.example&&e!==t&&(n.example=e.replace(/[\r\n\t]/g," "))},!0)}],templateUrl:"static/components/training/trainingdata.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){if("imgtfjs"===S.project.type)try{e=new URL(e).toString()}catch(e){d.debug("[ml4ktraining] unable to escape URL characters, using raw string",e)}p.addConfirmedTrainingData(e,t)},function(){})},p.addConfirmedTrainingData=function(e,t){d.debug("[ml4ktraining] addConfirmedTrainingData");var n,r,a,o,i=!1,s=l.newTrainingData;if("text"===S.project.type?(r=(n=e).toLowerCase(),i=S.training[t].some(function(e){return e.textdata.toLowerCase()===r}),a={id:"placeholder_"+m++,label:t,projectid:S.projectId,textdata:n,isPlaceholder:!0}):"numbers"===S.project.type?(o=e,n=(S.projectfieldnames||Object.keys(o)).map(function(e){return(o[e].includes(".")?parseFloat:parseInt)(o[e])}),a={id:"placeholder_"+m++,label:t,projectid:S.projectId,numberdata:n,isPlaceholder:!0}):"imgtfjs"===S.project.type?(n=e,i=S.training[t].some(function(e){return e.imageurl===n}),a={id:"placeholder_"+m++,label:t,projectid:S.projectId,imageurl:n,isPlaceholder:!0}):"sounds"===S.project.type&&(n=Array.prototype.slice.call(e),a={id:"placeholder_"+m++,label:t,projectid:S.projectId,audiodata:n,isPlaceholder:!0},s=l.uploadSound),i)return O("errors",400,{message:"That is already in your training data"});S.training[t].push(a),d.debug("[ml4ktraining] storing training data"),s(S.projectId,S.userId,p.profile.tenant,S.project.type,S.project.storage,n,t).then(function(e){a.isPlaceholder=!1,a.id=e.id,"imgtfjs"===S.project.type&&a.imageurl&&c.isGoogleFilesUrl(a.imageurl)&&O("warnings",400,{message:"Google often removes access to images on googleusercontent.com and lh3.google.com, which might prevent you training a model with this image"}),I(e.id)}).catch(function(e){if(A(e))return g.go("projects");O("errors",e.status,e.data);e=H(t,a.id);-1!==e&&S.training[t].splice(e,1)})},p.onImageLoad=function(e){d.debug("[ml4ktraining] onImageLoad"),d.debug(e)},p.onImageError=function(e){e.loadingFailed=!0},p.addLabel=function(e){E.show({controller:["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/training/newlabel.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){d.debug("[ml4ktraining] adding a new label",e),r.addLabelToProject(S.project,S.userId,p.profile.tenant,e).then(function(e){S.project.labels=e;for(var t=0;t<e.length;t++)S.training[e[t]]||(S.training[e[t]]=[]);R(),"local"===S.project.storage&&h()}).catch(function(e){if(A(e))return g.go("projects");O("errors",e.status,e.data)})},function(){})},p.deleteText=function(e,t,n){S.training[e].splice(n,1),l.deleteTrainingData(S.projectId,S.userId,p.profile.tenant,t.id).catch(function(e){O("errors",e.status,e.data)})},p.deleteLabel=function(e,t,n){e=E.confirm().title("Are you sure?").textContent('Do you want to delete "'+t+'"? (This cannot be undone)').ariaLabel("Confirm").targetEvent(e).ok("Yes").cancel("No");E.show(e).then(function(){delete S.training[t],S.project.labels.splice(n,1),R(),r.removeLabelFromProject(S.project,S.userId,p.profile.tenant,t).catch(function(e){O("errors",e.status,e.data)})},function(){})},p.addImageFile=function(e,t,n){s.getDataFromFile(e).then(function(e){p.addImageData(e,t,n)})},p.useWebcam=function(e,t){E.show({locals:{label:t,project:S.project},controller:["$scope","locals",function(n,e){function r(e){d.error("[ml4ktraining] displaying webcam error",e),(n.webcamerror=e)&&e.message&&("NotAllowedError"===e.name?n.webcamerrordetail="Not allowed to use the web-cam":n.webcamerrordetail=e.message)}n.label=e.label,n.project=e.project,n.values={},n.channel={},n.webcamerror=!1,n.webcamInitComplete=!1,n.webcamCanvas=null,n.hide=function(){E.hide()},n.cancel=function(){E.cancel()},n.confirm=function(){s.getDataFromImageSource(n.channel.video,"image/jpeg").then(function(e){E.hide(e)})},n.onWebcamSuccess=function(){n.$apply(function(){n.webcamInitComplete=!0})},n.onWebcamError=function(t){d.error("[ml4ktraining] webcam error",t),n.webcamInitComplete=!0;try{n.$apply(function(){r(t)})}catch(e){T(function(){r(t)},0,!1)}}}],templateUrl:"static/components/training/webcam.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){p.addImageData(e,t,!0)},function(){})},p.useCanvas=function(e,t){E.show({locals:{label:t,project:S.project},controller:["$scope","locals",function(e,t){e.label=t.label,e.project=t.project,e.values={},e.hide=function(){E.hide()},e.cancel=function(){E.cancel()},e.confirm=function(){s.getDataFromImageSource(e.canvas,"image/jpeg").then(function(e){E.hide(e)})}}],templateUrl:"static/components/training/canvas.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){p.addImageData(e,t,!0)},function(){})},p.addImageData=function(e,t,n){var r={id:"placeholder_"+m++,label:t,projectid:S.projectId,imageurl:URL.createObjectURL(e),isPlaceholder:!0};S.training[t].push(r),d.debug("[ml4ktraining] adding image data"),l.uploadImage(S.project,S.userId,p.profile.tenant,e,t).then(function(e){r.isPlaceholder=!1,r.id=e.id,n&&I(e.id),T(function(){URL.revokeObjectURL(r.imageurl)},1e4)}).catch(function(e){O("errors",e.status,e.data);e=H(t,r.id);-1!==e&&S.training[t].splice(e,1)})},p.useMicrophone=function(e,t){E.show({locals:{label:t,project:S.project,soundModelInfo:o.getModelInfo()},controller:["$scope","locals",function(n,e){n.label=e.label,n.project=e.project,n.soundModelInfo=e.soundModelInfo,n.values={},n.hide=function(){E.hide()},n.cancel=function(){E.cancel()},n.confirm=function(e){E.hide(e)},n.recordSound=function(e){delete n.example,n.recording=!0,n.recordingprogress=0;var t=setInterval(function(){n.$apply(function(){n.recordingprogress+=10})},100);o.collectExample(e).then(function(e){clearInterval(t),n.$apply(function(){n.recordingprogress=100,e&&e.data&&0<e.data.length&&(n.example=e.data),n.recording=!1})}).catch(function(e){clearInterval(t),n.$apply(function(){n.recording=!1,O("errors",500,e)})})}}],templateUrl:"static/components/training/trainingdata.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){p.addConfirmedTrainingData(e,t)},function(){})},S.downloadTrainingData=function(e,t){var n;d.debug("[ml4ktraining] downloading training data to file"),"text"===S.project.type?i.downloadFile(S.training[t].map(e=>e.textdata+"\n"),"text/plain",t+".txt"):"numbers"===S.project.type?(n=S.training[t].map(n=>{const r={};return S.project.fields.forEach((e,t)=>{"multichoice"===e.type?r[e.name]=e.choices[n.numberdata[t]]:r[e.name]=n.numberdata[t]}),r}),u.exportFile(n,S.projectfieldnames).then(function(e){i.downloadFile([e],"text/csv",t+".csv")}).catch(function(e){O("errors",500,e)})):"regression"===S.project.type&&u.exportFile(S.training,S.project.columns.map(e=>e.label)).then(function(e){i.downloadFile([e],"text/csv","training-"+S.project.id+".csv")}).catch(function(e){O("errors",500,e)})},S.uploadTrainingData=function(e,t){d.debug("[ml4ktraining] uploading training data from file");var n=e.currentTarget.files;if(n&&0<n.length){n=e.currentTarget.files[0];if("regression"===S.project.type)u.parseFile(n).then(function(n){if(S.project.columns&&0<S.project.columns.length){if(!angular.equals(n.meta.fields,S.project.columns.map(e=>e.label)))throw new Error("The columns in the CSV file do not match the columns you have in this project")}else S.project.columns=n.meta.fields.map(function(e){var t={label:e,output:!1};return 0<n.data.length?t.type=typeof n.data[0][e]:t.type="unknown",t});return S.$applyAsync(()=>{S.loadingtraining=!0}),l.bulkAddTrainingData(S.project,n.data)}).then(function(e){S.training=S.training.concat(e),S.$applyAsync(()=>{S.loadingtraining=!1})}).catch(function(e){S.$applyAsync(()=>{S.loadingtraining=!1}),O("errors",400,e)});else if("numbers"===S.project.type){const i=t.dataset.label;u.parseFile(n).then(function(e){if(angular.equals(e.meta.fields,S.project.fields.map(e=>e.name)))return l.bulkAddTrainingData(S.project,{label:i,numbers:e.data});throw new Error("The columns in the CSV file do not match the fields you have in this project")}).then(function(e){S.training[i]=S.training[i].concat(e)}).catch(function(e){O("errors",400,e)})}else if("text"===S.project.type){const s=t.dataset.label,c=new FileReader;c.readAsText(n),c.onload=function(){l.bulkAddTrainingData(S.project,c.result.split(/[\r\n]+/).map(e=>e.substring(0,1024).trim()).filter(e=>0<e.length).reduce((e,t)=>e.includes(t)?e:[...e,t],[]).map(function(e){return{label:s,textdata:e}})).then(function(e){S.training[s]=S.training[s].concat(e),h()}).catch(function(e){O("errors",500,e)})},c.onerror=function(){O("errors",500,c.error)}}else if("imgtfjs"===S.project.type)for(var r=t.dataset.label,a=0;a<e.currentTarget.files.length;a++){var o=a===e.currentTarget.files.length-1;p.addImageFile(e.currentTarget.files[a],r,o)}}},p.addRegressionColumn=function(e){E.show({controller:["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.confirm=function(e){t.hide(e)}}],templateUrl:"static/components/training/newcolumn.tmpl.html",targetEvent:e,clickOutsideToClose:!0}).then(function(e){d.debug("[ml4ktraining] adding a new column",e),S.project.columns||(S.project.columns=[]),S.project.columns.push({label:e,output:!1,type:"number"})},function(){})},p.deleteAllRegression=function(e){S.training=[],l.clearTrainingData(S.project)},p.deleteRegressionItem=function(e){var t=S.training.indexOf(e);-1<t&&(S.training.splice(t,1),l.deleteTrainingData(S.projectId,S.userId,p.profile.tenant,e.id).catch(function(e){O("errors",e.status,e.data)}))},p.setRegressionMode=function(e){S.regressionmode=e},S.$on("$destroy",function(){d.debug("[ml4ktraining] handling page change"),S.project&&"sounds"===S.project.type&&o.reset()}),S.getController=function(){return p}}angular.module("app").controller("TrainingController",e),e.$inject=["authService","projectsService","trainingService","modelService","soundTrainingService","utilService","csvService","downloadService","imageToolsService","loggerService","$stateParams","$scope","$mdDialog","$state","$timeout","$q"]}(),function(){function e(l,a,u){var d=/[\t\n]/g;function o(t,e,n,r,a,o,i){var s,c;if("local"!==a)return s="/api/classes/"+n+"/students/"+e+"/projects/"+t+"/training",l.post(s,{data:o,label:i}).then(function(e){return e.data});if("imgtfjs"===r)return s="/api/classes/"+n+"/students/"+e+"/training/images",l.get(s,{params:{imageurl:o,label:i,option:"check"}}).then(function(e){return c=e.data,l.get(s,{responseType:"arraybuffer",params:{imageurl:o,label:i,option:"prepare"}})}).then(function(e){return c.imagedata=e.data,u.addTrainingData(t,c)});if("text"===r)return c={textdata:o.replace(d," "),label:i},u.addTrainingData(t,c);if("numbers"===r)return c={numberdata:o,label:i},u.addTrainingData(t,c);throw new Error("unexpected project type")}return{newTrainingData:o,bulkAddTrainingData:function(n,e,t,r){if("local"===n.storage)return"text"===n.type?u.bulkAddTrainingData(n.id,e.map(function(e){return{textdata:e.textdata.replace(d," "),label:e.label}})):"regression"===n.type?u.bulkAddTrainingData(n.id,e):"numbers"===n.type?u.bulkAddTrainingData(n.id,e.numbers.map(t=>({numberdata:n.fields.map(e=>"number"===e.type?t[e.name]:"multichoice"===e.type?e.choices.indexOf(t[e.name]):void 0),label:e.label}))):"imgtfjs"===n.type?a.all(e.map(e=>o(n.id,t,r,n.type,n.storage,e.imageurl,e.label))):void 0;throw new Error("unexpected project type")},uploadImage:function(e,t,n,r,a){return"local"===e.storage?u.addTrainingData(e.id,{imagedata:r,isstored:!0,label:a}).then(function(e){return e.imageurl=URL.createObjectURL(e.imagedata),e}):(n="/api/classes/"+n+"/students/"+t+"/projects/"+e.id+"/images",(t=new FormData).append("image",r,"webcam.jpg"),t.append("label",a),e={transformRequest:angular.identity,headers:{"Content-Type":void 0}},l.post(n,t,e).then(function(e){return e.data}))},uploadSound:function(e,t,n,r,a,o,i){return"local"===a?u.addTrainingData(e,{audiodata:o,label:i}).then(function(e){return e}):l.post("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/sounds",{data:o,label:i}).then(function(e){return e.data})},getSoundData:function(t){return t.audiodata?Promise.resolve(t):l.get(t.audiourl).then(function(e){return t.audiodata=e.data,t})},getTraining:function(e,t,n){return u.idIsLocal(e)?u.getTrainingData(e).then(function(e){return e.map(function(e){return!e.imageurl&&e.imagedata&&(e.imageurl=URL.createObjectURL(e.imagedata)),e})}):l.get("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/training",{headers:{Range:"items=0-3000"}}).then(function(e){return e.data})},getTrainingItem:function(e,t,n,r){return u.idIsLocal(e)?u.getTrainingDataItem(e,r):l.get("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/training/"+r,{responseType:"arraybuffer"}).then(function(e){return e.data}).catch(function(e){throw e.status&&(e.data=JSON.parse((new TextDecoder).decode(e.data))),e})},deleteTrainingData:function(e,t,n,r){return u.idIsLocal(e)?u.deleteTrainingData(e,r):l.delete("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/training/"+r)},clearTrainingData:function(e){if("local"!==e.storage||"regression"!==e.type)throw new Error("unexpected project type");return u.clearTrainingData(e.id)},getModels:function(t,e,n){var r;if("local"===t.storage){if("text"!==t.type)return Promise.resolve([]);if(!t.cloudid)return Promise.resolve([]);r="/api/classes/"+n+"/students/"+e+"/localprojects/"+t.cloudid+"/models"}else r="/api/classes/"+n+"/students/"+e+"/projects/"+t.id+"/models";return l.get(r).then(function(e){var t=e.data;if(t)for(var n=new Date,r=0;r<t.length;r++)t[r].lastPollTime=n;return t}).catch(function(e){if("local"===t.storage&&"text"===t.type)return u.addCloudRefToProject(t.id,null),delete t.cloudid,[];throw e})},getModel:function(e,t,n,r,a){return l.get("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/models/"+r+"?ts="+a).then(function(e){return e.data})},newModel:function(e,t,n){return l.post("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/models",{},{timeout:18e4}).then(function(e){return e.data.lastPollTime=new Date,e.data})},newLocalProjectTextModel:function(t){var n="/api/classes/"+t.classid+"/students/"+t.userid+"/localprojects/"+t.cloudid+"/models";return u.getTrainingForWatsonAssistant(t).then(function(e){return l.post(n,{training:e},{timeout:18e4})}).then(function(e){return e.data.lastPollTime=new Date,e.data}).catch(function(e){throw 404===e.status&&(u.addCloudRefToProject(t.id,null),delete t.cloudid),e})},newLocalProjectNumbersModel:function(t){var n="/api/classes/"+t.classid+"/students/"+t.userid+"/localnumbersprojects";return u.getTrainingData(t.id).then(function(e){return l.post(n,{project:t,training:e},{timeout:18e4})}).then(function(e){return e.data.lastPollTime=new Date,u.addCloudRefToProject(t.id,e.data.key),t.cloudid=e.key,e.data})},testModel:function(e,t,n,r,a,o){return n="local"===e.storage?"/api/classes/"+n+"/students/"+t+"/localprojects/"+e.cloudid+"/models/"+r+"/label":"/api/classes/"+n+"/students/"+t+"/projects/"+e.id+"/models/"+r+"/label",o.credentialsid=a,l.post(n,o).then(function(e){return e.data})},testModelPrep:function(e,t,n,r,a){return l.post("/api/classes/"+n+"/students/"+t+"/projects/"+e+"/models/"+r+"/label",a,{responseType:"arraybuffer"}).then(function(e){return e.data}).catch(function(e){throw e.status&&(e.data=JSON.parse((new TextDecoder).decode(e.data))),e})},deleteModel:function(e,t,n,r){return n="local"===e.storage?"/api/classes/"+n+"/students/"+t+"/localprojects/"+e.cloudid+"/models/"+r:"/api/classes/"+n+"/students/"+t+"/projects/"+e.id+"/models/"+r,l.delete(n)},getUnmanagedClassifiers:function(e){return l.get("/api/classes/"+e+"/classifiers",{params:{type:"unmanaged"}}).then(function(e){return e.data})},deleteBluemixClassifier:function(e,t,n,r){return l.delete("/api/classes/"+e+"/classifiers/"+t,{params:{type:r,credentialsid:n}})}}}angular.module("app").service("trainingService",e),e.$inject=["$http","$q","browserStorageService"]}(),function(){function e(o){function i(e){return e.data}return{createTeacher:function(e,t,n){return o.post("/api/teachers",{username:e,email:t,notes:n}).then(i)},addCredentials:function(e,t){return o.post("/api/classes/"+t+"/credentials",e).then(i)},getCredentials:function(e,t){return o.get("/api/classes/"+e.tenant+"/credentials?servicetype="+t).then(i)},modifyCredentials:function(e,t,n,r){return o.patch("/api/classes/"+r+"/credentials/"+e.id,[{op:"replace",path:"/credstype",value:{servicetype:t,credstype:n}}]).then(i)},verifyCredentials:function(e,t){return o.get("/api/classes/"+e.tenant+"/credentials/"+t.id)},deleteCredentials:function(e,t){return o.delete("/api/classes/"+e.tenant+"/credentials/"+t.id)},getGeneratedPassword:function(e){return o.get("/api/classes/"+e+"/passwords").then(i)},getClassPolicy:function(e){return o.get("/api/classes/"+e.tenant+"/policy").then(i)},modifyClassPolicy:function(e,t){return o.patch("/api/classes/"+e.tenant+"/policy",[{op:"replace",path:"/textClassifierExpiry",value:t}]).then(i)},getStudentList:function(e,t){return o.get("/api/classes/"+e.tenant+"/students?group="+t).then(i)},createStudent:function(e,t){return e={username:e.username,group:e.group},o.post("/api/classes/"+t+"/students",e).then(i)},createStudents:function(e,t,n,r,a){return o.put("/api/classes/"+e+"/students",{prefix:t,number:n,password:r,group:a}).then(i)},deleteStudent:function(e,t){return o.delete("/api/classes/"+t+"/students/"+e.id)},deleteStudents:function(e,t){return e=e.map(function(e){return{op:"remove",path:"/students",value:{user:e}}}),o.patch("/api/classes/"+t,e).then(i)},resetStudentPassword:function(e,t){return o.post("/api/classes/"+t+"/students/"+e.id+"/password").then(i)},resetStudentsPassword:function(e,t){return e=e.map(function(e){return{op:"replace",path:"/password",value:{id:e.id}}}),o.patch("/api/classes/"+t+"/students",e).then(i)},addStudentsToGroup:function(e,t,n){return e=e.map(function(e){return{op:"replace",path:"/group",value:{group:n,user:e}}}),o.patch("/api/classes/"+t+"/students",e).then(i)},removeStudentsFromGroup:function(e,t){return e=e.map(function(e){return{op:"remove",path:"/group",value:{user:e}}}),o.patch("/api/classes/"+t+"/students",e).then(i)},createClassGroup:function(e,t){return o.patch("/api/classes/"+e.tenant,[{op:"add",path:"/groups",value:t}]).then(i)},deleteClassGroup:function(e,t){return o.patch("/api/classes/"+e.tenant,[{op:"remove",path:"/groups",value:t}]).then(i)},deleteClass:function(e){return o.delete("/api/classes/"+e.tenant+"?confirm=true")}}}angular.module("app").service("usersService",e),e.$inject=["$http"]}(),function(){function e(t,n,r){return{deleteProject:function(e){t.debug("[ml4kstorage] cleaning up local storage for project",e),"sounds"===e.type?n.deleteModel("sounds",e.id):"imgtfjs"===e.type?n.deleteModel("images",e.id):"regression"===e.type?n.deleteModel("regression",e.id):"numbers"===e.type&&n.deleteModel("numbers",e.id),r.removeItem("testdata://"+e.id)}}}angular.module("app").service("cleanupService",e),e.$inject=["loggerService","modelService","storageService"]}(),function(){function e(e,r,t){function a(){return e.loadScript("/static/bower_components/papaparse/papaparse.min.js")}const o={delimiter:"",header:!0,dynamicTyping:!0,skipEmptyLines:!0,preview:0,worker:!0,comments:!1};return{parseFile:function(n){return a().then(function(){return r.debug("[ml4kcsv] loading csv file"),t(function(e,t){e=Object.assign({complete:e,error:t},o);Papa.parse(n,e)})})},exportFile:function(e,t){return a().then(function(){return r.debug("[ml4kcsv] creating csv file"),Papa.unparse(e,{columns:t})})}}}angular.module("app").service("csvService",e),e.$inject=["utilService","loggerService","$q"]}(),function(){function e(r){return{downloadFile:function(e,t,n){e&&(e=new Blob(e,{type:t}),r.navigator.msSaveOrOpenBlob?r.navigator.msSaveBlob(e,n):((t=document.createElement("a")).href=r.URL.createObjectURL(e),t.download=n,document.body.appendChild(t),t.click(),document.body.removeChild(t)))}}}angular.module("app").service("downloadService",e),e.$inject=["$window"]}(),function(){function e(e){const i=224;function a(a,o){return e(function(t){var e=a.width,n=a.height,r=(n<e?e>i&&(n*=i/e,e=i):n>i&&(e*=i/n,n=i),document.createElement("canvas"));r.width=e,r.height=n,r.getContext("2d").drawImage(a,0,0,e,n),r.toBlob(function(e){t(e)},o)})}return{getDataFromFile:function(r){return e(function(t){var n=new FileReader;n.readAsDataURL(r),n.onloadend=function(){var e=document.createElement("img");e.onload=function(){a(e,r.type).then(function(e){t(e)})},e.src=n.result}})},getDataFromImageSource:a,resizeImageElement:function(e){var t=document.createElement("canvas"),n=(t.width=i,t.height=i,e.videoWidth||e.width),r=e.videoHeight||e.height;return t.getContext("2d").drawImage(e,0,0,n,r,0,0,i,i),t}}}angular.module("app").service("imageToolsService",e),e.$inject=["$q"]}(),function(){function e(t,n){var r,a,o,i;function s(){t.debug("[ml4kutils] Confirming local storage is available");var e=!1;try{n.localStorage&&(t.debug("[ml4kutils] Testing local storage"),n.localStorage.setItem("confirmLocalStorage",1),n.localStorage.removeItem("confirmLocalStorage"),t.debug("[ml4kutils] Confirmed local storage available"),e=!0)}catch(e){t.error("[ml4kutils] Failed local storage verification"),t.error(e)}i=e?(r=n.localStorage.clear.bind(localStorage),a=n.localStorage.setItem.bind(localStorage),o=n.localStorage.getItem.bind(localStorage),n.localStorage.removeItem.bind(localStorage)):(n._tempLocalStorage={},r=function(){n._tempLocalStorage={}},a=function(e,t){n._tempLocalStorage[e]=t},o=function(e){return n._tempLocalStorage[e]},function(e){delete n._tempLocalStorage[e]})}return{confirmLocalStorage:s,clear:function(){r||s(),r()},setItem:function(e,t){a||s(),a(e,t)},getItem:function(e){return o||s(),o(e)},removeItem:function(e){i||s(),i(e)}}}angular.module("app").service("storageService",e),e.$inject=["loggerService","$window"]}(),function(){function e(e,o){function t(a){return e(function(e,t){var n,r="mlforkids-script-"+a;document.getElementById(r)?e():(o.debug("[ml4kutils] loading script",a),(n=document.createElement("script")).id=r,n.type="text/javascript",n.src=a,n.onreadystatechange=e,n.onload=e,n.onerror=t,document.head.appendChild(n))})}var n=/^https:\/\/lh[1-9]\.google(?:usercontent)?\.com\/.*/;return{loadScript:t,loadTensorFlow:function(){return t("/static/bower_components/tfjs/tf.min.js?v=179")},loadImageProjectSupport:function(){return t("/static/bower_components/blueimp-canvas-to-blob/js/canvas-to-blob.min.js")},loadNumberProjectSupport:function(){return t("/static/bower_components/tfjs-tfdf/tf-tfdf.min.js")},isInternetExplorer:function(){var e=navigator.userAgent;return e&&(0<=e.indexOf("MSIE")||0<=e.indexOf("Trident"))},isGoogleFilesUrl:function(e){return n.test(e)}}}angular.module("app").service("utilService",e),e.$inject=["$q","loggerService"]}(),function(){function e(e,n,r){var t=this;t.worksheets=[],e(["WORKSHEETS.DESCRIBETHEGLASS.TITLE","WORKSHEETS.DESCRIBETHEGLASS.SUMMARY","WORKSHEETS.DESCRIBETHEGLASS.DESCRIPTION","WORKSHEETS.DESCRIBETHEGLASS.WORKSHEET_1.URL","WORKSHEETS.DESCRIBETHEGLASS.TEACHERSNOTES_URL","WORKSHEETS.SMARTCLASSROOM.TITLE","WORKSHEETS.SMARTCLASSROOM.SUMMARY","WORKSHEETS.SMARTCLASSROOM.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.URL","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.URL","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.DESCRIPTION","WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.URL","WORKSHEETS.SMARTCLASSROOM.TEACHERSNOTES_URL","WORKSHEETS.MAKEMEHAPPY.TITLE","WORKSHEETS.MAKEMEHAPPY.SUMMARY","WORKSHEETS.MAKEMEHAPPY.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.URL","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.URL","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.DESCRIPTION","WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.URL","WORKSHEETS.MAKEMEHAPPY.TEACHERSNOTES_URL","WORKSHEETS.SNAP.TITLE","WORKSHEETS.SNAP.SUMMARY","WORKSHEETS.SNAP.DESCRIPTION","WORKSHEETS.SNAP.WORKSHEET_1.DESCRIPTION","WORKSHEETS.SNAP.WORKSHEET_1.URL","WORKSHEETS.SNAP.WORKSHEET_2.DESCRIPTION","WORKSHEETS.SNAP.WORKSHEET_2.URL","WORKSHEETS.SNAP.WORKSHEET_2.RESOURCES","WORKSHEETS.SNAP.TEACHERSNOTES_URL","WORKSHEETS.CHAMELEON.TITLE","WORKSHEETS.CHAMELEON.SUMMARY","WORKSHEETS.CHAMELEON.DESCRIPTION","WORKSHEETS.CHAMELEON.WORKSHEET_1.URL","WORKSHEETS.CHAMELEON.TEACHERSNOTES_URL","WORKSHEETS.QUIZSHOW.TITLE","WORKSHEETS.QUIZSHOW.SUMMARY","WORKSHEETS.QUIZSHOW.DESCRIPTION","WORKSHEETS.QUIZSHOW.WORKSHEET_1.URL","WORKSHEETS.QUIZSHOW.TEACHERSNOTES_URL","WORKSHEETS.MAILMANMAX.TITLE","WORKSHEETS.MAILMANMAX.SUMMARY","WORKSHEETS.MAILMANMAX.DESCRIPTION","WORKSHEETS.MAILMANMAX.WORKSHEET_1.URL","WORKSHEETS.MAILMANMAX.TEACHERSNOTES_URL","WORKSHEETS.SHOOTTHEBUG.TITLE","WORKSHEETS.SHOOTTHEBUG.SUMMARY","WORKSHEETS.SHOOTTHEBUG.DESCRIPTION","WORKSHEETS.SHOOTTHEBUG.WORKSHEET_1.URL","WORKSHEETS.SHOOTTHEBUG.TEACHERSNOTES_URL","WORKSHEETS.CARORCUP.TITLE","WORKSHEETS.CARORCUP.SUMMARY","WORKSHEETS.CARORCUP.DESCRIPTION","WORKSHEETS.CARORCUP.WORKSHEET_1.DESCRIPTION","WORKSHEETS.CARORCUP.WORKSHEET_1.URL","WORKSHEETS.CARORCUP.WORKSHEET_2.DESCRIPTION","WORKSHEETS.CARORCUP.WORKSHEET_2.URL","WORKSHEETS.CARORCUP.TEACHERSNOTES_URL","WORKSHEETS.FACELOCK.TITLE","WORKSHEETS.FACELOCK.SUMMARY","WORKSHEETS.FACELOCK.DESCRIPTION","WORKSHEETS.FACELOCK.WORKSHEET_1.URL","WORKSHEETS.FACELOCK.TEACHERSNOTES_URL","WORKSHEETS.JOURNEYTOSCHOOL.TITLE","WORKSHEETS.JOURNEYTOSCHOOL.SUMMARY","WORKSHEETS.JOURNEYTOSCHOOL.DESCRIPTION","WORKSHEETS.JOURNEYTOSCHOOL.WORKSHEET_1.URL","WORKSHEETS.JOURNEYTOSCHOOL.TEACHERSNOTES_URL","WORKSHEETS.SHYPANDA.TITLE","WORKSHEETS.SHYPANDA.SUMMARY","WORKSHEETS.SHYPANDA.DESCRIPTION","WORKSHEETS.SHYPANDA.WORKSHEET_1.URL","WORKSHEETS.SHYPANDA.TEACHERSNOTES_URL","WORKSHEETS.ALIENLANGUAGE.TITLE","WORKSHEETS.ALIENLANGUAGE.SUMMARY","WORKSHEETS.ALIENLANGUAGE.DESCRIPTION","WORKSHEETS.ALIENLANGUAGE.WORKSHEET_1.URL","WORKSHEETS.ALIENLANGUAGE.TEACHERSNOTES_URL","WORKSHEETS.SECRETCODE.TITLE","WORKSHEETS.SECRETCODE.SUMMARY","WORKSHEETS.SECRETCODE.DESCRIPTION","WORKSHEETS.SECRETCODE.WORKSHEET_1.URL","WORKSHEETS.SECRETCODE.TEACHERSNOTES_URL","WORKSHEETS.VIRTUALPET.TITLE","WORKSHEETS.VIRTUALPET.SUMMARY","WORKSHEETS.VIRTUALPET.DESCRIPTION","WORKSHEETS.VIRTUALPET.WORKSHEET_1.URL","WORKSHEETS.VIRTUALPET.TEACHERSNOTES_URL","WORKSHEETS.PACMAN.TITLE","WORKSHEETS.PACMAN.SUMMARY","WORKSHEETS.PACMAN.DESCRIPTION","WORKSHEETS.PACMAN.WORKSHEET_1.URL","WORKSHEETS.PACMAN.TEACHERSNOTES_URL","WORKSHEETS.CHATBOTS.TITLE","WORKSHEETS.CHATBOTS.SUMMARY","WORKSHEETS.CHATBOTS.DESCRIPTION","WORKSHEETS.CHATBOTS.WORKSHEET_1.DESCRIPTION","WORKSHEETS.CHATBOTS.WORKSHEET_1.URL","WORKSHEETS.CHATBOTS.WORKSHEET_2.DESCRIPTION","WORKSHEETS.CHATBOTS.WORKSHEET_2.URL","WORKSHEETS.CHATBOTS.TEACHERSNOTES_URL","WORKSHEETS.TOURISTINFO.TITLE","WORKSHEETS.TOURISTINFO.SUMMARY","WORKSHEETS.TOURISTINFO.DESCRIPTION","WORKSHEETS.TOURISTINFO.WORKSHEET_1.URL","WORKSHEETS.TOURISTINFO.TEACHERSNOTES_URL","WORKSHEETS.SORTINGHAT.TITLE","WORKSHEETS.SORTINGHAT.SUMMARY","WORKSHEETS.SORTINGHAT.DESCRIPTION","WORKSHEETS.SORTINGHAT.WORKSHEET_1.DESCRIPTION","WORKSHEETS.SORTINGHAT.WORKSHEET_1.URL","WORKSHEETS.SORTINGHAT.WORKSHEET_2.DESCRIPTION","WORKSHEETS.SORTINGHAT.WORKSHEET_2.URL","WORKSHEETS.SORTINGHAT.TEACHERSNOTES_URL","WORKSHEETS.ROCKPAPERSCISSORS.TITLE","WORKSHEETS.ROCKPAPERSCISSORS.SUMMARY","WORKSHEETS.ROCKPAPERSCISSORS.DESCRIPTION","WORKSHEETS.ROCKPAPERSCISSORS.WORKSHEET_1.URL","WORKSHEETS.ROCKPAPERSCISSORS.TEACHERSNOTES_URL","WORKSHEETS.JUDGEABOOK.TITLE","WORKSHEETS.JUDGEABOOK.SUMMARY","WORKSHEETS.JUDGEABOOK.DESCRIPTION","WORKSHEETS.JUDGEABOOK.WORKSHEET_1.DESCRIPTION","WORKSHEETS.JUDGEABOOK.WORKSHEET_1.URL","WORKSHEETS.JUDGEABOOK.WORKSHEET_2.DESCRIPTION","WORKSHEETS.JUDGEABOOK.WORKSHEET_2.URL","WORKSHEETS.JUDGEABOOK.WORKSHEET_3.DESCRIPTION","WORKSHEETS.JUDGEABOOK.WORKSHEET_3.URL","WORKSHEETS.JUDGEABOOK.TEACHERSNOTES_URL","WORKSHEETS.FOOLED.TITLE","WORKSHEETS.FOOLED.SUMMARY","WORKSHEETS.FOOLED.DESCRIPTION","WORKSHEETS.FOOLED.WORKSHEET_1.URL","WORKSHEETS.FOOLED.TEACHERSNOTES_URL","WORKSHEETS.SCHOOLLIBRARY.TITLE","WORKSHEETS.SCHOOLLIBRARY.SUMMARY","WORKSHEETS.SCHOOLLIBRARY.DESCRIPTION","WORKSHEETS.SCHOOLLIBRARY.WORKSHEET_1.URL","WORKSHEETS.SCHOOLLIBRARY.TEACHERSNOTES_URL","WORKSHEETS.NOUGHTSANDCROSSES.TITLE","WORKSHEETS.NOUGHTSANDCROSSES.SUMMARY","WORKSHEETS.NOUGHTSANDCROSSES.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_1.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_1.URL","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_2.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_2.URL","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_3.DESCRIPTION","WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_3.URL","WORKSHEETS.NOUGHTSANDCROSSES.TEACHERSNOTES_URL","WORKSHEETS.TOPTRUMPS.TITLE","WORKSHEETS.TOPTRUMPS.SUMMARY","WORKSHEETS.TOPTRUMPS.DESCRIPTION","WORKSHEETS.TOPTRUMPS.WORKSHEET_1.URL","WORKSHEETS.TOPTRUMPS.TEACHERSNOTES_URL","WORKSHEETS.NEWSPAPERSHELVES.TITLE","WORKSHEETS.NEWSPAPERSHELVES.SUMMARY","WORKSHEETS.NEWSPAPERSHELVES.DESCRIPTION","WORKSHEETS.NEWSPAPERSHELVES.WORKSHEET_1.URL","WORKSHEETS.NEWSPAPERSHELVES.TEACHERSNOTES_URL","WORKSHEETS.HEADLINETESTING.TITLE","WORKSHEETS.HEADLINETESTING.SUMMARY","WORKSHEETS.HEADLINETESTING.DESCRIPTION","WORKSHEETS.HEADLINETESTING.WORKSHEET_1.URL","WORKSHEETS.HEADLINETESTING.TEACHERSNOTES_URL","WORKSHEETS.FINDIT.TITLE","WORKSHEETS.FINDIT.SUMMARY","WORKSHEETS.FINDIT.DESCRIPTION","WORKSHEETS.FINDIT.WORKSHEET_1.URL","WORKSHEETS.FINDIT.TEACHERSNOTES_URL","WORKSHEETS.JARGONBUSTER.TITLE","WORKSHEETS.JARGONBUSTER.SUMMARY","WORKSHEETS.JARGONBUSTER.DESCRIPTION","WORKSHEETS.JARGONBUSTER.WORKSHEET_1.URL","WORKSHEETS.JARGONBUSTER.TEACHERSNOTES_URL","WORKSHEETS.TITANIC.TITLE","WORKSHEETS.TITANIC.SUMMARY","WORKSHEETS.TITANIC.DESCRIPTION","WORKSHEETS.TITANIC.WORKSHEET_1.URL","WORKSHEETS.TITANIC.TEACHERSNOTES_URL","WORKSHEETS.ZOMBIEESCAPE.TITLE","WORKSHEETS.ZOMBIEESCAPE.SUMMARY","WORKSHEETS.ZOMBIEESCAPE.DESCRIPTION","WORKSHEETS.ZOMBIEESCAPE.WORKSHEET_1.URL","WORKSHEETS.ZOMBIEESCAPE.TEACHERSNOTES_URL","WORKSHEETS.PHISHING.TITLE","WORKSHEETS.PHISHING.SUMMARY","WORKSHEETS.PHISHING.DESCRIPTION","WORKSHEETS.PHISHING.WORKSHEET_1.URL","WORKSHEETS.PHISHING.TEACHERSNOTES_URL","WORKSHEETS.INKBLOTS.TITLE","WORKSHEETS.INKBLOTS.SUMMARY","WORKSHEETS.INKBLOTS.DESCRIPTION","WORKSHEETS.INKBLOTS.WORKSHEET_1.URL","WORKSHEETS.INKBLOTS.TEACHERSNOTES_URL","WORKSHEETS.FACEFINDER.TITLE","WORKSHEETS.FACEFINDER.SUMMARY","WORKSHEETS.FACEFINDER.DESCRIPTION","WORKSHEETS.FACEFINDER.WORKSHEET_1.URL","WORKSHEETS.FACEFINDER.TEACHERSNOTES_URL","WORKSHEETS.EMOJIMASK.TITLE","WORKSHEETS.EMOJIMASK.SUMMARY","WORKSHEETS.EMOJIMASK.DESCRIPTION","WORKSHEETS.EMOJIMASK.WORKSHEET_1.URL","WORKSHEETS.EMOJIMASK.TEACHERSNOTES_URL","WORKSHEETS.LASEREYES.TITLE","WORKSHEETS.LASEREYES.SUMMARY","WORKSHEETS.LASEREYES.DESCRIPTION","WORKSHEETS.LASEREYES.WORKSHEET_1.URL","WORKSHEETS.LASEREYES.TEACHERSNOTES_URL","WORKSHEETS.SEMAPHORES.TITLE","WORKSHEETS.SEMAPHORES.SUMMARY","WORKSHEETS.SEMAPHORES.DESCRIPTION","WORKSHEETS.SEMAPHORES.WORKSHEET_1.URL","WORKSHEETS.SEMAPHORES.TEACHERSNOTES_URL","WORKSHEETS.HANDGESTURES.TITLE","WORKSHEETS.HANDGESTURES.SUMMARY","WORKSHEETS.HANDGESTURES.DESCRIPTION","WORKSHEETS.HANDGESTURES.WORKSHEET_1.URL","WORKSHEETS.HANDGESTURES.TEACHERSNOTES_URL","WORKSHEETS.EXPLAINABILITY.TITLE","WORKSHEETS.EXPLAINABILITY.SUMMARY","WORKSHEETS.EXPLAINABILITY.DESCRIPTION","WORKSHEETS.EXPLAINABILITY.WORKSHEET_1.URL","WORKSHEETS.EXPLAINABILITY.TEACHERSNOTES_URL","WORKSHEETS.POKEMONIMAGES.TITLE","WORKSHEETS.POKEMONIMAGES.SUMMARY","WORKSHEETS.POKEMONIMAGES.DESCRIPTION","WORKSHEETS.POKEMONIMAGES.WORKSHEET_1.URL","WORKSHEETS.POKEMONSTATS.TITLE","WORKSHEETS.POKEMONSTATS.SUMMARY","WORKSHEETS.POKEMONSTATS.DESCRIPTION","WORKSHEETS.POKEMONSTATS.WORKSHEET_1.URL","WORKSHEETS.ISPY.TITLE","WORKSHEETS.ISPY.SUMMARY","WORKSHEETS.ISPY.DESCRIPTION","WORKSHEETS.ISPY.WORKSHEET_1.URL","WORKSHEETS.CARPOOL.TITLE","WORKSHEETS.CARPOOL.SUMMARY","WORKSHEETS.CARPOOL.DESCRIPTION","WORKSHEETS.CARPOOL.WORKSHEET_1.URL","WORKSHEETS.CATCHTHEBALL.TITLE","WORKSHEETS.CATCHTHEBALL.SUMMARY","WORKSHEETS.CATCHTHEBALL.DESCRIPTION","WORKSHEETS.CATCHTHEBALL.WORKSHEET_1.URL","WORKSHEETS.HOOPS.TITLE","WORKSHEETS.HOOPS.SUMMARY","WORKSHEETS.HOOPS.DESCRIPTION","WORKSHEETS.HOOPS.WORKSHEET_1.URL"]).then(function(e){t.worksheets=[{title:e["WORKSHEETS.DESCRIBETHEGLASS.TITLE"],summary:e["WORKSHEETS.DESCRIBETHEGLASS.SUMMARY"],description:e["WORKSHEETS.DESCRIBETHEGLASS.DESCRIPTION"],difficulty:"Beginner",type:"numbers",maketypes:["scratch3"],image:"static/images/project-describetheglass.png",tags:["decision tree learning"],teachersnotes:e["WORKSHEETS.DESCRIBETHEGLASS.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.DESCRIBETHEGLASS.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.POKEMONIMAGES.TITLE"],summary:e["WORKSHEETS.POKEMONIMAGES.SUMMARY"],description:e["WORKSHEETS.POKEMONIMAGES.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-pokemonimages.png",tags:["image classification","supervised learning"],downloads:[{worksheet:e["WORKSHEETS.POKEMONIMAGES.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SMARTCLASSROOM.TITLE"],summary:e["WORKSHEETS.SMARTCLASSROOM.SUMMARY"],description:e["WORKSHEETS.SMARTCLASSROOM.DESCRIPTION"],difficulty:"Beginner",type:"text",maketypes:["scratch3"],image:"static/images/project-smartclassroom.png",tags:["digital assistants","supervised learning"],teachersnotes:e["WORKSHEETS.SMARTCLASSROOM.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_2.URL"]},{description:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.DESCRIPTION"],worksheet:e["WORKSHEETS.SMARTCLASSROOM.WORKSHEET_3.URL"]}]},{title:e["WORKSHEETS.ISPY.TITLE"],summary:e["WORKSHEETS.ISPY.SUMMARY"],description:e["WORKSHEETS.ISPY.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-ispy.png",tags:["image recognition","pretrained models"],downloads:[{worksheet:e["WORKSHEETS.ISPY.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.MAKEMEHAPPY.TITLE"],summary:e["WORKSHEETS.MAKEMEHAPPY.SUMMARY"],description:e["WORKSHEETS.MAKEMEHAPPY.DESCRIPTION"],difficulty:"Beginner",type:"text",maketypes:["scratch3","python"],image:"static/images/project-makemehappy.png",tags:["sentiment analysis","supervised learning"],teachersnotes:e["WORKSHEETS.MAKEMEHAPPY.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_2.URL"]},{description:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.DESCRIPTION"],worksheet:e["WORKSHEETS.MAKEMEHAPPY.WORKSHEET_3.URL"]}]},{title:e["WORKSHEETS.POKEMONSTATS.TITLE"],summary:e["WORKSHEETS.POKEMONSTATS.SUMMARY"],description:e["WORKSHEETS.POKEMONSTATS.DESCRIPTION"],difficulty:"Beginner",type:"numbers",maketypes:["scratch3"],image:"static/images/project-pokemonstatistics.png",tags:["predictive model","supervised learning"],downloads:[{worksheet:e["WORKSHEETS.POKEMONSTATS.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SNAP.TITLE"],summary:e["WORKSHEETS.SNAP.SUMMARY"],description:e["WORKSHEETS.SNAP.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-snap.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.SNAP.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.SNAP.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.SNAP.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.SNAP.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.SNAP.WORKSHEET_2.URL"],resources:e["WORKSHEETS.SNAP.WORKSHEET_2.RESOURCES"]}]},{title:e["WORKSHEETS.QUIZSHOW.TITLE"],summary:e["WORKSHEETS.QUIZSHOW.SUMMARY"],description:e["WORKSHEETS.QUIZSHOW.DESCRIPTION"],difficulty:"Beginner",type:"text",maketypes:["scratch3"],image:"static/images/project-quizshow.png",tags:["question answering"],teachersnotes:e["WORKSHEETS.QUIZSHOW.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.QUIZSHOW.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.CARPOOL.TITLE"],summary:e["WORKSHEETS.CARPOOL.SUMMARY"],description:e["WORKSHEETS.CARPOOL.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-carpoolcheats.png",tags:["image classification","supervised learning"],downloads:[{worksheet:e["WORKSHEETS.CARPOOL.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.CHAMELEON.TITLE"],summary:e["WORKSHEETS.CHAMELEON.SUMMARY"],description:e["WORKSHEETS.CHAMELEON.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-chameleon.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.CHAMELEON.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.CHAMELEON.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.TITANIC.TITLE"],summary:e["WORKSHEETS.TITANIC.SUMMARY"],description:e["WORKSHEETS.TITANIC.DESCRIPTION"],difficulty:"Beginner",type:"numbers",maketypes:["python"],image:"static/images/project-titanic.png",tags:["predictive model","supervised learning"],teachersnotes:e["WORKSHEETS.TITANIC.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.TITANIC.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.MAILMANMAX.TITLE"],summary:e["WORKSHEETS.MAILMANMAX.SUMMARY"],description:e["WORKSHEETS.MAILMANMAX.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-mailmanmax.png",tags:["optical character recognition","handwriting recognition","image classification"],teachersnotes:e["WORKSHEETS.MAILMANMAX.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.MAILMANMAX.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.CATCHTHEBALL.TITLE"],summary:e["WORKSHEETS.CATCHTHEBALL.SUMMARY"],description:e["WORKSHEETS.CATCHTHEBALL.DESCRIPTION"],difficulty:"Beginner",type:"regression",maketypes:["scratch3"],image:"static/images/project-catchtheball.png",tags:["regression"],downloads:[{worksheet:e["WORKSHEETS.CATCHTHEBALL.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.HOOPS.TITLE"],summary:e["WORKSHEETS.HOOPS.SUMMARY"],description:e["WORKSHEETS.HOOPS.DESCRIPTION"],difficulty:"Beginner",type:"regression",maketypes:["scratch3"],image:"static/images/project-hoops.png",tags:["regression"],downloads:[{worksheet:e["WORKSHEETS.HOOPS.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SHOOTTHEBUG.TITLE"],summary:e["WORKSHEETS.SHOOTTHEBUG.SUMMARY"],description:e["WORKSHEETS.SHOOTTHEBUG.DESCRIPTION"],difficulty:"Intermediate",type:"regression",maketypes:["scratch3"],image:"static/images/project-shootthebug.png",tags:["regression"],teachersnotes:e["WORKSHEETS.SHOOTTHEBUG.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.SHOOTTHEBUG.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.CARORCUP.TITLE"],summary:e["WORKSHEETS.CARORCUP.SUMMARY"],description:e["WORKSHEETS.CARORCUP.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-carorcup.png",tags:["image classification","supervised learning","crowd sourcing"],teachersnotes:e["WORKSHEETS.CARORCUP.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.CARORCUP.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.CARORCUP.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.CARORCUP.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.CARORCUP.WORKSHEET_2.URL"]}]},{title:e["WORKSHEETS.FACELOCK.TITLE"],summary:e["WORKSHEETS.FACELOCK.SUMMARY"],description:e["WORKSHEETS.FACELOCK.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch2"],image:"static/images/project-facelock.png",tags:["facial recognition","biometrics","image classification","supervised learning"],teachersnotes:e["WORKSHEETS.FACELOCK.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.FACELOCK.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.JOURNEYTOSCHOOL.TITLE"],summary:e["WORKSHEETS.JOURNEYTOSCHOOL.SUMMARY"],description:e["WORKSHEETS.JOURNEYTOSCHOOL.DESCRIPTION"],difficulty:"Beginner",type:"numbers",maketypes:["scratch2"],image:"static/images/project-journeytoschool.png",tags:["predictive model","testing and accuracy","supervised learning"],teachersnotes:e["WORKSHEETS.JOURNEYTOSCHOOL.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.JOURNEYTOSCHOOL.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SHYPANDA.TITLE"],summary:e["WORKSHEETS.SHYPANDA.SUMMARY"],description:e["WORKSHEETS.SHYPANDA.DESCRIPTION"],difficulty:"Beginner",type:"images",maketypes:["scratch3"],image:"static/images/project-shypanda.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.SHYPANDA.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.SHYPANDA.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.ALIENLANGUAGE.TITLE"],summary:e["WORKSHEETS.ALIENLANGUAGE.SUMMARY"],description:e["WORKSHEETS.ALIENLANGUAGE.DESCRIPTION"],difficulty:"Beginner",type:"sounds",maketypes:["scratch3"],image:"static/images/project-alienlanguage.png",tags:["sound recognition","supervised learning"],teachersnotes:e["WORKSHEETS.ALIENLANGUAGE.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.ALIENLANGUAGE.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.PACMAN.TITLE"],summary:e["WORKSHEETS.PACMAN.SUMMARY"],description:e["WORKSHEETS.PACMAN.DESCRIPTION"],difficulty:"Intermediate",type:"numbers",maketypes:["scratch3"],image:"static/images/project-pacman.png",tags:["decision tree learning"],teachersnotes:e["WORKSHEETS.PACMAN.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.PACMAN.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.CHATBOTS.TITLE"],summary:e["WORKSHEETS.CHATBOTS.SUMMARY"],description:e["WORKSHEETS.CHATBOTS.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3","python"],image:"static/images/project-chatbots.png",tags:["sentiment analysis","supervised learning"],teachersnotes:e["WORKSHEETS.CHATBOTS.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.CHATBOTS.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.CHATBOTS.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.CHATBOTS.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.CHATBOTS.WORKSHEET_2.URL"]}]},{title:e["WORKSHEETS.ZOMBIEESCAPE.TITLE"],summary:e["WORKSHEETS.ZOMBIEESCAPE.SUMMARY"],description:e["WORKSHEETS.ZOMBIEESCAPE.DESCRIPTION"],difficulty:"Intermediate",type:"numbers",maketypes:["scratch3"],image:"static/images/project-zombieescape.png",tags:["supervised learning","feature selection","decision tree learning"],teachersnotes:e["WORKSHEETS.ZOMBIEESCAPE.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.ZOMBIEESCAPE.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.VIRTUALPET.TITLE"],summary:e["WORKSHEETS.VIRTUALPET.SUMMARY"],description:e["WORKSHEETS.VIRTUALPET.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-virtualpet.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.VIRTUALPET.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.VIRTUALPET.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.TOURISTINFO.TITLE"],summary:e["WORKSHEETS.TOURISTINFO.SUMMARY"],description:e["WORKSHEETS.TOURISTINFO.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3"],image:"static/images/project-touristinfo.png",tags:["training bias","recommendations","supervised learning"],teachersnotes:e["WORKSHEETS.TOURISTINFO.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.TOURISTINFO.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.INKBLOTS.TITLE"],summary:e["WORKSHEETS.INKBLOTS.SUMMARY"],description:e["WORKSHEETS.INKBLOTS.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-inkblots.png",tags:["image classification","supervised learning","AI research"],teachersnotes:e["WORKSHEETS.INKBLOTS.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.INKBLOTS.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SECRETCODE.TITLE"],summary:e["WORKSHEETS.SECRETCODE.SUMMARY"],description:e["WORKSHEETS.SECRETCODE.DESCRIPTION"],difficulty:"Intermediate",type:"sounds",maketypes:["scratch3"],image:"static/images/project-secretcode.png",tags:["speech recognition","sound recognition","supervised learning"],teachersnotes:e["WORKSHEETS.SECRETCODE.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.SECRETCODE.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SORTINGHAT.TITLE"],summary:e["WORKSHEETS.SORTINGHAT.SUMMARY"],description:e["WORKSHEETS.SORTINGHAT.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3"],image:"static/images/project-sortinghat.png",tags:["text classification","supervised learning","crowd sourcing"],teachersnotes:e["WORKSHEETS.SORTINGHAT.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.SORTINGHAT.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.SORTINGHAT.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.SORTINGHAT.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.SORTINGHAT.WORKSHEET_2.URL"]}]},{title:e["WORKSHEETS.ROCKPAPERSCISSORS.TITLE"],summary:e["WORKSHEETS.ROCKPAPERSCISSORS.SUMMARY"],description:e["WORKSHEETS.ROCKPAPERSCISSORS.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-rockpaperscissors.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.ROCKPAPERSCISSORS.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.ROCKPAPERSCISSORS.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.NEWSPAPERSHELVES.TITLE"],summary:e["WORKSHEETS.NEWSPAPERSHELVES.SUMMARY"],description:e["WORKSHEETS.NEWSPAPERSHELVES.DESCRIPTION"],difficulty:"Intermediate",type:"text",maketypes:["scratch3"],image:"static/images/project-headlines-easy.png",tags:["text classification","supervised learning"],teachersnotes:e["WORKSHEETS.NEWSPAPERSHELVES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.NEWSPAPERSHELVES.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.JUDGEABOOK.TITLE"],summary:e["WORKSHEETS.JUDGEABOOK.SUMMARY"],description:e["WORKSHEETS.JUDGEABOOK.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-judgeabook.png",tags:["image classification","supervised learning"],teachersnotes:e["WORKSHEETS.JUDGEABOOK.TEACHERSNOTES_URL"],downloads:[{description:e["WORKSHEETS.JUDGEABOOK.WORKSHEET_1.DESCRIPTION"],worksheet:e["WORKSHEETS.JUDGEABOOK.WORKSHEET_1.URL"]},{description:e["WORKSHEETS.JUDGEABOOK.WORKSHEET_2.DESCRIPTION"],worksheet:e["WORKSHEETS.JUDGEABOOK.WORKSHEET_2.URL"]}]},{title:e["WORKSHEETS.FOOLED.TITLE"],summary:e["WORKSHEETS.FOOLED.SUMMARY"],description:e["WORKSHEETS.FOOLED.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-fooled.png",tags:["image classification","supervised learning","overfitting"],teachersnotes:e["WORKSHEETS.FOOLED.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.FOOLED.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SCHOOLLIBRARY.TITLE"],summary:e["WORKSHEETS.SCHOOLLIBRARY.SUMMARY"],description:e["WORKSHEETS.SCHOOLLIBRARY.DESCRIPTION"],difficulty:"Intermediate",type:"numbers",maketypes:["scratch2"],image:"static/images/project-schoollibrary.png",tags:["predictive model","recommendations","supervised learning"],teachersnotes:e["WORKSHEETS.SCHOOLLIBRARY.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.SCHOOLLIBRARY.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.JARGONBUSTER.TITLE"],summary:e["WORKSHEETS.JARGONBUSTER.SUMMARY"],description:e["WORKSHEETS.JARGONBUSTER.DESCRIPTION"],difficulty:"Intermediate",type:"sounds",maketypes:["scratch3"],image:"static/images/project-jargonbuster.png",tags:["speech recognition","sound recognition","supervised learning"],teachersnotes:e["WORKSHEETS.JARGONBUSTER.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.JARGONBUSTER.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.EXPLAINABILITY.TITLE"],summary:e["WORKSHEETS.EXPLAINABILITY.SUMMARY"],description:e["WORKSHEETS.EXPLAINABILITY.DESCRIPTION"],difficulty:"Intermediate",type:"images",maketypes:["scratch3"],image:"static/images/project-explainability.png",tags:["image recognition","explainable AI","xai"],teachersnotes:e["WORKSHEETS.EXPLAINABILITY.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.EXPLAINABILITY.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.NOUGHTSANDCROSSES.TITLE"],summary:e["WORKSHEETS.NOUGHTSANDCROSSES.SUMMARY"],description:e["WORKSHEETS.NOUGHTSANDCROSSES.DESCRIPTION"],difficulty:"Advanced",type:"numbers",maketypes:["python"],image:"static/images/project-noughtsandcrosses.png",tags:["decision tree learning","categorical data"],teachersnotes:e["WORKSHEETS.NOUGHTSANDCROSSES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.NOUGHTSANDCROSSES.WORKSHEET_2.URL"]}]},{title:e["WORKSHEETS.TOPTRUMPS.TITLE"],summary:e["WORKSHEETS.TOPTRUMPS.SUMMARY"],description:e["WORKSHEETS.TOPTRUMPS.DESCRIPTION"],difficulty:"Advanced",type:"numbers",maketypes:["scratch3"],image:"static/images/project-toptrumps.png",tags:["decision tree learning","categorical data"],teachersnotes:e["WORKSHEETS.TOPTRUMPS.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.TOPTRUMPS.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.HEADLINETESTING.TITLE"],summary:e["WORKSHEETS.HEADLINETESTING.SUMMARY"],description:e["WORKSHEETS.HEADLINETESTING.DESCRIPTION"],difficulty:"Advanced",type:"text",maketypes:["scratch3"],image:"static/images/project-headlines.png",tags:["text classification","supervised learning","testing"],teachersnotes:e["WORKSHEETS.HEADLINETESTING.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.HEADLINETESTING.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.PHISHING.TITLE"],summary:e["WORKSHEETS.PHISHING.SUMMARY"],description:e["WORKSHEETS.PHISHING.DESCRIPTION"],difficulty:"Advanced",type:"numbers",maketypes:["python"],image:"static/images/dataset-phishing.png",tags:["decision tree learning","AI research","categorical data"],teachersnotes:e["WORKSHEETS.PHISHING.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.PHISHING.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.FACEFINDER.TITLE"],summary:e["WORKSHEETS.FACEFINDER.SUMMARY"],description:e["WORKSHEETS.FACEFINDER.DESCRIPTION"],difficulty:"Beginner",type:"faces",maketypes:["scratch3"],image:"static/images/project-facefinder.png",tags:["face detection"],teachersnotes:e["WORKSHEETS.FACEFINDER.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.FACEFINDER.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.EMOJIMASK.TITLE"],summary:e["WORKSHEETS.EMOJIMASK.SUMMARY"],description:e["WORKSHEETS.EMOJIMASK.DESCRIPTION"],difficulty:"Intermediate",type:"faces",maketypes:["scratch3"],image:"static/images/project-emojimask.png",tags:["face detection"],teachersnotes:e["WORKSHEETS.EMOJIMASK.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.EMOJIMASK.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.LASEREYES.TITLE"],summary:e["WORKSHEETS.LASEREYES.SUMMARY"],description:e["WORKSHEETS.LASEREYES.DESCRIPTION"],difficulty:"Intermediate",type:"sounds",maketypes:["scratch3"],image:"static/images/project-lasereyes.png",tags:["speech recognition","face detection"],teachersnotes:e["WORKSHEETS.LASEREYES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.LASEREYES.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.SEMAPHORES.TITLE"],summary:e["WORKSHEETS.SEMAPHORES.SUMMARY"],description:e["WORKSHEETS.SEMAPHORES.DESCRIPTION"],difficulty:"Advanced",type:"sounds",maketypes:["scratch3"],image:"static/images/project-semaphores.png",tags:["speech recognition","pose detection"],teachersnotes:e["WORKSHEETS.SEMAPHORES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.SEMAPHORES.WORKSHEET_1.URL"]}]},{title:e["WORKSHEETS.HANDGESTURES.TITLE"],summary:e["WORKSHEETS.HANDGESTURES.SUMMARY"],description:e["WORKSHEETS.HANDGESTURES.DESCRIPTION"],difficulty:"Advanced",type:"numbers",maketypes:["scratch3"],image:"static/images/project-handgestures.png",tags:["image recognition","pretrained models"],teachersnotes:e["WORKSHEETS.HANDGESTURES.TEACHERSNOTES_URL"],downloads:[{worksheet:e["WORKSHEETS.HANDGESTURES.WORKSHEET_1.URL"]}]}]}),t.downloadWorksheet=function(e,t){n.show({locals:{worksheet:t},controller:["$scope","locals",function(e,t){e.worksheet=t.worksheet,e.hide=function(){n.hide()},e.cancel=function(){n.cancel()}}],templateUrl:"static/components/worksheets/download.tmpl.html",targetEvent:e,clickOutsideToClose:!0})},r.projecttype="ALL",r.projectdifficulty="ALL",r.projectmaketype="ALL",r.filterWorksheets=function(e){var t=!0;return"ALL"!==r.projecttype&&(t=t&&e.type===r.projecttype),"ALL"!==r.projectdifficulty&&(t=t&&e.difficulty===r.projectdifficulty),t="ALL"!==r.projectmaketype?t&&("python"===r.projectmaketype&&0<=e.maketypes.indexOf("python")||"appinventor"===r.projectmaketype&&0<=e.maketypes.indexOf("appinventor")||"scratch"===r.projectmaketype&&(0<=e.maketypes.indexOf("scratch2")||0<=e.maketypes.indexOf("scratch3"))):t}}angular.module("app").controller("WorksheetsController",e),e.$inject=["$translate","$mdDialog","$scope"]}();
//# sourceMappingURL=mlapp.min.js.map
